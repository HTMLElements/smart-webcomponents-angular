
/* Smart UI v8.0.0 (2020-Aug) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function i(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,i),l.l=!0,l.exports}i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)i.d(n,l,function(t){return e[t]}.bind(null,l));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=93)}({93:function(e,t){Smart("smart-scheduler",class extends Smart.ScrollViewer{static get properties(){return{allowDrag:{value:!1,type:"boolean"},allowDrop:{value:!1,type:"boolean"},eventIndicatorTemplate:{value:null,type:"any"},eventTemplate:{value:null,type:"any"},autoScrollStep:{value:5,type:"number"},tooltipTemplate:{value:null,type:"any"},cellDuration:{value:60,type:"number"},cellTemplate:{value:null,type:"any"},dateCurrent:{value:new Date,type:"any",validator:"_dateValidator"},dataSource:{value:[],type:"any",reflectToAttribute:!1},dataExport:{value:{header:{value:!0,type:"boolean"},style:{value:null,type:"object"},fileName:{value:"smartScheduler",type:"string?"},pageOrientation:{value:"portrait",type:"string"}},type:"object"},dateSelectorFormatFunction:{value:null,reflectToAttribute:!1,type:"function?"},dayFormat:{value:"numeric",allowedValues:["2-digit","numeric"],type:"string"},disableAutoScroll:{value:!1,type:"boolean"},disableEventDrag:{value:!1,type:"boolean"},disableEventResize:{value:!1,type:"boolean"},disableSelection:{value:!1,type:"boolean"},disableWindowEditor:{value:!1,type:"boolean"},dragFeedbackFormatFunction:{value:null,type:"any"},dragOffset:{value:[10,10],type:"array"},firstDayOfWeek:{value:0,type:"number",defaultValue:0,validator:"_firstDayOfWeekValidator"},groupByDate:{value:!1,type:"boolean"},groupOrientation:{allowedValues:["horizontal","vertical"],value:"horizontal",type:"string"},groupTemplate:{value:null,type:"any"},groups:{value:[],type:"array"},hourEnd:{value:23,type:"number",validator:"_hourValidator"},hourStart:{value:0,type:"number",validator:"_hourValidator"},hourFormat:{value:"numeric",allowedValues:["numeric","2-digit"],type:"string"},headerTemplate:{value:null,type:"any"},headerDatePosition:{value:"near",allowedValues:["near","far"],type:"string"},headerViewPosition:{value:"far",allowedValues:["near","far"],type:"string"},hideAllDay:{value:!1,type:"boolean"},hideNonworkingWeekdays:{value:!1,type:"boolean"},hideWeekend:{value:!1,type:"boolean"},interval:{value:1,type:"number"},nonworkingDays:{value:[],type:"array",validator:"_nonworkingDayValidator"},nonworkingHours:{value:[],type:"array",validator:"_nonworkingTimeValidator"},max:{value:new Date(2100,0,1),type:"any",validator:"_dateValidator"},min:{value:new Date(1900,0,1),type:"any",validator:"_dateValidator"},messages:{extend:!0,value:{en:{invalidValue:"{{elementType}}: Invalid {{property}} value. {{property}} should be of type {{typeOne}} or {{typeTwo}}.",invalidTimeZone:"{{elementType}}: Invalid timeZone value. TimeZone should be from the IANA time zone database.",incorrectArgument:"{{elementType}}: Incorrect argument {{argumentName}} in method {{methodName}}.",agenda:"Agenda",day:"Day",week:"Week",month:"Month",allDay:"All Day",timelineDay:"Timeline Day",timelineWeek:"Timeline Week",timelineMonth:"Timeline Month",newEvent:"New Event",ok:"Ok",cancel:"Cancel",delete:"Delete",label:"Label",dateStart:"Start Date",dateEnd:"End Date",repeat:"Repeat",description:"Description",repeatInterval:"Repeat",repeatStep:"Repeat Every",repeatOn:"Repeat On",repeatEnd:"End Repeat",repeatEndOption:"Never",repeatEndOnOption:"On",repeatEndAfterOption:"After",repeatEndAfter:"occurance(s)"}},type:"object"},minuteFormat:{value:"2-digit",allowedValues:["numeric","2-digit"],type:"string"},monthFormat:{value:"long",allowedValues:["2-digit","numeric","long","short","narrow"],type:"string"},resources:{value:[],type:"any",reflectToAttribute:!1},scrollButtonsPosition:{value:"both",allowedValues:["near","far","both"],type:"string"},spinButtonsDelay:{value:80,type:"number"},spinButtonsInitialDelay:{value:0,type:"number"},timelineHeaderFormatFunction:{value:null,reflectToAttribute:!1,type:"function?"},timelineDayScale:{value:"hour",allowedValues:["hour","halfHour","quarterHour","tenMinutes","fiveMinutes"],type:"string"},timeZone:{value:Intl.DateTimeFormat().resolvedOptions().timeZone,type:"string",validator:"_timeZoneValidator"},timeZones:{value:[],type:"array",validator:"_timeZonesValidator"},tooltipDelay:{value:0,type:"number"},tooltipOffset:{value:[],type:"array"},view:{value:"day",type:"string",validator:"_viewValidator"},viewType:{allowedValues:["agenda","day","week","month","timelineDay","timelineWeek","timelineMonth"],defaultReflectToAttribute:!0,value:"day",type:"string",validator:"_viewTypeValidator"},views:{value:["day","week"],type:"array",validator:"_viewsValidator"},viewSelectorType:{allowedValues:["auto","tabs","menu"],value:"auto",type:"string"},weekdayFormat:{value:"short",allowedValues:["long","short","narrow"],type:"string"},yearFormat:{value:"numeric",allowedValues:["2-digit","numeric"],type:"string"}}}template(){return'<div id="container" role="presentation">\n                    <div id="header" class="smart-scheduler-header">\n                        <div id="dateSelectorContainer" class="smart-scheduler-date-nav">\n                            <smart-repeat-button prev id="previousDate" initial-delay="[[spinButtonsInitialDelay]]" delay="[[spinButtonsDelay]]"\n                             aria-label="Previous date" class="smart-scheduler-nav"></smart-repeat-button>\n                            <smart-button current id="currentDate" right-to-left="[[rightToLeft]]" class="smart-scheduler-nav"></smart-button>\n                            <smart-repeat-button next id="nextDate" initial-delay="[[spinButtonsInitialDelay]]" delay="[[spinButtonsDelay]]" \n                             aria-label="Previous date" class="smart-scheduler-nav"></smart-repeat-button>\n                        </div>\n                        <div id="viewSelectorContainer" class="smart-scheduler-view-nav">\n                            <div id="viewItemsContainer" class="smart-scheduler-items-container"></div>\n                            <smart-button id="viewItemsButton" class="smart-scheduler-view-items-button smart-visibility-hidden" \n                            aria-label="View items popup" right-to-left="[[rightToLeft]]"></smart-button>\n                        </div>\n                    </div>\n                    <div class="smart-scheduler-view-container">\n                        <div id="timeline" class="smart-scheduler-view">\n                                <div id="timelineHeaderHorizontal" class="smart-scheduler-view-header-horizontal" role="rowgroup">\n                                    <div class="smart-scheduler-view-time-container" id="timelineViewCellsContainer" role="rowgroup">\n                                        <div class="smart-scheduler-view-label-container" id="timelineViewCellsLabelContainer" role="row"></div>\n                                        <div class="smart-scheduler-view-header-horizontal-content" id="timelineHeaderHorizontalContent">\n                                            <div class="smart-scheduler-view-details" role="row"></div>\n                                            <div class="smart-scheduler-view-time">\n                                                <div class="smart-scheduler-cells" id="timelineHorizontalViewCells" role="row"></div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                    <div class="smart-scheduler-view-all-day" id="timelineViewAllDay" role="row">\n                                        <div class="smart-scheduler-view-all-day-label-container" id="timelineAllDayLabelContainer" role="row">\n                                            <div class="smart-scheduler-view-all-day-label" id="timelineViewAllDaylabel"></div>\n                                            <div class="smart-scheduler-time-zone-container" id="timelineTimeZoneLabelContainer"></div>\n                                        </div>\n                                        <div class="smart-scheduler-view-all-day-content" id="timelineViewAllDayContent" role="row">\n                                            <div class="smart-scheduler-cells-container" id="timelineViewAllDayCellsContainer"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div id="timelineHeaderVertical" class="smart-scheduler-view-header-vertical" role="rowgroup">\n                                    <div class="smart-scheduler-view-header-vertical-content" id="timelineHeaderVerticalContent">\n                                        <div class="smart-scheduler-view-time">\n                                            <div class="smart-scheduler-cells" id="timelineVerticalViewCells" role="row"></div>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div id="timelineContainer" class="smart-scheduler-scrollable-container">\n                                    <div id="timelineContent" class="smart-scheduler-content">\n                                        <div id="timelineCellsContainer" class="smart-scheduler-cells-container" aria-hidden="true"></div>\n                                    </div>\n                                </div>\n                        </div>\n                        <smart-scroll-bar wait id="verticalScrollBar" class="smart-scheduler-view-scroll-bar" orientation="vertical" \n                        right-to-left="[[rightToLeft]]" aria-controls="[[id]]" animation="[[animation]]"></smart-scroll-bar>\n                        <smart-scroll-bar wait id="horizontalScrollBar" class="smart-scheduler-view-scroll-bar"  \n                        right-to-left="[[rightToLeft]]" aria-controls="[[id]]" animation="[[animation]]"></smart-scroll-bar>\n                    </div>\n                    <div id="footer" class="smart-scheduler-footer"></div>\n                    <smart-tooltip id="tooltip" position="auto" arrow open-mode="manual" delay="[[tooltipDelay]]" offset="[[tooltipOffset]]" class="smart-scheduler-tooltip"></smart-tooltip>\n                </div>'}static get listeners(){return{down:"_downHandler","document.move":"_documentMoveHandler","document.up":"_documentUpHandler","document.dragstart":"_dragStartHandler","container.click":"_containerClickHandler","container.wheel":"_mouseWheelHandler","horizontalScrollBar.change":"_horizontalScrollbarHandler","verticalScrollBar.change":"_verticalScrollbarHandler",keydown:"_keyDownHandler",move:"_moveHandler",resize:"_resizeEventHandler","tooltip.opening":"_tooltipVisibilityHandler","tooltip.closing":"_tooltipVisibilityHandler","tooltip.change":"_tooltipChangeHandler","tooltip.click":"_tooltipClickHandler","timeline.focus":"_timelineFocusHandler","viewItemsContainer.keydown":"_viewItemsContainerKeyDown"}}static get styleUrls(){return["smart.scheduler.css"]}static get requires(){return{"Smart.Window":"smart.window.js","Smart.Calendar":"smart.calendar.js"}}propertyChangedHandler(e,t,i){super.propertyChangedHandler(e,t,i);const n=this;switch(e){case"firstDayOfWeek":case"max":case"min":n._calendar&&(n._calendar[e]=i),n._createTimeline(),n._refreshDateNavButtons();break;case"hideAllDay":["day","week"].indexOf(n.viewType)>-1&&n._createTimeline();break;case"hideWeekend":case"hideNonworkingWeekdays":["week","month"].indexOf(n.viewType.toLowerCase())>-1&&n._createTimeline();break;case"timeZones":n._createTimelineHeader();break;case"dateCurrent":case"groups":case"groupOrientation":case"hourStart":case"hourEnd":case"nonworkingDays":case"nonworkingHours":case"timelineDayScale":n._createTimeline();break;case"view":n._handleViewSelection(),n._createTimeline(),n._refreshDateSelector(),n._scrollToView(),n.$.fireEvent("viewChange",{oldValue:t,value:i});break;case"viewSelectorType":n._setHeader();break;case"cellTemplate":case"groupTemplate":n._templates&&delete n._templates[e],n._createTimeline();break;case"unfocusable":n._setFocusable()}}attached(){const e=this;super.attached(),e._scrollView||(e._scrollView=new Smart.Utilities.Scroll(e.$.timeline,e.$.horizontalScrollBar,e.$.verticalScrollBar));const t=e.$.schedulerWindow;if(t&&t.opened){const i=e.$schedulerWindow;e._handleModal(!0),i.listen("open",e._windowOpenHandler.bind(e)),i.listen("close",e._windowCloseHandler.bind(e)),i.listen("closing",e._windowClosingHandler.bind(e)),i.listen("click",e._windowClickHandler.bind(e)),i.listen("change",e._windowChangeHandler.bind(e)),t.hasAnimation&&t.listen("transitionend",e._windowTransitionendHandler.bind(e)),e.getShadowRootOrBody().appendChild(t)}}detached(){const e=this;super.detached(),e._scrollView&&(e._scrollView.unlisten(),delete e._scrollView);const t=e.$.schedulerWindow;if(e._handleModal(),t){t.remove();const i=e.$schedulerWindow;i.unlisten("open"),i.unlisten("close"),i.unlisten("closing"),i.unlisten("click"),i.unlisten("change"),i.unlisten("transitionend")}}render(){this._setViewType(),this.setAttribute("role","treegrid"),this._setScrollBars(),this._setHeader(),this._createEvents(),this._createTimeline(),this._setFocusable(),super.render()}refresh(e){}insertAppointment(){}updateAppointment(){}removeAppointment(){}insertResource(){}updateResource(){}removeResourse(){}beginUpdate(){}endUpdate(){}scrollToDate(e){const t=this;if(e instanceof Date)e=new Date(e);else{if(e instanceof HTMLElement&&(!e.classList.contains("smart-scheduler-cell")||!t.$.timeline.contains(e)))return;if("object"==typeof e){const i=new Date(t.dateCurrent);e.year=void 0!==e.year?e.year:i.getFullYear(),e.month=void 0!==e.month?e.month:i.getMonth(),e.date=void 0!==e.date?e.date:i.getDate(),e=new Date(e.year,e.month,e.date,e.hours,e.getMinutes)}}e&&!isNaN(e.getTime())&&t._scrollTo(e)}openWindow(e){}closeWindow(){}openAppointmentTooltip(e){}closeAppointmentTooltip(){}_checkDoubleClick(e){const t=this;let i=e.target;if(t.shadowRoot&&i===t&&(i=e.composedPath()[0]),void 0===t._dblClickDetails&&(t._dblClickDetails={clicks:0}),clearTimeout(t._dblClickDetails.timeOut),i!==t._dblClickDetails.target&&(t._dblClickDetails.clicks=0),t._dblClickDetails.target=i,t._dblClickDetails.clicks++,t._dblClickDetails.timeOut=setTimeout((function(){t._dblClickDetails&&(t._dblClickDetails.clicks=0)}),300),2===t._dblClickDetails.clicks)return t._doubleClickHandler(e),t._dblClickDetails.clicks=0,!0}_doubleClickHandler(e){const t=this;let i=e.target;if(t.disabled||t.disableWindowEditor)return;t.shadowRoot&&i===t&&(i=e.composedPath()[0]);let n=i.closest?i.closest(".smart-scheduler-cell:not(.scale)"):void 0;(t.$.timelineContainer.contains(n)||t.$.timelineViewAllDay.contains(n))&&t._openWindow()}_createEventFromSelection(e){const t=this;if(e||(e=t._selectedCellObj),e instanceof HTMLElement&&e.$&&(e={from:e.$.cellObj,to:e.$.cellObj}),!e||!e.from)return;const i=e.from,n=new Date(i.time),l=new Date(e.to.time),r=i[t.groupOrientation].group;i.allDay?(l.setDate(l.getDate()+1),l.setHours(0,0,0,0)):l.setHours(l.getHours(),l.getMinutes()+60/t._getCellsScaleCount(),0,0);const a={allDay:i.allDay,dateStart:n,dateEnd:l};if(r)for(let e in r)a[e]=r[e];return a}_downHandler(e){const t=this,i=e.originalEvent,n=t.shadowRoot||t.isInShadowDOM?i.composedPath()[0]:i.target;if(e.stopPropagation(),t._dragDetails)return void delete t._dragDetails;if(!Smart.Utilities.Core.isMobile&&0!==e.button||!t.$.timeline.contains(n))return;const l=n.closest(".smart-scheduler-cell");if(t._dragDetails={target:n},l&&l.$&&(t.$.timelineContainer.contains(l)||t.$.timelineViewAllDay.contains(l))){const n=l.$.cellObj;if(!n)return;if(t._dragDetails.timelineCellObj=n,t._checkDoubleClick(i))return;e.shiftKey&&t._selectedCellObj?t._handleCellSelection(t._selectedCellObj.from,n):t._handleCellSelection(n)}}_documentMoveHandler(e){const t=this,i=t._dragDetails;if(!i)return;const n=e.originalEvent;let l=t.shadowRoot||t.isInShadowDOM?n.composedPath()[0]:n.target;if("agenda"!==t.viewType&&!e.shiftKey){const e=i.timelineCellObj,n=t.$.timeline.contains(l)?l.closest(".smart-scheduler-cell:not(.scale)"):void 0;e&&n&&t._selectCell(e,n)}}_documentUpHandler(e){const t=this,i=e.originalEvent,n=t._dragDetails;let l=t.shadowRoot||t.isInShadowDOM?i.composedPath()[0]:i.target;if(t._upHandler(),!n||e.shiftKey&&t._selectedCellObj||t._handleCellSelection(n.timelineCellObj,l.closest?l:void 0),n)delete t._dragDetails;else{const e=t.$.schedulerWindow;t.contains(l)&&l.classList.contains("smart-scheduler-window-modal")&&e&&e.focus()}}_dragStartHandler(e){const t=e.target.closest;(this._dragDetails||t&&t.call(this,"smart-scheduler")===this)&&e.preventDefault()}_keyDownHandler(e){const t=this;if(!t.readonly)switch(e.key){case"End":case"Home":case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"PageDown":case"PageUp":e.preventDefault(),t._handleKeyNavigation(e);break;case"Enter":case"Escape":if("Enter"===e.key&&e.target===t.$.timeline){t._openWindow();break}e.preventDefault(),t.$.tooltip.close()}}_viewItemsContainerKeyDown(e){e.stopPropagation(),this._keyDownHandler(e)}_handleKeyNavigation(e){const t=this,i=t.enableShadowDOM?e.composedPath()[0]:e.target,n=t.viewType.toLowerCase(),l=n.indexOf("timeline")>-1,r=e.key;if(i===t.$.timeline){const i=t.$.timelineContent,a=t.$.timelineViewAllDay,o=a.offsetHeight>0;if(!t._selectedCellObj)return t._handleCellSelection((o?a:i).querySelector(".smart-scheduler-cell:not(.scale)")),void(t._selectedCellObj&&t._scrollTo(t._selectedCellObj.to));const s=t._selectedCellObj[e.shiftKey?"to":"from"],d=t._getCellsScaleCount(),c=s.scaleIndex||0,u=d-1;let m,h,[p,g,f]=[s.horizontal,s.vertical,c],v=s.allDay;switch(r){case"Home":case"End":m=t._timelineCells[l?"horizontal":"vertical"],[h,f,v]="Home"===r?[m[0],0,!e.shiftKey&&o]:[m[m.length-1],u,!1],[p,g]=l?[h,g]:[p,h];break;case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":{const e=["ArrowUp","ArrowDown"].indexOf(r)>-1,i="ArrowLeft"===r||"ArrowUp"===r?-1:1;[m,h]=e?[t._timelineCells.vertical,g]:[t._timelineCells.horizontal,p],e&&l||!e&&!l?h=m[m.indexOf(h)+i]:(f+=i,(f<0||f>u)&&(h=m[m.indexOf(h)+i],f=f>u?0:u)),[p,g]=e?[p,h]:[h,g];break}case"PageDown":case"PageUp":{if(l||s.allDay)break;const e=s.vertical.top+t.$.timelineContainer.offsetHeight*("PageUp"===r?-1:1),i=t._timelineCells.vertical;g=t._timelineCells.vertical.find(t=>t.top>=e),g||(g="PageUp"===r?i[0]:i[i.length-1]);break}}v&&"ArrowDown"===r?(g=t._timelineCells.vertical[0],f=0,v=!1):"ArrowUp"!==r||g||(v=o);const w=t._getCellByObj({horizontal:p,vertical:g,scaleIndex:f,allDay:v});if(w){const i=t._selectedCellObj.from;t._handleCellSelection("agenda"!==n&&e.shiftKey&&!!i.allDay==!!v?i:w,w)}}else if(i===t.$.viewItemsContainer){const e=t.$.viewItemsContainer.children,n=Array.from(e).find(e=>e.hasAttribute("selected"));let l;n&&"Home"!==r?"End"===r?l=e[e.length-1]:(t.$.tooltip.contains(i)&&("ArrowUp"===r||"ArrowDown"===r)||t.$.header.contains(i)&&("ArrowLeft"===r||"ArrowRight"===r))&&(l=n["ArrowUp"===r||"ArrowLeft"===r?"previousElementSibling":"nextElementSibling"]):l=e[0],l&&n!==l&&t._handleViewSelection(l)}}_getCellByObj(e){if(!e)return;if(!this._scrollTo(e))return;const t=e.allDay?this.$.timelineViewAllDay:this.$.timelineCellsContainer,i=Array.from(t.querySelectorAll(".smart-scheduler-cell:not(.scale)")),n=Object.keys(e);return i.find(t=>n.every(i=>e[i]===t.$.cellObj[i]||void 0===t.$.cellObj[i]))}_scrollTo(e){const t=this,i=t._getCellsScaleCount(),n=t.viewType.toLowerCase(),l=n.indexOf("timeline")>-1;let r,a,o,s,d,c,u;if(e instanceof Date){if(!e||isNaN(e.getTime()))return;const s=t._timelineCells.horizontal,d=t._timelineCells.vertical;if("agenda"===n){if(a=d.find(t=>t.date.getTime()>=e.getTime()),!a)return}else if(l){if(r=s.find(t=>t.date.getTime()>=e.getTime()),!r)return}else if(r=s.find(t=>t.date.getTime()>=e.getTime()),a=d.find(t=>t.date.getTime()>=e.getTime()),!r||!a)return;o=Math.floor(e.getMinutes()/60*i)}else{if(e instanceof HTMLElement&&e.$&&(e=e.$.cellObj),!e)return;r=e.horizontal||e,a=e.vertical||e,o=e.scaleIndex||0}const m=()=>{const e=t[s];e>u?t[s]=u:e+c<u+d&&(t[s]=Math.max(0,u+d-c))};return r&&([s,d,c]=["scrollLeft",r.width/(l?i:1),t.$.timelineContainer.offsetWidth],u=r.left+d*(l?o:0),m()),a&&([s,d,c]=["scrollTop",a.height/(l?1:i),t.$.timelineContainer.offsetHeight],u=a.top+d*(l?0:o),m()),!0}_mouseWheelHandler(e){const t=this,i=e.target;t.$.viewSelectorContainer.contains(i)?t._handleViewNavigation(e):t.disabled||!t.computedHorizontalScrollBarVisibility&&!t.computedVerticalScrollBarVisibility||(e.shiftKey?t._handleHorizontalScroll():t._handleVerticalScroll())}_handleCellSelection(e,t){this._selectCell(e,t)}_selectCell(e,t){const i=this;function n(){const e=i.$.timeline.querySelectorAll(".smart-scheduler-cell[selected]");for(let t=0;t<e.length;t++)e[t].removeAttribute("selected");delete i._selectedCellObj}if(t||(t=e),!e)return void n();let l=e,r=t;if(e.closest){const t=e.closest(".smart-scheduler-cell:not(.scale)");if(!t||!i.$.timeline.contains(t))return;l=t.$?t.$.cellObj:void 0}if(t.closest){const e=t.closest(".smart-scheduler-cell:not(.scale)");if(!e||!i.$.timeline.contains(e))return;r=e.$?e.$.cellObj:void 0}if(!l||!r||l.allDay!==r.allDay)return;const a=i.view,o=i.views.find(e=>e.value&&e.value===a)||{},s=o&&o.groupOrientation?o.groupOrientation:i.groupOrientation,d=(l[s]||l).group;if(d!==(r[s]||r).group)return;n();let c,[u,m]=[l.time,r.time];if(u>m){const e=u;u=m,m=e}if("agenda"===i.viewType&&u!==m)return;i._selectedCellObj={from:Object.assign({},l),to:Object.assign({},r)};const h=(l.allDay?i.$.timelineViewAllDay:i.$.timelineContent).querySelectorAll(".smart-scheduler-cell:not(.scale)");for(let e=0;e<h.length;e++){if(c=h[e],c.removeAttribute("selected"),!c.$)continue;const t=c.$.cellObj;if((t[s]||t).group!==d)continue;const i=t.time,n=Object.keys(t);i>=u&&i<=m&&c.setAttribute("selected",l===r||n.every(e=>t[e]===l[e])?"start":"")}i._scrollTo(r)}_getCellTime(e){if(!e)return 0;const t=this,i=t.viewType;let n,l;if(e instanceof HTMLElement&&e.closest(".smart-scheduler-cell:not(.scale)")){if(!e.$||!e.$.cellObj)return 0;n=e.$.cellObj}else n=e;if("agenda"===i)return n.vertical.date.getTime();if("month"===i){l=new Date(n.vertical.date);const e=new Date(n.horizontal.date).getDay()-t.firstDayOfWeek;return l.setDate(l.getDate()+(e<0?7+e:e)),l.getTime()}const r=n.scaleIndex||0,a=60/t._getCellsScaleCount()*60*1e3;return i.indexOf("timeline")<0?(l=new Date(n.horizontal.date),n.allDay||l.setHours(n.vertical.date.getHours())):l=new Date(n.horizontal.date),l.getTime()+a*r}_handleVerticalScroll(){if(!this.computedVerticalScrollBarVisibility)return!0;const e=this.scrollTop;0===e&&event.deltaY<0||e===this.scrollHeight&&event.deltaY>0?event.stopPropagation():(event.stopPropagation(),event.preventDefault(),this.scrollTo(e+this._getScrollCoefficient(event,this.offsetHeight)))}_handleHorizontalScroll(){const e=this;if(!e.computedHorizontalScrollBarVisibility)return!0;const t=e.scrollLeft;(0===t&&event.deltaX<0||t===e.scrollHeight&&event.deltaX>0)&&event.stopPropagation(),event.stopPropagation(),event.preventDefault(),e.scrollWidth>0&&e.scrollTo(void 0,e.scrollLeft+e._getScrollCoefficient(event,e.offsetWidth))}_horizontalScrollbarHandler(e){e.stopPropagation(),this.$.timelineContainer.scrollLeft=this._getScrollLeft(e.detail.value),this._recycle(e)}_verticalScrollbarHandler(e){e.stopPropagation(),this.$.timelineContainer.scrollTop=Math.round(e.detail.value),this._recycle(e)}_recycle(e){const t=this;return e?"horizontal"===e.context.orientation?(t._recycleHeaderCells(t.$.timelineHeaderHorizontalContent),t._refreshTimelineContentCells(),void t._refreshTimelineAllDayCells()):(t._recycleHeaderCells(t.$.timelineHeaderVerticalContent),void t._refreshTimelineContentCells()):(t._recycleHeaderCells(t.$.timelineHeaderHorizontalContent),t._recycleHeaderCells(t.$.timelineHeaderVerticalContent),t._refreshTimelineContentCells(),void t._refreshTimelineAllDayCells())}_recycleHeaderCells(e){const t=this,[i,n,l,r]=e===t.$.timelineHeaderHorizontalContent?["horizontal","left","width","scrollLeft"]:["vertical","top","height","scrollTop"],a=e.querySelector(".smart-scheduler-view-time"),o=t._timelineCells[i];if(!o||!o.length)return;const s=t._getFirstCellObjInView(i),d=t._getTimelineVisibleCellsCount(i),c=a.children;for(let e=0;e<c.length;e++){const r=c[e],a=r.children;let u=document.createDocumentFragment();for(;a.length;)u.appendChild(r.firstElementChild);t._recycleContainerCells({fragment:u,cellsNeeded:d});let m=o.indexOf(s);for(let r=0;r<u.children.length;r++){const a=u.children[r],s=o[m];if(a.$={cellObj:s},!s)break;"horizontal"===i?a.style[t.rightToLeft?"right":"left"]=s.left+"px":a.style[n]=s[n]+"px",a.style[l]=s[l]+"px",a.innerHTML=`<div>${s.noLabel?"":t._getDateString({date:new Date(s.date),timeZone:c[e].timeZone},i)}</div>`,s.weekend?a.setAttribute("weekend",""):a.removeAttribute("weekend"),s.nonworking?a.setAttribute("nonworking",""):a.removeAttribute("nonworking"),s.separator?a.setAttribute("separator",""):a.removeAttribute("separator"),s.groupSeparator?a.setAttribute("group-separator",""):a.removeAttribute("group-separator"),s.showLabel?a.setAttribute("show-label",s.showLabel):a.removeAttribute("show-label"),m++}r.appendChild(u)}t._refreshHeaderDetailCells(i),t._refreshHeaderGroupCells(i),e[r]=t[r]}_moveHandler(e){Smart.Utilities.Core.isMobile||e.stopPropagation(),(this.hasAttribute("dragged")||this.hasAttribute("resized"))&&"touchmove"===e.originalEvent.type&&e.originalEvent.preventDefault()}_getScrollLeft(e,t){const i=this;return i.rightToLeft?(Smart.Utilities.Core.Browser.Chrome?(t||(t=i.scrollWidth),e=t-e):e*=-1,e):e}_containerClickHandler(e){const t=this,i=t.$.tooltip,n=(e||e.originalEvent).target;if(t.$.dateSelectorContainer.contains(n))t._handleDateSelection(n.closest(".smart-scheduler-nav"));else if(!i.contains(n)){if(n.closest(".smart-scheduler-view-items-button")){const e=i.visible&&!i.contains(t.$.viewItemsContainer);return t._handleTooltipContent(t.$.viewItemsButton),void(e||i.toggle())}if(i.close(),t.$.viewSelectorContainer.contains(n)){const e=n.closest(".smart-scheduler-nav");return e?void t._handleViewNavigation(e):void t._handleViewSelection(n.closest(".smart-scheduler-item"))}}}_handleViewNavigation(e){let t;if(!e)return;const i=this.$.viewItemsContainer;t=e instanceof Smart.RepeatButton?10*(e.hasAttribute("prev")?-1:1):e.deltaY,i.scrollLeft+=t;const n=this._viewButtons;if(!n)return;t=i.scrollLeft;const l=n.prev,r=n.next;l.disabled=!t,r.disabled=i.offsetWidth+t===i.scrollWidth}_handleDateSelection(e){const t=this,i=t.$.tooltip;if(e instanceof HTMLElement)if(e.hasAttribute("prev"))i.close(),t._navigateDate(-1);else if(e.hasAttribute("current")){const e=i.visible&&!i.contains(t._calendar);t._handleTooltipContent(t.$.currentDate),e||i.toggle()}else e.hasAttribute("next")&&(i.close(),t._navigateDate(1))}_navigateDate(e){const t=this,i=t.viewType.toLowerCase();let n=t.dateCurrent,l=new Date(n);if(l.setHours(0,0,0,0),i.includes("day"))l.setDate(l.getDate()+e);else if(i.includes("week")||"agenda"===i)l.setDate(l.getDate()+7*e);else{let t=new Date(l);e>0?(t.setDate(1),t.setMonth(t.getMonth()+2),t.setDate(0)):t.setDate(0),l.setMonth(l.getMonth()+e),l.getMonth()!==t.getMonth()&&(l=t)}l.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t._refreshDateNavButtons(l),l.getTime()>t.max||l.getTime()<t.min||(t.set("dateCurrent",l),t._calendar&&(t._calendar.selectedDates=[new Date(t.dateCurrent)],t.$.tooltip.contains(t._calendar))||(t._createTimeline(),t._refreshDateSelector()))}_refreshDateNavButtons(e){const t=this;e||(e=t.dateCurrent);const i=t.$.dateSelectorContainer,n=i.querySelector(".smart-scheduler-nav[prev]"),l=i.querySelector(".smart-scheduler-nav[next]");n&&(n.disabled=e.getTime()<=t.min),l&&(l.disabled=e.getTime()>=t.max)}_handleTooltipContent(e){const t=this,i=t.$.tooltip;function n(e){i.contains(e)||(i.clear(),i.appendChild(e))}if(e===t.$.currentDate){i.selector=t.$.currentDate;let e=t._calendar;e||(e=document.createElement("smart-calendar"),e.firstDayOfWeek=t.firstDayOfWeek,e.selectionMode="oneExtended",e.selectedDates=[new Date(t.dateCurrent)],e.max=t.max,e.min=t.min,e.classList.add("smart-scheduler-calendar-popup"),t._calendar=e),n(e)}else e===t.$.viewItemsButton&&(i.selector=t.$.viewItemsButton,n(t.$.viewItemsContainer))}_tooltipVisibilityHandler(e){const t=this,i=t.getRootNode().host||t.getRootNode();if(e.stopPropagation(),i!==document&&!document.body.contains(i))return;const n=t.$.tooltip;if("opening"===e.type){n.classList.remove("smart-visibility-hidden"),t.getShadowRootOrBody().appendChild(n);const e=n.$.content instanceof HTMLElement?n.$.content.querySelector("[tabindex]"):null;e&&e.focus()}else t.hasAnimation?n.addEventListener("animationend",()=>{n.visible||(n.classList.add("smart-visibility-hidden"),t.$.container.appendChild(n))},{once:!0}):t.$.container.appendChild(n)}_tooltipChangeHandler(e){const t=this,i=t._calendar;if(e.target===i)return e.stopPropagation(),t.set("dateCurrent",i.selectedDates[0]||t.dateCurrent),t._refreshDateSelector(),t._createTimeline(),void e.context.close()}_tooltipClickHandler(e){const t=this,i=t.isInShadowDOM?(e||e.originalEvent).composedPath()[0]:(e||e.originalEvent).target;if(t.$.viewItemsContainer.contains(i))return t._handleViewSelection(i.closest(".smart-scheduler-item")),void t.$.tooltip.close()}_timelineFocusHandler(){const e=this,t=e.$.timelineViewAllDay,i=t.offsetHeight>0;e._dragDetails&&e._dragDetails.timelineCellObj||(e._selectedCellObj?e._selectedCellObj.from.time!==e._selectedCellObj.to.time&&e._handleCellSelection(e._selectedCellObj.from):e._handleCellSelection((i?t:e.$.timelineContent).querySelector(".smart-scheduler-cell:not(.scale)")))}_handleViewSelection(e){const t=this,i=t.$.viewItemsContainer.children;let n;e instanceof HTMLElement&&(n=e.$?e.$.value:null),n||(n=t.view);for(let t=0;t<i.length;t++){const l=i[t];l.removeAttribute("selected"),!e&&l.$&&l.$.value===n&&(e=l)}if(!e)return;e.setAttribute("selected","");const l=t.view;n!==l&&(t.set("view",n),t._createTimeline(),t._refreshDateSelector(),t._scrollToView(e),t.$.fireEvent("viewChange",{oldValue:l,value:n}))}_scrollToView(e){if("tabs"!==this.viewSelectorType)return;const t=this.$.viewItemsContainer;if(!(e=e||t.querySelector(".smart-scheduler-item[selected]")))return;const i=t.offsetWidth,n=e.offsetLeft,l=e.offsetWidth;let r=t.scrollLeft;r>n?r=t.scrollLeft=n:r+i<n+l&&(r=t.scrollLeft=Math.max(0,n+l-i));const a=this._viewButtons;a.prev.disabled=!r,a.next.disabled=r+i===t.scrollWidth}_resizeEventHandler(){const e=this;clearTimeout(e._resizeTimeout),e._resizeTimeout=setTimeout((function(){if(e._noResizeHandler)return void delete e._noResizeHandler;e._positionWindow();const t=e.$.tooltip;t.visible&&t._applyPosition(),e._createTimeline(),e._refreshViewSelector()}),20)}_setScrollBars(){const e=this;e._scrollView||(e._scrollView=new Smart.Utilities.Scroll(e.$.timeline,e.$.horizontalScrollBar,e.$.verticalScrollBar));const t=e._scrollView.vScrollBar,i=e._scrollView.hScrollBar;i.$.addClass("smart-hidden"),t.$.addClass("smart-hidden"),t.hasStyleObserver=!1,i.hasStyleObserver=!1,t.hasResizeObserver=!1,i.hasResizeObserver=!1,i.wait=!1,t.wait=!1,e._refresh()}_setFocusable(){const e=this;if(e.disabled||e.unfocusable)return e.removeAttribute("tabindex"),e.$.timeline.removeAttribute("tabindex"),void e.$.viewItemsContainer.removeAttribute("tabindex");const t=e.tabIndex>0?e.tabIndex:0;e.tabIndex=t,e.$.timeline.tabIndex=t,e.$.viewItemsContainer.tabIndex=t}_refresh(){const e=this;function t(){const t=e.$.timelineContent.offsetWidth-e.$.timelineContainer.offsetWidth;return t>0&&"hidden"!==e.horizontalScrollBarVisibility||"visible"===e.horizontalScrollBarVisibility?e.$container.addClass("hscroll"):e.$container.removeClass("hscroll"),t}function i(){const t=e.$.timelineContent.offsetHeight-e.$.timelineContainer.offsetHeight;return t>0&&"hidden"!==e.verticalScrollBarVisibility||"visible"===e.verticalScrollBarVisibility?e.$container.addClass("vscroll"):e.$container.removeClass("vscroll"),t}const n=e.scrollWidth,l=e.scrollHeight;let r=t(),a=i();a&&l===a||(r=t()),r&&n===r||(a=i()),e.scrollWidth=r,e.scrollHeight=a,e.$.horizontalScrollBar.refresh(),e.$.verticalScrollBar.refresh()}_setHeader(){const e=this,t=e.$.header;if(e.headerTemplate)return void(t.innerHTML="");const i=e.$.dateSelectorContainer;t.contains(i)||(t.innerHTML="",t.appendChild(i),t.appendChild(e.$.viewSelectorContainer)),e._refreshDateSelector(),e._refreshViewSelector()}_refreshDateSelector(){const e=this;let t=new Date(e.dateCurrent);isNaN(t.getTime())&&(t=new Date);let i="";if(e.dateSelectorFormatFunction)i=e.dateSelectorFormatFunction(t)+"";else{const n=e.viewType.toLowerCase();if(n.indexOf("day")>-1)i=t.toLocaleDateString(e.locale,{day:e.dayFormat,timeZone:e.timeZone});else if(n.indexOf("week")>-1||"agenda"===n){const l=new Date(t),r=new Date(t);"agenda"!==n&&l.setDate(l.getDate()-l.getDay()+e.firstDayOfWeek),r.setDate(l.getDate()+6),i=l.toLocaleDateString(e.locale,{day:e.dayFormat,timeZone:e.timeZone})+"-"+r.toLocaleDateString(e.locale,{day:e.dayFormat,timeZone:e.timeZone})}i+=" "+t.toLocaleDateString(e.locale,{month:e.monthFormat,timeZone:e.timeZone})+" "+t.toLocaleDateString(e.locale,{year:e.yearFormat,timeZone:e.timeZone})}e.$.currentDate.innerHTML=i}_refreshViewSelector(){const e=this,t=e.views,i=e.viewSelectorType,n=e.$.viewSelectorContainer,l=e.$.viewItemsContainer,r=e.$.viewItemsButton,a=e.$.tooltip,o=a.contains(l);for(n.classList.add("smart-visibility-hidden"),r.classList.add("smart-visibility-hidden"),n.classList.remove("no-overflowing"),l.remove();t.length<l.children.length;)l.firstElementChild.remove();for(;t.length>l.children.length;){const e=document.createElement("div");e.classList.add("smart-scheduler-item"),l.appendChild(e)}const s=l.children;for(let i=0;i<s.length;i++){const n=s[i],l=t[i];let r;if("string"==typeof t[i])n.innerHTML="<div>"+e.localize(r=t[i])+"</div>";else{const t=l.label;r=l.value,n.innerHTML="<div>"+("string"!=typeof t&&isNaN(t)?e.localize(r):t)+"</div>"}n.$={value:r}}if(n.appendChild(l),e._viewButtons)for(let t in e._viewButtons)e._viewButtons[t].remove();const d=n.offsetWidth-l.offsetWidth<0;if("tabs"===i){let t,i;return o&&a.close(),d&&(e._viewButtons||(t=document.createElement("smart-repeat-button"),i=document.createElement("smart-repeat-button"),t.classList.add("smart-scheduler-nav"),i.classList.add("smart-scheduler-nav"),t.setAttribute("prev",""),i.setAttribute("next",""),e._viewButtons={prev:t,next:i}),t=e._viewButtons.prev,i=e._viewButtons.next,n.classList.add("no-overflowing"),n.insertBefore(t,l),n.appendChild(i)),n.classList.remove("smart-visibility-hidden"),void e._handleViewSelection()}delete e._viewButtons,"menu"===i||d?(o?(a.clear(),a.appendChild(l)):l.remove(),r.classList.remove("smart-visibility-hidden")):o&&a.close(),n.classList.remove("smart-visibility-hidden"),e._handleViewSelection()}_createEvents(e){const t=this;let i=void 0!==e;if(i||(e=t.dataSource,t._clearEvents()),!Array.isArray(e)||!e.length)return;let n=[];for(let i=0;i<e.length;i++){const l=e[i];let r,a;const o=!!l.allDay;if(r=t._dateValidator(void 0,l.dateStart),a=t._dateValidator(void 0,l.dateEnd),!r.getTime())continue;if(!a.getTime()){if(!o)continue;a=new Date(r),a.setHours(23,59,59,999)}const s=Object.assign({},l,{dateStart:r,dateEnd:a,allDay:o,label:l.label||""});n.push(s)}if(i)return n;t._events=n}_clearEvents(e){const t=this,i=t._events;e||(e=!i||!i.length),t._events=[],e||t.$.fireEvent("change",{oldValue:[],value:[]}),t.rendered&&(t.viewType.indexOf("agenda")>-1?t._createTimeline():t._refreshTimelineContentCells())}_createTimeline(){const e=this,t=e.resizeTrigger;let i,n;t&&(i=t.offsetWidth,n=t.offsetHeight,t.style.display="none"),delete e._selectedCellObj,e._createTimelineHeader(),e._refreshTimelineContentCells(),t&&(t.style.display=null,i===t.offsetWidth&&n===t.offsetHeight||(e._noResizeHandler=!0))}_createTimelineHeader(){const e=this,t=e.$.timelineContent;if(t.style.width=t.style.height=null,Smart.Utilities.Core.Browser.Chrome){const t=e.$.timelineHeaderVertical;t.style.display="none",t.offsetHeight,t.style.display=null}e._createTimelineCellsObj(),e._createTimelineHeaderCells("horizontal"),e._createTimelineHeaderCells("vertical"),e._refreshTimelineHeaderCells(),e._refreshTimelineAllDayCells(),e._refresh()}_handleTimelineGroupHeader(e){const t=this,i=t._timelineCells.groups;let n=t.$.groupsContainer;if(!i||!i.length||"agenda"===t.viewType&&!Object.keys(e.vertical).length)return void(n&&n.remove());n||(n=document.createElement("div"),n.classList.add("smart-scheduler-groups-container"),n.innerHTML='\n                        <div class="smart-scheduler-view-groups-label-container" role="row"></div>\n                        <div class="smart-scheduler-view-groups-content" role="row">\n                            <div class="smart-scheduler-view-header-groups-container"></div>\n                        </div>',t.$.groupsContainer=n);const l=t.view,r=t.views.find(e=>e.value&&e.value===l)||{},a="vertical"!==(r&&r.groupOrientation?r.groupOrientation:t.groupOrientation)?t.$.timelineHeaderHorizontal:t.$.timelineHeaderVertical;a.contains(n)||a.insertBefore(n,a.firstElementChild)}_handleTimeZoneHeader(e){const t=this;e||(e="horizontal",t._handleTimeZoneHeader("vertical"));const i=t.viewType.toLowerCase(),n=i.indexOf("timeline")>-1,l=("vertical"===e?t.$.timelineHeaderVerticalContent:t.$.timelineHeaderHorizontalContent).querySelector(".smart-scheduler-view-time"),r=l.children,a=t.$.timelineViewCellsLabelContainer,o=!n&&"agenda"!==i&&"vertical"===e||"horizontal"===e&&n;let s=t.timeZones.slice(0);const d=t.$.viewDetailsLabel,c=t.$.timelineTimeZoneLabelContainer;if(c.remove(),d&&d.remove(),t._recycleContainerCells({fragment:l,cellsNeeded:1+(o&&i.indexOf("month")<0?s.length:0),className:"smart-scheduler-cells"}),s.push(t.timeZone),(n&&o||!n)&&t._recycleContainerCells({fragment:a,cellsNeeded:!n&&i.indexOf("month")<0&&"agenda"!==i?s.length:0,className:"smart-scheduler-time-zone"}),o){const e=c.parentElement;t._recycleContainerCells({fragment:c,cellsNeeded:1===r.length?0:r.length,className:"smart-scheduler-time-zone"}),r.length&&e&&e.appendChild(c)}}_createTimelineHeaderCells(e="vertical"){const t=this,i=t.viewType.toLowerCase(),n=i.indexOf("timeline")>-1,l="vertical"===e?t.$.timelineHeaderVerticalContent:t.$.timelineHeaderHorizontalContent,r=l.querySelector(".smart-scheduler-view-time"),a=l.querySelector(".smart-scheduler-view-details"),o=r.children,s=!n&&"agenda"!==i&&"vertical"===e||"horizontal"===e&&n;let d=t.timeZones.slice(0);const c=t._getTimelineVisibleCellsCount(e),u=t.timeZone,m=o.length;d.push(t.timeZone);for(let e=0;e<m;e++){const i=o[e],n=d[e];i.timeZone=1===m?u:n.id||n,t._recycleContainerCells({fragment:i,cellsNeeded:c})}if(a&&t._recycleContainerCells({fragment:a,cellsNeeded:t._getTimelineVisibleCellsCount({orientation:e,type:"details"})}),t._createTimelineHeaderGroupCells(e),s){const e=t.$.timelineTimeZoneLabelContainer,l=t.$.timelineViewCellsLabelContainer;e.remove();const r=t.$.timelineAllDayLabelContainer;let o=t.$.viewDetailsLabel;if(n&&i.indexOf("week")>-1&&a?(o||(o=document.createElement("div"),o.classList.add("smart-scheduler-view-details-label"),t.$.viewDetailsLabel=o),o.parentElement||l.appendChild(o)):o&&o.parentElement&&o.remove(),!e.children.length)return;!n&&r.offsetHeight?r.appendChild(e):l.offsetHeight&&l.appendChild(e)}}_createTimelineHeaderGroupCells(e){const t=this,i=t.view,n=t.viewType,l=n.indexOf("timeline")>-1,r=t.views.find(e=>e.value&&e.value===i)||{},a=t._timelineCells,o=a.groups,s=r&&r.groupOrientation?r.groupOrientation:t.groupOrientation;let d=t.$.groupsContainer;if("vertical"===e&&"vertical"!==s||("horizontal"===e&&"day"!==n||!e)&&"vertical"===s)return;if(d&&d.remove(),!o||!o.length||"agenda"===n&&!a.vertical.length)return;const c=t._timelineCells.groups,u=d.querySelector(".smart-scheduler-view-header-groups-container"),m=u.children;t._recycleContainerCells({fragment:u,cellsNeeded:c.length,className:"smart-scheduler-cell-container"});for(let i=0;i<m.length;i++)t._recycleContainerCells({fragment:m[i],cellsNeeded:t._getTimelineVisibleCellsCount({orientation:e,type:"groups",resource:c[i].resource})});let h="vertical"===e||n.toLowerCase().indexOf("month")>-1?0:t.timeZones.length+("month"===n?0:1);if(l&&(h=h>1?1:0),"agenda"===n&&(h="vertical"!==s&&t._timelineCells.vertical.length?1:0),t._recycleContainerCells({fragment:d.querySelector(".smart-scheduler-view-groups-label-container"),cellsNeeded:h,className:"smart-scheduler-time-zone"}),!d.parentElement&&e===s){const i="horizontal"===e?t.$.timelineHeaderHorizontal:t.$.timelineHeaderVertical;i.insertBefore(d,i.firstElementChild)}}_recycleContainerCells(e){const t=this,i=e.fragment;if(!i)return;const n=i.children,l=i.children.length,r=e.cellsNeeded,a=e.className,o=e.isBackwards?"lastElementChild":"firstElementChild";if(l>r)for(;n.length&&n.length!==r;)i.removeChild(i[o]);else l<r&&i.appendChild(t._createCells(r-l,a))}_createTimelineCellsObj(){const e=this,t=e.viewType,i=t.indexOf("timeline")>-1,n=e._getCellsCount(),l=e._getCellsScaleCount(),r=window.getComputedStyle(e);e.timeZones.length>0&&i&&"timelineMonth"!==t?e.$.timeline.setAttribute("show-vertical-header",""):e.$.timeline.removeAttribute("show-vertical-header");let a=Math.max(parseFloat(r.getPropertyValue("--smart-scheduler-timeline-cell-height"))||0,parseFloat(r.getPropertyValue("--smart-scheduler-timeline-cell-min-height")||0)),o=Math.max(parseFloat(r.getPropertyValue("--smart-scheduler-timeline-cell-width"))||0,parseFloat(r.getPropertyValue("--smart-scheduler-timeline-cell-min-width")||0));t.indexOf("timeline")>-1?o*=l:a*=l,e._timelineCells={},e.groups.length&&(e._timelineCells.groups=e._getTimelineCellsObjGroups()),e._handleTimelineGroupHeader(n),e._handleTimeZoneHeader(),e._refresh(),e._handleTimelineContentSize(n,a,"height");const s=e.$.timelineContainer.offsetHeight;e._handleTimelineContentSize(n,o,"width"),s!==e.$.timelineContainer.offsetHeight&&e._handleTimelineContentSize(n,a,"height"),e._timelineCells.horizontal=e._getTimelineCellsObjHorizontal(n.horizontal,o),e._timelineCells.vertical=e._getTimelineCellsObjVertical(n.vertical,a),"timelineWeek"===t&&(e._timelineCells.details=e._getTimelineCellsObjDetails())}_getResourceGroups(){const e=this.groups,t=this.resources;let i,n=[],l=[];if(!e.length||!t.length)return l;for(let l=0;l<e.length;l++){const r=t.find(t=>t.value===e[l]);if(!r||!r.dataSource.length)continue;let a={};const o=r.dataSource;for(let e=0;e<o.length;e++){const t=o[e];a[t.id]={id:t.id,label:t.label,color:t.color}}if(Object.keys(a).length){const e=Object.values(a),t=i?i.cells.length:1;let l=[];for(let n=0;n<t;n++)for(let t=0;t<e.length;t++){const a={resource:r.value,label:e[t].label,group:i?Object.assign({},i.cells[n].group):{},groupSeparator:!0};a.group[r.value]=e[t].id,l.push(a)}n.push(i={resource:r.value,groups:e,cells:l})}}return n}_getTimelineCellsObjGroups(){const e=this,t=e._getResourceGroups();let i=[];if(!t.length)return i;for(let e=t.length-1;e>-1;e--){const n=t[e];if(i.length){const e=i.slice(0);i=[],n.groups.forEach(t=>{e.forEach(e=>{const l=Object.assign({},e);l.group=Object.assign({},l.group),l.group[n.resource]=t.id,i.push(l)})})}else n.groups.forEach(e=>{const t={label:e.label,color:e.color,group:{},resource:n.resource,groupSeparator:!0};t.group[n.resource]=e.id,i.push(t)})}if(i.length){const t=e.view,i=e.views.find(e=>e.value&&e.value===t)||{},n=i&&i.groupOrientation?i.groupOrientation:e.groupOrientation;e.$.timeline.setAttribute("show-group-header",n)}else e.$.timeline.removeAttribute("show-group-header");return t[t.length-1].cells=i,t}_getTimelineCellsObjHorizontal(e,t){const i=this,n=i.view,l=i.viewType,r=n.indexOf("timeline")>-1,a=i.views.find(e=>e.value&&e.value===n)||{},o=new Date(i.dateCurrent);r?o.setHours(i.hourStart,0,0,0):o.setHours(0,0,0,0);const s=i.firstDayOfWeek;let d,c;switch(l){case"week":case"timelineWeek":o.setDate(o.getDate()-o.getDay()+s),c=i.hideWeekend||a.hideWeekend,d=i.hideNonworkingWeekdays||a.hideNonworkingWeekdays;break;case"month":case"timelineMonth":o.setDate(1),r||(o.setDate(o.getDate()-o.getDay()+s),o.setHours(0,0,0,0)),c=i.hideWeekend||a.hideWeekend,d=i.hideNonworkingWeekdays||a.hideNonworkingWeekdays}return i._getCellsObject({orientation:"horizontal",cells:[],cellSize:t,cellCount:e,date:o,hideWeekend:c,hideNonworkingWeekdays:d,hourStart:i.hourStart,hourEnd:i.hourEnd,viewSize:i.$.timelineContent.offsetWidth,offset:0})}_getCellsObject(e){const t=this,i=t.view,n=t.viewType,l=t.views.find(e=>e.value&&e.value===i)||{},r=t._timelineCells.groups,a=l&&l.groupOrientation?l.groupOrientation:t.groupOrientation,o=e.cellCount,s=e.viewSize,d=e.orientation,c=e.cells;let u,m=e.cellSize,[h,p]="horizontal"===d?["width","left"]:["height","top"];if(r&&r.length&&(u=r[r.length-1].cells),!u||!u.length||"horizontal"===d&&"vertical"===a||"vertical"===d&&"vertical"!==a)o*m<s&&(m=s/o),e.cellSize=parseFloat(m.toFixed(2)),"agenda"===n&&u&&u.length&&(e.groups=u),t._createCellObjects(e);else{const i=u.length;if(1===o){let e=s/i;e>=m&&(m=e)}else{const e=o*i;e*m<s&&(m=s/e)}if(e.cellSize=parseFloat(m.toFixed(2)),t.groupByDate&&d===a)e.groupHeader=r[r.length-1],t._createCellObjects(e);else{for(let i=0;i<u.length;i++){const n=u[i];n[p]=e.offset,e.size=0,e.group=n.group,t._createCellObjects(e),n[h]=e.size||0,t._refreshGroupHeaderCells(d,n)}c.length||t._createCellObjects(e)}}return c}_refreshGroupHeaderCells(e="horizontal",t){const i=t.group,n=this._timelineCells.groups;if(!n)return;let l=t.date,r=l?"cellsByDate":"cells";const[a,o]="horizontal"===e?["width","left"]:["height","top"];n.forEach(e=>{if(e.resource!==t.resource){const n=e[r];for(let e=0;e<n.length;e++){const r=n[e],s=r.group;l&&l.getTime()!==r.date.getTime()||Object.keys(s).every(e=>s[e]===i[e])&&(r[a]=(void 0===r[a]?0:r[a])+t[a],void 0===r[o]&&(r[o]=t[o]))}}})}_createCellObjects(e){const t=this;"horizontal"===e.orientation?t._createCellsObjectHorizontal(e):t._createCellsObjectVertical(e)}_createCellsObjectHorizontal(e){if(!e)return[];const t=this,i=t.viewType,n=i.indexOf("timeline")>-1,l=e.cells,r=new Date(e.date),a=e.cellSize,o=e.cellCount,s=e.hideWeekend,d=e.hideNonworkingWeekdays,c=t.nonworkingDays,u=t.nonworkingHours,m=e.hourStart,h=e.hourEnd,p=e.group,g=e.groupHeader;let f,v=e.offset,w=0;r.setHours(m);for(let y=0;y<o;y++){if(f={width:a},d){let e=0;const t=r.getHours();for(;e<7&&c.indexOf(r.getDay())>-1;)r.setDate(r.getDate()+1),e++;r.setHours(t)}if(s&&[0,6].indexOf(r.getDay())>-1){const e=r.getHours();r.setDate(r.getDate()+1),r.setHours(e)}if("agenda"===i?f.noLabel=!0:f.weekend=0===r.getDay()||6===r.getDay(),f.nonworking=c.indexOf(r.getDay())>-1,["timelineDay","timelineWeek"].indexOf(i)>-1&&(f.nonworking=f.nonworking||u.indexOf(r.getHours())>-1),g?(e.offset=v,e.date=r,t._createCellsObjByDate(f,e),v=e.offset):(p&&(f.group=p),f.left=v,f.date=new Date(r),l.push(f),v=parseFloat((v+a).toFixed(2))),n&&"timelineMonth"!==i){const e=r.getHours();"timelineWeek"===i&&e===h?(r.setDate(r.getDate()+1),r.setHours(m)):(r.setHours(r.getHours()+1),e===r.getHours()&&r.setHours(r.getHours()+2))}else r.setDate(r.getDate()+1);w+=a}f&&p&&(f.groupSeparator=!0),e.offset=v,e.size=w}_getTimelineCellsObjVertical(e,t){return this._getCellsObject({orientation:"vertical",cells:[],date:new Date(this.dateCurrent),cellSize:t,cellCount:e,viewSize:this.$.timelineContainer.offsetHeight,offset:0})}_isEventPartOfGroup(e,t){return t=t.group||t,Object.keys(t).every(i=>e[i]&&e[i]===t[i])}_createCellsObjByDate(e,t){const i=this,n=t.groupHeader;if(!n)return;const[l,r]="horizontal"===t.orientation?["width","left"]:["height","top"],a=n.cells,o=t.date,s=e[l],d=t.cells,c=t.agendaItem;let u=t.offset;i._createGroupCellsByDate(t,c);const m=n.cellsByDate,h=a.length,p=h%2==0?"center":"offset";for(let n=0;n<h;n++){const g=a[n],f=g.group;if(c&&!i._isEventPartOfGroup(c,f))continue;const v=Object.assign({},e),w=m.find(e=>e.date.getTime()===o.getTime()&&Object.keys(f).every(t=>f[t]===e.group[t]));w&&(w[r]=void 0===w[r]?u:w[r],w[l]=v[l]+(c&&w[l]||0),v[r]=u,v.date=new Date(o),v.group=g.group,c||(n===h-1&&(v.groupSeparator=!0),n===Math.round(h/2)&&(v.showLabel=p)),i._refreshGroupHeaderCells(t.orientation,w),d.push(v),u=parseFloat((u+s).toFixed(2)))}t.offset=u}_createGroupCellsByDate(e,t){const i=this,n=e.date,l=i._timelineCells.groups;if(n)for(let r=0;r<l.length;r++){const a=l[r];let o=a.cellsByDate;o||(o=a.cellsByDate=[]);const s=a.cells;for(let l=0;l<s.length;l++){let r;if(t){if(!i._isEventPartOfGroup(t,s[l]))continue;r=o.find(e=>e.date.getTime()===n.getTime()&&e.group[e.resource]===t[e.resource])}r=r||Object.assign({},s[l]),r.date||(r.date=new Date(n)),r.separator=!!e.separator,r.groupSeparator=t?!r.separator:l===s.length-1,o.includes(r)||o.push(r)}}}_createCellsObjectVertical(e){const t=this;if(!e)return;const i=t.firstDayOfWeek,n=t.viewType,l=n.indexOf("timeline")>-1,r=e.cells,a=new Date(e.date),o=e.cellCount,s=e.viewSize,d=t.nonworkingHours,c=e.group,u=e.groups,m=e.groupHeader;let h,p=e.offset,g=0,f=e.cellSize;if("agenda"===n){const i=Object.keys(o).sort((e,t)=>parseInt(e)-parseInt(t));for(let l of i){let i=o[l],a=f;if(c)i=i.filter(e=>t._isEventPartOfGroup(e,c));else if(u)i=i.filter(e=>u.some(i=>t._isEventPartOfGroup(e,i)));else if(m){const e=m.cells;let n=i.slice(0);i=[];for(let l=0;l<e.length;l++)i.push(...n.filter(i=>t._isEventPartOfGroup(i,e[l])))}const d=i.length,v=new Date(parseInt(l));d*a<s&&(a=s/d),a=parseFloat(f.toFixed(2));for(let l=0;l<d;l++){const o=v,s=new Date(i[l].dateStart);s.getTime()>o.getTime()&&o.setHours(s.getHours(),s.getMinutes()),h={height:a,separator:l===d-1,weekend:"agenda"===n&&(0===o.getDay()||6===o.getDay()),nonworking:t.nonworkingDays.indexOf(o.getDay())>-1},l>0&&(h.noLabel=!0),m?(e.offset=p,e.date=o,e.agendaItem=i[l],e.separator=h.separator,t._createCellsObjByDate(h,e),p=e.offset):(c&&(h.group=c),h.top=p,h.date=o,r.push(h),p=parseFloat((p+a).toFixed(2))),g+=a}}t.$.timeline.classList[r.length?"remove":"add"]("no-agenda")}else if(l)for(let i=0;i<o;i++)a.setHours(0,0,0,0),h={height:f,weekend:0===a.getDay()||6===a.getDay()},m?(e.offset=p,e.date=a,t._createCellsObjByDate(h,e),p=e.offset):(c&&(h.group=c),h.top=p,h.date=new Date(a),r.push(h),p=parseFloat((p+f).toFixed(2))),g+=f;else{"month"===n?(a.setDate(1),a.setDate(a.getDate()-a.getDay()+i),a.setHours(0,0,0,0)):a.setHours(t.hourStart,0,0,0);for(let i=0;i<o;i++)h={height:f},m?(e.offset=p,e.date=a,t._createCellsObjByDate(h,e),p=e.offset):(c&&(h.group=c),h.top=p,h.date=new Date(a),r.push(h),p=parseFloat((p+f).toFixed(2))),g+=f,"month"===n?a.setDate(a.getDate()+7):(h.nonworking=d.indexOf(a.getHours())>-1,a.setHours(a.getHours()+1))}h&&c&&(h.groupSeparator=!0),e.offset=p,e.size=g}_getTimelineCellsObjDetails(){if("timelineWeek"===!this.viewType)return[];function e(e){let t="";if(!i&&e)for(const i in e)t+=i+e[i];return t}const t=this.hourStart,i=this.groupByDate,n=this._timelineCells.horizontal;let l,r={};for(let i=0;i<n.length;i++){const a=n[i],o=a.date,s=o.getDate()+e(a.group);if(l=r[s],l||(l=r[s]={width:0,left:a.left}),l.width+=a.width,a.groupSeparator&&(l.groupSeparator=a.groupSeparator),!l.date){const e=new Date(o);e.setHours(t,0,0,0),l.date=e}}return r=Object.values(r).sort((e,t)=>e.left-t.left),r}_handleTimelineContentSize(e,t,i){const n=this,l=n.view,r=n.viewType,a=n._timelineCells.groups,o=n.views.find(e=>e.value&&e.value===l)||{},s=o&&o.groupOrientation?o.groupOrientation:n.groupOrientation,d="agenda"===r&&Object.keys(e.vertical).length?n.$.timelineHeaderVertical.offsetWidth:Math.max(n.$.timelineViewCellsLabelContainer.offsetWidth,n.$.timelineViewAllDaylabel.offsetWidth),c="width"===i?Math.max(0,n.$.timeline.offsetWidth-d):n.$.timelineContainer.offsetHeight;let u=0,m=[],h=e["width"===i?"horizontal":"vertical"];if(a&&a.length&&(m=a[a.length-1].cells),"agenda"===r&&"height"===i)for(let e in h){let i=h[e];m.length&&(i=i.filter(e=>m.some(t=>n._isEventPartOfGroup(e,t)))),u+=i.length*t}else{let e=1;n.groups.length&&("vertical"!==s&&"width"===i||"vertical"===s&&"height"===i)&&(e=Math.max(m.length,1)),1===h?c<t?u=t*e:(u=c/e,u<t&&(u=t*e)):(h*=e,h*t<c&&(t=c/h),u=h*(t=parseFloat(t.toFixed(2))))}u=Math.max(u,c,t),n.$.timelineContent.style[i]=u===c?"":u+"px",n._refresh()}_createCells(e,t="smart-scheduler-cell"){let i,n=document.createDocumentFragment();Array.isArray(t)||(t=[t]);for(let l=0;l<e;l++)i=document.createElement("div"),t.forEach(e=>i.classList.add(e)),i.setAttribute("role","columnheader"),n.appendChild(i);return n}_refreshTimelineContentCells(){const e=this._timelineCells;if(!e||!e.vertical||!e.horizontal)return;const t=this.$.timelineContainer,i=this.$.timelineCellsContainer,n=this.$.timelineContent,l=(this.viewType.indexOf("timeline")>-1?this.$.timelineHeaderHorizontalContent:this.$.timelineHeaderVerticalContent).querySelector(".smart-scheduler-cells");i.remove(),this._refreshContainerCells(i,l.children),n.appendChild(i),t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft}_refreshContainerCells(e,t){const i=this,n=i.view,l=i.viewType,r=i.views.find(e=>e.value&&e.value===n)||{},a=r&&r.groupOrientation?r.groupOrientation:i.groupOrientation,o=l.indexOf("timeline")>-1,s=e.children,d=e===i.$.timelineCellsContainer,c=i.$.timelineHeaderHorizontalContent.querySelector(".smart-scheduler-cells"),u=i.$.timelineHeaderVerticalContent.querySelector(".smart-scheduler-cells");i._recycleContainerCells({fragment:e,cellsNeeded:t.length,className:d?"smart-scheduler-cell-container":void 0});const m=i._getCellsScaleCount(),h=i.locale,p=i.timeZone;let g,f,v=i.dateCurrent;if(d)g=u.children;else if(g=(o?c:u).children,i._selectedCellObj){const e=i._selectedCellObj.from;if(!e.allDay){const t=i._selectedCellObj.to;f={lastTime:e.time,fromTime:Math.min(e.time,t.time),toTime:Math.max(e.time,t.time),group:e[a]?e[a].group:void 0}}}for(let n=0;n<s.length;n++){const r=s[n],c=t[n],u=c.$.cellObj;let w;if(u.nonworking?r.setAttribute("nonworking",""):r.removeAttribute("nonworking"),u.weekend?r.setAttribute("weekend",""):r.removeAttribute("weekend"),u.separator?r.setAttribute("separator",""):r.removeAttribute("separator"),w=u.groupSeparator,d)o||"vertical"!==a||(w=!!g[n]&&g[n].$.cellObj.groupSeparator),w&&(o&&"vertical"!==a||!o&&"vertical"===a)?r.setAttribute("group-separator",""):r.removeAttribute("group-separator"),r.$=c.$,i._refreshScaleCells(r,m);else{r.$||(r.$={cellObj:{}});const t=r.$.cellObj;t.scaleIndex=e._scaleIndex,o?(t.horizontal=e.$.cellObj,t.vertical=c.$.cellObj):(t.horizontal=c.$.cellObj,t.vertical=e.$.cellObj);const n=t[a]?t[a].group:void 0;if(n)for(const e in n)r.setAttribute(e,n[e]||"");w&&(!o&&"vertical"!==a||o&&"vertical"===a)?r.setAttribute("group-separator",""):r.removeAttribute("group-separator");const s=new Date(t.time=i._getCellTime(t));"month"===l?(i._setCellContent(r,s),s.getMonth()!==v.getMonth()?r.setAttribute("other-month",""):r.removeAttribute("other-month"),r.setAttribute("date",s.toLocaleString(h,{timeZone:p}))):(i._setCellContent(r,s),r.removeAttribute("other-month"),r.setAttribute("date",s.toLocaleString(h,{timeZone:p}))),r.removeAttribute("selected"),f&&n===f.group&&t.time>=f.fromTime&&t.time<=f.toTime&&r.setAttribute("selected",t.time===f.lastTime?"start":"")}r.style.top=c.style.top,r.style.left=c.style.left,r.style.width=c.style.width,r.style.height=c.style.height}}_refreshScaleCells(e,t){const i=this,n=i.viewType.indexOf("timeline")>-1,l=e.children,r=i.$.timelineHeaderHorizontalContent.querySelector(".smart-scheduler-cells"),a=i.$.timelineHeaderVerticalContent.querySelector(".smart-scheduler-cells");i._recycleContainerCells({fragment:e,cellsNeeded:t,className:["smart-scheduler-cell","scale"]});const o=n?"width":"height",s=l.length,d=e.$.cellObj;for(let c=0;c<s;c++){const s=l[c];s.$=e.$,s._scaleIndex=c,d.nonworking?s.setAttribute("nonworking",""):s.removeAttribute("nonworking"),s.style.width=s.style.height=null,s.style[o]=100/t+"%",i._refreshContainerCells(s,(n?a:r).children),delete s._scaleIndex}}_refreshTimelineAllDayCells(){const e=this,t=e.viewType.toLowerCase(),i=e.$.timelineViewAllDayContent,n=e.$.timelineViewAllDayCellsContainer;if(t.indexOf("timeline")>-1||t.indexOf("month")>-1)return void(n.innerHTML="");n.remove();const l=n.children,r=e.locale,a=e.timeZone,o=e.$.timelineHeaderHorizontalContent.querySelector(".smart-scheduler-cells").children;e._recycleContainerCells({fragment:n,cellsNeeded:"agenda"===t?0:o.length});for(let t=0;t<l.length;t++){const i=l[t],n=o[t],s=n.$.cellObj;i.$||(i.$={cellObj:{}});const d=i.$.cellObj;d.horizontal=s,d.allDay=!0,i.setAttribute("all-day","");const c=d.horizontal.group;if(c)for(const e in c)i.setAttribute(e,c[e]||"");const u=new Date(d.time=e._getCellTime(d));e._setCellContent(i,u),i.setAttribute("date",u.toLocaleString(r,{timeZone:a})),s.groupSeparator?i.setAttribute("group-separator",""):i.removeAttribute("group-separator"),s.weekend?i.setAttribute("weekend",""):i.removeAttribute("weekend"),s.nonworking?i.setAttribute("nonworking",""):i.removeAttribute("nonworking"),i.style.left=n.style.left,i.style.width=n.style.width}i.appendChild(n),i.scrollLeft=e.scrollLeft}_getCellsScaleCount(){const e=this.viewType.toLowerCase();if(["month","agenda"].indexOf(e)>-1)return 1;switch(this.timelineDayScale){case"hour":return 1;case"halfHour":return 2;case"quarterHour":return 4;case"tenMinutes":return 6;case"fiveMinutes":return 12;default:return 1}}_getTimelineVisibleCellsCount(e="horizontal"){const t=this,i=e.orientation||e,n=e.type,l=e.resource;let r=t._timelineCells[i];if(n)if(l){r=t._timelineCells.groups.find(e=>e.resource===l)[t.groupByDate?"cellsByDate":"cells"]}else r=t._timelineCells[n];if(!r)return 0;const a=t._getFirstCellObjInView({orientation:i,type:n,resource:l});if(!a)return 0;const[o,s,d]="horizontal"===i?["left","width",t.scrollLeft]:["top","height",t.scrollTop];let c;if("vertical"===i?c=t.$.timelineContainer.offsetHeight:(c=t.$.timelineHeaderHorizontalContent.offsetWidth||t.$.timelineViewAllDayContent.offsetWidth,"agenda"===t.viewType&&t._timelineCells.vertical.length&&(c-=t.$.timelineHeaderVertical.offsetWidth)),n){let e=0;if("details"===n&&("timelineWeek"!==t.viewType||"vertical"===i))return e;for(let t=r.indexOf(a);t<r.length;t++){const i=r[t];i[o]+i[s]>=d&&i[o]<c+d&&e++}return e}const u=1-(a[o]+a[s]-d)/r[0][s];return Math.min(r.length,Math.ceil(parseFloat((c/a[s]+u).toFixed(2))))}_getFirstCellObjInView(e="horizontal"){const t=this,i=e.orientation||e,n=e.type,l=e.resource,r=t._timelineCells;if(!r)return;let a,o,s;const[d,c,u]="horizontal"===i?["scrollLeft","left","width"]:["scrollTop","top","height"],m=Math.abs(t[d]);if(s=r[i],n)if(l){s=t._timelineCells.groups.find(e=>e.resource===l)[t.groupByDate?"cellsByDate":"cells"]}else s=t._timelineCells[n];for(let e=0;e<s.length;e++){const t=s[e];if(t[c]+t[u]>=m){a=t;break}o=t}return!a&&o&&(a=m>o[c]?o:s[0]),a}_getCellsCount(e){const t=this,i=t.dateCurrent,n=new Date(t.dateCurrent);e||(e=t.view);const l=t.viewType,r=t.views.find(t=>t.value&&t.value===e)||{},a=t.nonworkingDays;let[o,s,d,c]=[0,0,0,0,0];const u=t.hideNonworkingWeekdays||r.hideNonworkingWeekdays,m=t.hideWeekend||r.hideWeekend;switch(m&&(c=2,u&&(c-=(a.includes(0)?1:0)+(a.includes(6)?1:0))),l){case"agenda":s=t._getAgendaEvents(n,r),o=1;break;case"day":s=t._getDayHours(n),o=1;break;case"month":case"week":s="month"===l?6:t.hourEnd-t.hourStart+1,o=7-(u?a.length:0)-c;break;case"timelineDay":o=t._getDayHours(n),s=1;break;case"timelineWeek":{const e=t.firstDayOfWeek;let i=new Date(n);s=1,i.setDate(i.getDate()-i.getDay()+e);for(let e=0;e<7;e++)(!m||m&&[0,6].indexOf(i.getDay())<0)&&(!u||u&&a.indexOf(i.getDay())<0)&&(o+=t._getDayHours(i),d++),i.setDate(i.getDate()+1);break}case"timelineMonth":{const e=new Date(i);e.setDate(1),e.setMonth(e.getMonth()+1),e.setDate(0),o=e.getDate(),s=1;break}}return{horizontal:o,vertical:s,detail:d}}_getAgendaEvents(e,t){const i=this,n=i._events;if(!n||!n.length)return{};if(!t){const e=i.view;t=i.views.find(t=>t.value&&t.value===e)||{}}e||(e=new Date(i.currentDate));const l=i.hideNonworkingWeekdays||t.hideNonworkingWeekdays,r=i.hideWeekend||t.hideWeekend,a=i.nonworkingDays,o=new Date(e),s=i.hourStart,d=i.hourEnd;o.setHours(0,0,0,0);const c=new Date(o);c.setDate(o.getDate()+6),c.setHours(23,59,59,999);const[u,m]=[o.getTime(),c.getTime()];let h={};for(let e=0;e<n.length;e++){const t=n[e],i=t.dateStart,c=t.dateEnd,p=i.getTime(),g=c.getTime();if(!(p>m||g<u))for(let e=0;e<7;e++){const i=new Date(o);if(i.setDate(i.getDate()+e),l&&a.indexOf(i.getDay())>-1||r&&[0,6].indexOf(i.getDay())>-1)continue;i.setHours(s,0,0,0);const n=new Date(i);n.setHours(d,59,59,999);const c=i.getTime(),u=n.getTime();if(c<=g&&u>=p){let e=h[c];e||(h[c]=e=[]),e.push(t)}}}for(let e in h)h[e].sort((e,t)=>e.dateStart.getTime()-t.dateStart.getTime());return h}_getDayHours(e){const t=new Date(e||this.dateCurrent),i=t.getDate(),n=this.hourStart,l=this.hourEnd;let r=0;for(t.setHours(n,0,0,0);i===t.getDate()&&t.getHours()<=l;){r++;const e=t.getHours();t.setHours(t.getHours()+1,0,0,0),e===t.getHours()&&t.setHours(t.getHours()+2,0,0,0)}return r}_getDateString(e,t="horizontal",i){const n=this,l=n.viewType,r=l.indexOf("timeline")>-1,a=e.timeZone||n.timeZone;let o;if(e=e.date||e,r){if("vertical"===t)return"";o="timelineMonth"===l||"timelineWeek"===l&&i?e.toLocaleDateString(n.locale,{day:n.dayFormat,weekday:n.weekdayFormat,timeZone:a}):e.toLocaleTimeString(n.locale,{hour:n.hourFormat,minute:n.minuteFormat,timeZone:a})}else if("horizontal"===t){if("day"===l)return"";"week"===l?o=e.toLocaleDateString(n.locale,{day:n.dayFormat,weekday:n.weekdayFormat,timeZone:a}):"month"===l&&(o=e.toLocaleDateString(n.locale,{weekday:n.weekdayFormat,timeZone:a}))}else{if("month"===l)return"";o="agenda"===l?e.toLocaleDateString(n.locale,{day:n.dayFormat,weekday:n.weekdayFormat,timeZone:a}):e.toLocaleTimeString(n.locale,{hour:n.hourFormat,minute:n.minuteFormat,timeZone:a})}return n.timelineHeaderFormatFunction?n.timelineHeaderFormatFunction(e,t,i,o):o}_setGroupContent(e){const t=this,i=e.$.cellObj;if(t.groupTemplate)t._applyTemplate("groupTemplate",e,i);else{const n=t.resources.find(e=>e.value===i.resource);if(!n)return void(e.innerHTML="");let l;i.group&&(l=i.label);let r=l||n.label;t.timelineHeaderGroupFormatFunction&&(r=t.timelineHeaderGroupFormatFunction(l,n,r)),e.innerHTML=`<div>${r}</div>`}}_applyTemplate(e,t,i){const n=this;let l,r=n[e];if("groupTemplate"===e){if(l=n.resources.find(e=>e.value===i.resource),l){const e=i.group[i.resource];i=l.dataSource.find(t=>t.id===e)}i||(i=l)}n._templates||(n._templates={});const a=n._templates;if(t.innerHTML="","function"==typeof r)return r.call(n,t,i),void delete a[e];if("string"==typeof r&&(r=document.getElementById(r)),!("content"in document.createElement("template")))return n.error(n.localize("htmlTemplateNotSuported",{elementType:n.nodeName.toLowerCase()})),void delete a[e];if(null===r||!("content"in r))return n.error(n.localize("invalidTemplate",{elementType:n.nodeName.toLowerCase(),property:"groupTemplate"})),void delete a[e];a[e]||(a[e]={});const o=a[e];let s=o.clone;s||(s=o.clone=document.importNode(r.content,!0)),"cellTemplate"===e&&(i=i.toLocaleDateString(n.locale,{day:n.dayFormat}));const d=s.childNodes;for(let e=0;e<d.length;e++){let n=d[e].outerHTML;if(n){let e=o.bindings;if(!e){const t=/{{\s*\w*\s*}}/gm;t.test(n)&&(e=o.bindings=n.match(t))}for(let t=0;t<e.length;t++){const l=e[t];n=n.replace(l,"object"==typeof i?i[l.replace(/{{|}}/gm,"").trim()]||"":i)}t.innerHTML+=n}}}_setCellContent(e,t){const i=this;t=new Date(t||i.dateCurrent),i.cellTemplate?i._applyTemplate("cellTemplate",e,t):"month"===i.viewType?e.innerHTML=`<div>${t.toLocaleDateString(i.locale,{day:i.dayFormat})}</div>`:e.innerHTML=""}_refreshTimelineHeaderCells(e,t){const i=this;e||(e="horizontal",i._refreshTimelineHeaderCells("vertical",t)),"horizontal"===e&&i.$.timelineViewAllDay.offsetHeight&&(i.$.timelineViewAllDaylabel.innerHTML=`<div>${i.localize("allDay")}</div>`);const[n,l,r,a]="horizontal"===e?["scrollLeft","left","width",i.$.timelineHeaderHorizontalContent]:["scrollTop","top","height",i.$.timelineHeaderVerticalContent],o=i.$.timelineTimeZoneLabelContainer,s=i.timeZones,d=a.querySelector(".smart-scheduler-view-time"),c=i.viewType,u=c.indexOf("timeline")>-1,m=d.children,h=i[n],p=i._timelineCells[e];let g,f;for(let e=0;e<p.length;e++){const t=p[e];if(h<=t[l]+t[r]){g=e;break}}(o.parentElement&&!u&&"agenda"!==c&&"vertical"===e||u&&"horizontal"===e)&&(f=o.children);for(let n=0;n<m.length;n++){const a=m[n],o=a.children;let d=g;if(f){const e=s.find(e=>e.id===a.timeZone);e&&(f[n].innerHTML=e?`<div>${e.label}</div>`:"")}for(let n=0;n<o.length;n++){const s=o[n],c=p[d];if(!c)break;d++,s.$={cellObj:c},s.innerHTML=`<div>${c.noLabel?"":i._getDateString({date:new Date(c.date),timeZone:a.timeZone},e)}</div>`,t||(s.style[r]=c[r]+"px","horizontal"===e?s.style[i.rightToLeft?"right":"left"]=c[l]+"px":s.style[l]=c[l]+"px",c.weekend?s.setAttribute("weekend",""):s.removeAttribute("weekend"),c.nonworking?s.setAttribute("nonworking",""):s.removeAttribute("nonworking"),c.separator?s.setAttribute("separator",""):s.removeAttribute("separator"),c.groupSeparator?s.setAttribute("group-separator",""):s.removeAttribute("group-separator"),c.showLabel?s.setAttribute("show-label",c.showLabel):s.removeAttribute("show-label"))}}i._refreshHeaderDetailCells(e,t),i._refreshHeaderGroupCells(e,t),a[n]=i[n]}_refreshHeaderGroupCells(e,t){const i=this,n=i._timelineCells.groups,l=i.$.groupsContainer,r=i.groupByDate;let a,o,s,d,c;if(!l)return;if(c=l.querySelector(".smart-scheduler-view-header-groups-container"),d="horizontal"===e?i.$.timelineHeaderHorizontal:i.$.timelineHeaderVertical,!n||!c||!d.contains(c))return;[a,o,s]="vertical"===e?["top","height","scrollTop"]:["left","width","scrollLeft"];let u=c.children,m=document.createDocumentFragment();for(;u.length;)m.appendChild(c.firstElementChild);u=m.children;for(let l=0;l<u.length;l++){const s=u[l],d=n[l];i._refreshAdditionalHeaderCells({orientation:e,fragment:s,type:"groups",offset:a,size:o,cellsObj:d[r?"cellsByDate":"cells"],resource:d.resource,refreshContentOnly:t})}c.appendChild(m),i.$.groupsContainer.querySelector(".smart-scheduler-view-groups-content")[s]=i[s]}_refreshHeaderDetailCells(e,t){const i=this._timelineCells.details;let n,l,r,a;if(!i||"horizontal"!==e||"timelineWeek"!==this.viewType)return;if(r=this.$.timelineHeaderHorizontalContent,a=r.querySelector(".smart-scheduler-view-details"),!a)return;[n,l]=["left","width"];let o=a.children,s=document.createDocumentFragment();for(;o.length;)s.appendChild(a.firstElementChild);this._refreshAdditionalHeaderCells({orientation:e,fragment:s,type:"details",offset:n,size:l,cellsObj:i,refreshContentOnly:t}),a.appendChild(s)}_refreshAdditionalHeaderCells(e){const t=this,i=e.orientation,n=e.fragment,[l,r,a,o,s]=[e.type,e.offset,e.size,e.cellsObj,e.resource],d=e.refreshContentOnly,c=t._getFirstCellObjInView({orientation:i,type:l,resource:s});if(!c)return;t._recycleContainerCells({fragment:n,cellsNeeded:t._getTimelineVisibleCellsCount({orientation:i,type:l,resource:s})});const u=n.children,m=o.indexOf(c),h="top"===r?r:t.rightToLeft?"right":"left";for(let e=0;e<u.length;e++){const n=u[e],s=o[m+e];if(n.$={cellObj:s},"groups"===l)t._setGroupContent(n);else{const e=s.date;n.innerHTML=`<div>${s.noLabel?"":t._getDateString({date:new Date(e)},i,!0)}</div>`}if(!d){if(s.groupSeparator?n.setAttribute("group-separator",""):n.removeAttribute("group-separator"),s.separator?n.setAttribute("separator",""):n.removeAttribute("separator"),s.group){const e=s.group;for(const t in e)n.setAttribute(t,e[t]||"")}n.style.top=n.style.left=n.style.width=n.style.height=null,n.style[a]=s[a]+"px",n.style[h]=s[r]+"px"}}}_createWindow(){const e=this,t="schedulerWindow";if(e.$[t])return e.$[t];const i=document.createElement("smart-window");return i.classList.add("smart-scheduler-window"),i.setAttribute("smart-id",t),e.$[t]=i,e["$"+t]=Smart.Utilities.Extend(i),i.rightToLeft=e.rightToLeft,i.theme=e.theme,i.animation=e.animation,i.disableSnap=!0,i.headerButtons=["close"],i}_openWindow(e){const t=this;if(!e&&!(e=t._createEventFromSelection()))return;function i(){function e(){t._positionWindow(),n.opened?(n.bringToFront(),n._handleActiveState()):n.open()}if(t._setPopupWindowTemplate("header"),t._setPopupWindowTemplate("footer"),t._setPopupWindowTemplate("content"),!n.opened){const e=t.$schedulerWindow;e.unlisten("transitionend"),e.unlisten("open"),e.unlisten("close"),e.unlisten("closing"),e.unlisten("click"),e.unlisten("change"),n._onOpenCallback=()=>{const e=(n.shadowRoot||n).querySelector(".smart-input");e&&e.focus()},n.hasAnimation&&e.listen("transitionend",t._windowTransitionendHandler.bind(t)),e.listen("open",t._windowOpenHandler.bind(t)),e.listen("close",t._windowCloseHandler.bind(t)),e.listen("closing",t._windowClosingHandler.bind(t)),e.listen("click",t._windowClickHandler.bind(t)),e.listen("change",t._windowChangeHandler.bind(t))}n.shadowRoot?(n.importStyle(Smart.Utilities.Core.getScriptLocation()+Smart.StyleBaseUrl.replace("/scoped/","/smart.textbox.css")),t._onShadowDomLoaded(n,"smart.window.css",e)):e(),t.setAttribute("aria-owns",((t.getAttribute("aria-owns")||"")+" "+n.id).trim())}if(!e)return;const n=t._createWindow();t.$.fireEvent("opening",{target:n}).defaultPrevented||(n._target=e,n.parentElement||t.getShadowRootOrBody().appendChild(n),n.isCompleted?i():n.whenReady(()=>i()))}_positionWindow(){const e=this.$.schedulerWindow;if(!e)return;const t=this.getBoundingClientRect();if(e.querySelector(".smart-scheduler-window-repeat")){const i=e.offsetWidth;!e.hasAttribute("horizontal")&&2*i<=t.width?e.setAttribute("horizontal",""):e.hasAttribute("horizontal")&&i>t.width&&e.removeAttribute("horizontal")}else e.removeAttribute("horizontal");e.style.left=Math.max(t.left+window.pageXOffset,t.left+window.pageXOffset+t.width/2-e.offsetWidth/2)+"px",e.style.top=Math.max(t.top+window.pageYOffset,t.top+window.pageYOffset+t.height/2-e.offsetHeight/2)+"px"}_windowTransitionendHandler(e){const t=this,i=e.target;i===t.$.schedulerWindow&&(i.opened||"visibility"!==e.propertyName||(t.$schedulerWindow.unlisten("transitionend"),i.remove()))}_windowOpenHandler(e){const t=this,i=t.$schedulerWindow;i&&e.target===t.$.schedulerWindow&&(t._handleModal(!0),t.$.fireEvent(e.type,e.detail),i.unlisten("open"))}_windowClosingHandler(e){const t=this.$schedulerWindow;e.target===this.$.schedulerWindow&&t&&(this.$.fireEvent(e.type,{target:e.target}).defaultPrevented?e.preventDefault():t.unlisten(e.type))}_windowCloseHandler(e){const t=this,i=t.$schedulerWindow;e.target===t.$.schedulerWindow&&i&&(t._handleModal(),t.$.fireEvent(e.type,e.detail),i.unlisten("close"),i.unlisten("click"),t.hasAttribute("aria-owns")&&t.removeAttribute("aria-owns"),t.$.timeline.focus())}_windowChangeHandler(e){const t=this,i=e.target,n=t.$.schedulerWindow;if(e.stopPropagation(),n)if(i instanceof Smart.RadioButton){const e=i.closest(".smart-scheduler-window-editor[multiple]");if(e){const t=e.children;for(let e=0;e<t.length;e++){const n=t[e],l=n.querySelector("[event-editor]");l&&(l.disabled=!n.contains(i))}}}else{if(i instanceof Smart.SwitchButton){if(i.closest('.smart-scheduler-window-editor[type="allDay"]')){const e=n.querySelectorAll('.smart-scheduler-window-editor[type^="date"] .smart-date-time-picker'),t=i.checked;for(let i=0;i<e.length;i++)e[i].formatString=t?"yyyy-MMM-dd":"yyyy-MMM-dd HH:mm";return}if(i.closest('.smart-scheduler-window-editor[type="repeat"]')&&n._target)return n._target.repeat=i.checked,t._createWindowEditor("repeat"),void t._positionWindow()}i instanceof Smart.Input&&i.hasAttribute("event-editor")&&i.closest('.smart-scheduler-window-editor[type="repeatInterval"]')&&t._setPopupWindowEditor(n.querySelector('.smart-scheduler-window-editor[type="repeatOn"]'))}}_windowClickHandler(e){let t=(e.originalEvent||e).target;t.shadowRoot&&(t=(e.originalEvent||e).composedPath()[0]);const i=t.closest("smart-window")||(t.getRootNode()&&t.getRootNode().host?t.getRootNode().host:void 0);return t.closest(".smart-scheduler-window-button.cancel")||t.closest(".smart-scheduler-window-button.ok")?(i.close(),void delete i._target):void t.closest(".smart-scheduler-window-button.delete")}_handleModal(e){const t=this;let i=(t.shadowRoot||t).querySelector(".smart-scheduler-window-modal");e?(i||(i=document.createElement("div"),i.classList.add("smart-scheduler-window-modal")),i.parentElement||(t.$.container.appendChild(i),t.setAttribute("modal",""))):i&&i.parentElement&&(i.parentElement.removeChild(i),t.removeAttribute("modal"))}_onShadowDomLoaded(e,t,i){requestAnimationFrame((function n(){const l=(e.shadowRoot||e.getRootNode()).querySelectorAll("link");for(let e=0;e<l.length;e++)if(-1!==l[e].href.indexOf(t))return void i();requestAnimationFrame(n)}))}_setPopupWindowTemplate(e){const t=this,i=t.$.schedulerWindow;if(!i)return;if("content"===e)return void t._setPopupWindowContent();i[e+"Template"]||(i[e+"Template"]=t._createWindowTemplate(e));const n=i._target,l=t._events.indexOf(n)<0;if("header"===e){const e=(i.shadowRoot||i).querySelector(".smart-scheduler-window-label");n&&e&&(e.innerHTML=l?t.localize("newEvent"):n.label)}else if("footer"===e){const e=(i.shadowRoot||i).querySelectorAll(".smart-scheduler-window-button");for(let i=0;i<e.length;i++){const n=e[i];n.innerHTML='<span class="smart-icon"></span>',n.theme=t.theme,n.rightToLeft=t.rightToLeft,n.animation=t.animation,n.classList.contains("ok")?(n.innerHTML+=t.localize("ok"),n.setAttribute("aria-label","ok")):n.classList.contains("cancel")?(n.innerHTML+=t.localize("cancel"),n.setAttribute("aria-label","cancel")):n.classList.contains("delete")&&(n.innerHTML+=t.localize("delete"),n.setAttribute("aria-label","delete"),n.classList[l?"add":"remove"]("smart-hidden"));const r=n.querySelector(".smart-ripple");r&&r.parentElement.removeChild(r)}}}_setPopupWindowContent(){const e=this,t=e.$.schedulerWindow,i=t._target,n=[].slice.call(t.getElementsByClassName("smart-scheduler-window-editor"));!t.content||t.content.innerHTML&&!n.length||i&&(e._createWindowEditor(),e._createWindowEditor("repeat"))}_createWindowEditor(e="main"){const t=this,i=t.$.schedulerWindow,n=i._target;let l=i.querySelector(`.smart-scheduler-window-${e}`);if("repeat"===e&&!n.repeat)return void(l&&l.remove());if(!l){const i=t._windowEditors;if(i){const t="main"===e?i.label:i.repeatInterval;t&&(l=t.closest(`.smart-scheduler-window-${e}`))}l||(l=document.createElement("div"),l.classList.add(`smart-scheduler-window-${e}`),l.innerHTML=t._getWindowEditorTemplate(e))}l.parentElement||i.appendChild(l);const r=l.querySelectorAll(".smart-scheduler-window-editor[type]");for(let e=0;e<r.length;e++)t._setPopupWindowEditor(r[e])}_getWindowEditorTemplate(e){return e&&"main"!==e?"repeat"===e?'\n                <div class="smart-scheduler-window-editor" type="repeatInterval">\n                    <label></label>\n                    <smart-input readonly event-editor drop-down-button-position="right"></smart-input>\n                </div>\n                <div class="smart-scheduler-window-editor" type="repeatStep">\n                    <label></label>\n                    <smart-number-input min="1" event-editor></smart-number-input>\n                </div>\n                <div class="smart-scheduler-window-editor" type="repeatOn" multiple>\n                    <label></label>\n                </div>\n                <div class="smart-scheduler-window-editor" multiple>\n                    <div class="smart-scheduler-window-editor" type="repeatEnd">\n                        <label></label>\n                        <smart-radio-button group-name="repeat"></smart-radio-button>\n                    </div>\n                    <div class="smart-scheduler-window-editor" type="repeatEndOn">\n                        <smart-radio-button group-name="repeat"></smart-radio-button>\n                        <smart-date-time-picker calendar-button drop-down-append-to="body" event-editor\n                        enable-mouse-wheel-action drop-down-display-mode="auto"></smart-date-time-picker>\n                    </div>\n                    <div class="smart-scheduler-window-editor" type="repeatEndAfter">\n                        <smart-radio-button group-name="repeat"></smart-radio-button>\n                        <smart-number-input min="1" event-editor></smart-number-input>\n                        <label></label>\n                    </div>\n                </div>':void 0:'\n            <div class="smart-scheduler-window-editor" type="label">\n                <label></label>\n                <smart-input event-editor></smart-input>\n            </div>\n            <div class="smart-scheduler-window-editor" multiple>\n                <div class="smart-scheduler-window-editor" type="dateStart">\n                    <label></label>\n                    <smart-date-time-picker calendar-button drop-down-append-to="body" event-editor\n                    enable-mouse-wheel-action drop-down-display-mode="auto"></smart-date-time-picker>\n                </div>\n                <div class="smart-scheduler-window-editor" type="dateEnd">\n                    <label></label>\n                    <smart-date-time-picker calendar-button drop-down-append-to="body" event-editor\n                        enable-mouse-wheel-action drop-down-display-mode="auto"></smart-date-time-picker>\n                </div>\n            </div>\n            <div class="smart-scheduler-window-editor" type="description">\n                <label></label>\n                <smart-text-area event-editor></smart-text-areahaker>\n            </div>\n            <div class="smart-scheduler-window-editor" multiple>\n                <div class="smart-scheduler-window-editor" type="allDay">\n                    <label></label>\n                    <smart-switch-button event-editor></smart-switch-button>\n                </div>\n                <div class="smart-scheduler-window-editor" type="repeat">\n                    <label></label>\n                    <smart-switch-button event-editor></smart-switch-button>\n                </div>\n            </div>'}_setPopupWindowEditor(e){const t=this,i=e.getAttribute("type"),n=e.querySelector("label"),l=t.$.schedulerWindow._target;let r=e.querySelector("[event-editor]");if(!l)return;t._windowEditors||(t._windowEditors={});const a=t._windowEditors;if(a[i]||(a[i]=e),n&&(n.innerHTML=t.localize(i)),"label"===i||"description"===i)r.value=l[i]||"";else if(i.indexOf("date")>-1)r.formatString=l.allDay?"yyyy-MMM-dd":"yyyy-MMM-dd HH:mm",r.value=l[i];else if("allDay"===i||"repeat"===i)r.checked=!!l[i];else if("repeatInterval"===i)r.dataSource=["Hourly","Daily","Weekly","Monthly","Yearly"],r.value="Daily";else if("repeatStep"===i)r.value=1;else if("repeatOn"===i)t._setRepeatOnEditor(e,r);else if(i.indexOf("repeatEnd")>-1){const n=e.querySelector(".smart-radio-button");n&&(n.innerHTML=t.localize(i+"Option"),n.checked="repeatEnd"===i,t._setEditorCommonProperties(n)),r&&(r instanceof Smart.DateTimePicker?(r.formatString="yyyy-MMM-dd",r.value=new Date):r.value=1,r.disabled=n&&!n.checked)}t._setEditorCommonProperties(r)}_setEditorCommonProperties(e){const t=this;e&&(e.locale=t.locale,e.rightToLeft=t.rightToLeft,e.animation=t.animation,e.theme=t.theme)}_setRepeatOnEditor(e){const t=this,i=t.$.schedulerWindow._target,n=t._windowEditors,l=n.repeatOn,r=n.repeatInterval.querySelector("[event-editor]").value.toLowerCase();let a,o=i.repeatOn;if(!i||!r||["weekly","monthly","yearly"].indexOf(r)<0)return void e.classList.add("smart-hidden");l.$||(l.$={});const s=l.$;for(let e in s)e!==r&&s[e]&&s[e].remove();if(void 0===o&&(o=new Date),!s[r]){switch(r){case"weekly":{a=document.createElement("smart-button-group"),a.dataSource=t._getWeekDays(),a.selectionMode="zeroOrMany",a.setAttribute("event-editor",""),Array.isArray(o)||(o=[o]);let e=[];for(let t=0;t<o.length;t++)o[t]instanceof Date?e.push(o[t].getDay().toString()):e.push(Math.max(0,Math.min(6,parseInt(o[t])||0)).toString());a.selectedValues=e;break}case"monthly":a=document.createElement("smart-number-input"),a.min=1,a.max=31,a.setAttribute("event-editor",""),o instanceof Date?a.value=o.getDate().toString():a.value=Math.max(0,Math.min(31,parseInt(o)||0)).toString();break;case"yearly":{a=document.createElement("div");const e=document.createElement("smart-input"),i=document.createElement("smart-number-input");e.dataSource=t._getMonthNames(),e.dropDownButtonPosition="right",e.readonly=!0,i.min=1,i.max=31,o instanceof Date?(e.selectedIndex=o.getMonth(),i.value=o.getDate()):(e.selectedIndex=Math.max(0,Math.min(11,parseInt(o)||0)),i.value=Math.max(0,Math.min(31,parseInt(o)||0)).toString()),e.setAttribute("event-editor",""),i.setAttribute("event-editor",""),t._setEditorCommonProperties(e),t._setEditorCommonProperties(i),a.appendChild(e),a.appendChild(i),a.classList.add("smart-scheduler-window-editor");break}}s[r]=a}a=s[r],e.contains(a)||e.appendChild(a),e.classList.remove("smart-hidden")}_getMonthNames(){const e=[],t=this.monthFormat,i=this.locale,n=new Date;n.setMonth(0);for(let l=0;l<12;l++)e.push({label:n.toLocaleDateString(i,{month:t}),value:n.getMonth()}),n.setMonth(n.getMonth()+1);return e}_getWeekDays(){const e=[],t=this.weekdayFormat,i=this.locale,n=new Date;n.setDate(n.getDate()-n.getDay()+this.firstDayOfWeek);for(let l=0;l<7;l++)e.push({label:n.toLocaleDateString(i,{weekday:t}),value:n.getDay()}),n.setDate(n.getDate()+1);return e}_createWindowTemplate(e){const t=this,i=document.createElement("template");return"footer"===e?i.innerHTML=`<smart-button class="smart-scheduler-window-button ok primary"\n                    animation="${t.animation}" theme="${t.theme}" ${t.rightToLeft?"right-to-left":""}>\n                </smart-button>\n                <smart-button class="smart-scheduler-window-button cancel"\n                    animation="${t.animation}" theme="${t.theme}" ${t.rightToLeft?"right-to-left":""}>\n                </smart-button>\n                <smart-button class="smart-scheduler-window-button delete secondary"\n                    animation="${t.animation}" theme="${t.theme}" ${t.rightToLeft?"right-to-left":""}>\n                </smart-button>`:"header"===e&&(i.innerHTML='<span class="smart-scheduler-window-label"></span>'),i}_hourValidator(e,t){return Math.max(0,Math.min(23,t))}_dateValidator(e,t){const i=this;let n;if(t instanceof Date)return i._minMaxDateValidator(t);if(Smart.Utilities.DateTime&&t instanceof Smart.Utilities.DateTime)return i._minMaxDateValidator(t.toDate());if("string"!=typeof t)return i._minMaxDateValidator(e);{const e=/\d+:\d+:\d+/;if("new Date()"===t.trim()||"new Smart.Utilities.DateTime()"===t.trim())return i._minMaxDateValidator(new Date);if(isNaN(Date.parse(t))){const i=/(\d+[,-.\/]{1}\s*\d+[,-.\/]{1}\s*\d+)/;if(i.test(t)){const l=i.exec(t)[0].replace(/[,-.\/]/g,",").split(",");if(3===l.length){const[i,r]=parseInt(l[0])<parseInt(l[2])?[l[0],l[2]]:[l[2],l[0]];if(n=new Date(parseInt(r),parseInt(l[1])-1,parseInt(i)),e.test(t)){const i=e.exec(t)[0].split(":");n.setHours(i[0]||0,i[1]||0,i[2]||0)}t=n}}}else n=new Date(Date.parse(t)),e.test(t)||n.setHours(0,0,0,0),t=n}return i._minMaxDateValidator(new Date(t))}_firstDayOfWeekValidator(e,t){return Math.min(6,Math.max(0,t))}_minMaxDateValidator(e){if(!e||isNaN(e.getTime()))return e;const t=new Date(this.min),i=new Date(this.max);return t&&(e=new Date(Math.max(t.getTime(),e.getTime()))),i&&(e=new Date(Math.min(i.getTime(),e.getTime()))),e}_nonworkingDayValidator(e,t){return this._nonworkingDateTimeValidator(e,t)}_nonworkingTimeValidator(e,t){return this._nonworkingDateTimeValidator(e,t,!0)}_nonworkingDateTimeValidator(e,t,i){let n=[];const[l,r]=[0,i?23:6];for(let e=0;e<t.length;e++){const a=t[e];if("number"!=typeof a||isNaN(a))if(Array.isArray(a)){let e=Math.max(l,Math.min(r,parseInt(a[0]))),t=Math.max(l,Math.min(r,parseInt(a[1])));if(!isNaN(e)&&!isNaN(t)){for(;e!==t;)n.push(e),e=e===r?l:++e;n.push(e)}}else{const e=this._dateValidator(a,a);e instanceof Date&&n.push(i?e.getHours():e.getDay())}else n.push(Math.max(l,Math.min(r,parseInt(a))))}return n}_setViewType(e){const t=this.views.find(t=>t.value&&t.value===e);e=t?t.type:e,this.set("viewType",this.properties.viewType.allowedValues.indexOf(e)>-1?e:"day")}_timeZoneValidator(e,t){const i=this;try{return Intl.DateTimeFormat(i.locale,{timeZone:t}),t}catch(t){return i.error(i.localize("invalidTimeZone",{elementType:i.nodeName.toLowerCase()})),e}}_timeZonesValidator(e,t){const i=this;let n=[];for(let e=0;e<t.length;e++){const l=t[e],r=l.id||l;null!==i._timeZoneValidator(null,r)&&n.push({id:r,label:l.label||r})}return n}_viewValidator(e,t){return this._isViewUpdated=!0,this._setViewType(t),delete this._isViewUpdated,t}_viewTypeValidator(e,t){return this._isViewUpdated?t:e}_viewsValidator(e,t){const i=this,n=i.properties.viewType.allowedValues;let l=[];for(let e=0;e<t.length;e++){const r=t[e];"string"==typeof r&&n.includes(r)?l.push(r):"object"==typeof r&&n.includes(r.type)&&(r.value=r.value||r.type,r.label=r.label||i.localize(r.type),l.push(r))}return l}})}});
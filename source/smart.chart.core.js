
/* Smart UI v9.1.1 (2021-Feb) 
Copyright (c) 2011-2021 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={i:s,l:!1,exports:{}};return e[s].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(s,r,function(t){return e[t]}.bind(null,r));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=13)}({13:function(e,t,i){Smart("smart-chart",class extends Smart.BaseElement{static get properties(){return{animationDuration:{value:300,type:"number"},backgroundColor:{value:null,type:"string?"},backgroundImage:{value:"",type:"string"},borderLineColor:{value:null,type:"string?"},borderLineWidth:{value:1,type:"number"},caption:{value:"Caption",type:"string"},clip:{value:!0,type:"boolean"},colorScheme:{value:"scheme01",type:"string"},columnSeriesOverlap:{value:!1,type:"boolean"},crosshairsColor:{value:null,type:"string?"},crosshairsDashStyle:{value:"2,2",type:"string"},crosshairsLineWidth:{value:1,type:"number"},dataSource:{value:[],type:"object",reflectToAttribute:!1},description:{value:"Description",type:"string"},draw:{value:null,type:"function?"},drawBefore:{value:null,type:"function?"},enableAxisTextAnimation:{value:!1,type:"boolean"},enableCrosshairs:{value:!1,type:"boolean"},greyScale:{value:!1,type:"boolean"},legendLayout:{value:{flow:{value:"horizontal",allowedValues:["horizontal","vertical"],type:"string"},height:{value:null,type:"number?"},left:{value:null,type:"number?"},top:{value:null,type:"number?"},width:{value:null,type:"number?"}},type:"object?"},localization:{value:{decimalSeparator:{value:".",type:"string"},patterns:{value:null,type:"object?"},thousandsSeparator:{value:"",type:"string"}},type:"object"},messages:{value:{en:{invalidRadiusDataField:"smart-chart: Invalid radiusDataField value at [{{index}}]",invalidSeries:"smart-chart: Invalid property: each series group must have a 'series' property which must be a valid array.",invalidSeriesGroups:"smart-chart: Invalid property: 'seriesGroups' property is required and must be a valid array.",invalidType:'smart-chart: Invalid serie type "{{type}}".',missingAxis:"smart-chart: seriesGroup[{{index}}] is missing {{axis}} definition.",missingReference:"smart-chart: Missing reference to {{files}}.",missingType:"smart-chart: Invalid property: each series group must have a valid 'type' property."}},type:"object",extend:!0},padding:{value:{bottom:{value:5,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},renderEngine:{value:"",allowedValues:["","SVG","HTML5"],type:"string"},rightToLeft:{value:!1,type:"boolean"},seriesGroups:{value:[],type:"any",reflectToAttribute:!1},showBorderLine:{value:!0,type:"boolean"},showLegend:{value:!0,type:"boolean"},showToolTips:{value:!0,type:"boolean"},showToolTipsOnAllSeries:{value:!1,type:"boolean"},theme:{value:"light",allowedValues:["light","dark"],type:"string"},titlePadding:{value:{bottom:{value:10,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},toolTipBackground:{value:null,type:"string?"},toolTipFormatFunction:{value:null,type:"function?"},toolTipHideDelay:{value:4e3,type:"number"},toolTipLineColor:{value:null,type:"string?"},toolTipShowDelay:{value:300,type:"number"},valueAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baselineValue:{value:0,type:"any"},customDraw:{value:!1,type:"boolean"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"left",allowedValues:["left","right","top","bottom"],type:"string"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!0,type:"boolean"}},type:"object"},xAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baseUnit:{value:null,allowedValues:["year","month","day","hour","minute","second","millisecond",null],type:"string?"},customDraw:{value:!1,type:"boolean"},dataField:{value:"",type:"string"},dateFormat:{value:null,type:"string?"},displayText:{value:null,type:"string?"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"bottom",allowedValues:["bottom","top","left","right"],type:"string"},rangeSelector:{value:{backgroundColor:{value:null,type:"string?"},backgroundImage:{value:"",type:"string"},baseUnit:{value:null,allowedValues:["year","month","day","hour","minute","second","millisecond",null],type:"string?"},borderLineColor:{value:null,type:"string?"},borderLineWidth:{value:null,type:"number?"},caption:{value:"",type:"string"},colorScheme:{value:null,type:"string?"},columnSeriesOverlap:{value:!1,type:"boolean"},columnsGapPercent:{value:25,type:"number"},dataField:{value:null,type:"string?"},description:{value:"",type:"string"},greyScale:{value:null,type:"boolean?"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:null,allowedValues:["bottom","top","left","right"],type:"string?"},renderTo:{value:null,type:"any"},rightToLeft:{value:null,type:"boolean?"},seriesGapPercent:{value:10,type:"number"},seriesGroups:{value:null,type:"array?"},serieType:{value:"area",type:"string"},showBorderLine:{value:null,type:"boolean?"},size:{value:null,type:"number?"},skipOverlappingPoints:{value:!0,type:"boolean"},titlePadding:{value:{bottom:{value:10,type:"number"},left:{value:5,type:"number"},right:{value:5,type:"number"},top:{value:5,type:"number"}},type:"object"},unitInterval:{value:null,type:"number?"},valueAxis:{value:{alternatingBackgroundColor:{value:"",type:"string"},alternatingBackgroundColor2:{value:"",type:"string"},alternatingBackgroundOpacity:{value:1,type:"number"},axisSize:{value:null,type:"any"},bands:{value:null,type:"array?"},baselineValue:{value:0,type:"any"},customDraw:{value:!1,type:"boolean"},flip:{value:!1,type:"boolean"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},gridLines:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},labels:{value:{angle:{value:0,type:"number"},autoRotate:{value:!1,type:"boolean"},class:{value:null,type:"string?"},custom:{value:null,type:"array?"},formatFunction:{value:null,type:"function?"},formatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},offset:{value:{x:{value:0,type:"number"},y:{value:0,type:"number"}},type:"object"},rotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"any"}},type:"object"},line:{value:{color:{value:"",type:"string"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},visible:{value:!0,type:"any"}},type:"object"},logarithmicScale:{value:!1,type:"boolean"},logarithmicScaleBase:{value:10,type:"number"},maxValue:{value:NaN,type:"any"},minValue:{value:NaN,type:"any"},padding:{value:{bottom:{value:0,type:"number"},left:{value:0,type:"number"},right:{value:0,type:"number"},top:{value:0,type:"number"}},type:"object"},position:{value:"left",allowedValues:["left","right","top","bottom"],type:"string"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!1,type:"boolean"}},type:"object"},visible:{value:!1,type:"boolean"}},type:"object"},textRotationAngle:{value:null,type:"number?"},textRotationPoint:{value:"auto",allowedValues:["auto","left","center","right","topleft","topcenter","topright","bottomleft","bottomcenter","bottomright","centermiddle"],type:"string"},tickMarks:{value:{color:{value:"",type:"string"},custom:{value:null,type:"array?"},dashStyle:{value:"",type:"string"},lineWidth:{value:1,type:"number"},size:{value:4,type:"number"},step:{value:null,type:"number?"},unitInterval:{value:null,type:"number?"},visible:{value:!0,type:"any"}},type:"object"},title:{value:{class:{value:null,type:"string?"},horizontalAlignment:{value:"center",allowedValues:["left","center","right"],type:"string"},text:{value:"",type:"string"},verticalAlignment:{value:"center",allowedValues:["top","center","bottom"],type:"string"},visible:{value:!0,type:"boolean"}},type:"object"},toolTipFormatFunction:{value:null,type:"function?"},toolTipFormatSettings:{value:{dateFormat:{value:null,type:"string?"},decimalPlaces:{value:null,type:"number?"},decimalSeparator:{value:null,type:"string?"},negativeWithBrackets:{value:!1,type:"boolean"},prefix:{value:"",type:"string"},sufix:{value:"",type:"string"},thousandsSeparator:{value:null,type:"string?"}},type:"object"},type:{value:"auto",allowedValues:["auto","date","basic","linear"],type:"string"},unitInterval:{value:null,type:"number?"},valuesOnTicks:{value:!0,type:"boolean"},visible:{value:!0,type:"boolean"}},type:"object",reflectToAttribute:!1}}}get _legendLayout(){const e=this.legendLayout;return null!==e.height||null!==e.left||null!==e.top||null!==e.width||"vertical"===e.flow}_getFormatSettings(e,t){if(!e)return null;const i=e[t||"formatSettings"];return i&&(i.dateFormat||null!==i.decimalPlaces||i.decimalSeparator||i.negativeWithBrackets||i.prefix||i.sufix||i.thousandsSeparator)?i:null}static get listeners(){return{click:"_clickHandler",down:"_downMoveHandler",mouseleave:"_mouseleaveHandler",move:"_moveHandler",resize:"_resizeHandler","document.move":"_downMoveHandler","document.up":"_documentUpHandler"}}static get requires(){return{"Smart.Utilities.Draw":"smart.draw.js"}}static get styleUrls(){return["smart.chart.css"]}template(){return'<div role="presentation"></div>'}ready(){super.ready(),this.checkLicense()}render(){this._observeSeriesGroups(),this._isTouchDevice=Smart.Utilities.Core.isMobile,this._setDefaults(),this._createColorsCache(),this.refresh(),this._setAriaProperties(),super.render()}attached(){super.attached(),this.isCompleted&&!this._isRangeSelectorInstance&&Object.values(this._rangeSelectorInstances).forEach(e=>{e.parentDiv.parentDiv.appendChild(e.parentDiv)})}detached(){const e=this;super.detached(),e._isRangeSelectorInstance||(e._ttEl&&e._ttEl.box&&e._ttEl.box.remove(),delete e._ttEl,Object.values(e._rangeSelectorInstances).forEach(e=>{e.parentDiv.remove()}))}_setAriaProperties(){const e=this;if(e._isRangeSelectorInstance)return;const t=e.xAxis,i=e.valueAxis,s=e.seriesGroups;let r=e.$.content.children[1],a="",l=!0;function n(e,t){e&&(e.title&&e.title.text||e.description||e.dataField)&&(a+='; "',e.title&&e.title.text?a+=e.title.text:a+=e.description||e.dataField,a+='" on the '+t,isNaN(e.minValue)||(a+=" from "+e.minValue),isNaN(e.maxValue)||(a+=" up to "+e.maxValue))}e.setAttribute("role","figure"),r||(r=document.createElement("div"),r.id=e.id+"DescriptionContainer",r.className="smart-hidden",e.$.content.appendChild(r)),e.setAttribute("aria-labelledby",e.id+"TitleText"),e.setAttribute("aria-describedby",e.id+"TitleDescription "+r.id),a+="This chart displays:",n(t,"x-axis"),n(i,"y-axis");for(let e=0;e<s.length;e++){const t=s[e];if(n(t.valueAxis,"y-axis"),t.series){l=l&&"horizontal"===t.orientation;for(let i=0;i<t.series.length;i++){const s=t.series[i];0===i&&(a+=0===e?" for ":"; "),a+='"'+(s.displayText||s.dataField)+'"',i!==t.series.length-1&&(a+=", ")}}}a=a.replace(":;",":"),a=a.replace(/<.+?>/g,""),l&&(a=a.replace(/x-axis/g,"@@@"),a=a.replace(/y-axis/g,"x-axis"),a=a.replace(/@@@/g,"y-axis")),e.description&&(a="; "+a),r.innerHTML=a}_observeSeriesGroups(){const e=this;function t(t){e.context!==e&&t.newValue!==t.oldValue&&e.update()}if(e._validateSeriesGroups(),Array.isArray(e.seriesGroups)){e.seriesGroups=new Smart.ObservableArray(e.seriesGroups),e.seriesGroups.canNotify=!0;for(let i=0;i<e.seriesGroups.length;i++)Array.isArray(e.seriesGroups[i].series)&&(e.seriesGroups[i].series=new Smart.ObservableArray(e.seriesGroups[i].series),e.seriesGroups[i].series.canNotify=!0,e.seriesGroups[i].series.notify(t));e.seriesGroups.notify(t)}}_downMoveHandler(e){let t=e.originalEvent.target;this.shadowRoot&&t===this&&(t=e.originalEvent.composedPath()[0]);const i=t.closest(".smart-chart-range-selector");if(!i)return;const s=i.firstElementChild,r=s.parentChart;this!==s&&this!==r||r["_onSliderMouse"+e.type.slice(0,1).toUpperCase()+e.type.slice(1)](e)}_documentUpHandler(e){const t=this;t._draggingRangeSelector&&t._onSliderMouseUp(e)}_setDefaults(){this.axisPadding=5,this.enableEvents=!0,this.enableSampling=!0,this._itemsToggleState=[],this._isToggleRefresh=!1,this._isSelectorRefresh=!1,this._sliders=[],this._selectorRange=[],this._rangeSelectorInstances={},this._resizeState={},this._isRangeSelectorInstance=this._isRangeSelectorInstance||!1,this._renderData={},this._smartPlot=null,this._animTickInt=50,this._seriesTypes=["line","stackedline","stackedline100","spline","stackedspline","stackedspline100","stepline","stackedstepline","stackedstepline100","area","stackedarea","stackedarea100","splinearea","stackedsplinearea","stackedsplinearea100","steparea","stackedsteparea","stackedsteparea100","rangearea","splinerangearea","steprangearea","column","stackedcolumn","stackedcolumn100","rangecolumn","scatter","stackedscatter","stackedscatter100","bubble","stackedbubble","stackedbubble100","pie","donut","candlestick","ohlc","waterfall","stackedwaterfall"],this.colorSchemes=[{name:"scheme01",colors:["#307DD7","#AA4643","#89A54E","#71588F","#4198AF"]},{name:"scheme02",colors:["#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8"]},{name:"scheme03",colors:["#E8601A","#FF9639","#F5BD6A","#599994","#115D6E"]},{name:"scheme04",colors:["#D02841","#FF7C41","#FFC051","#5B5F4D","#364651"]},{name:"scheme05",colors:["#25A0DA","#309B46","#8EBC00","#FF7515","#FFAE00"]},{name:"scheme06",colors:["#0A3A4A","#196674","#33A6B2","#9AC836","#D0E64B"]},{name:"scheme07",colors:["#CC6B32","#FFAB48","#FFE7AD","#A7C9AE","#888A63"]},{name:"scheme08",colors:["#3F3943","#01A2A6","#29D9C2","#BDF271","#FFFFA6"]},{name:"scheme09",colors:["#1B2B32","#37646F","#A3ABAF","#E1E7E8","#B22E2F"]},{name:"scheme10",colors:["#5A4B53","#9C3C58","#DE2B5B","#D86A41","#D2A825"]},{name:"scheme11",colors:["#993144","#FFA257","#CCA56A","#ADA072","#949681"]},{name:"scheme12",colors:["#105B63","#EEEAC5","#FFD34E","#DB9E36","#BD4932"]},{name:"scheme13",colors:["#BBEBBC","#F0EE94","#F5C465","#FA7642","#FF1E54"]},{name:"scheme14",colors:["#60573E","#F2EEAC","#BFA575","#A63841","#BFB8A3"]},{name:"scheme15",colors:["#444546","#FFBB6E","#F28D00","#D94F00","#7F203B"]},{name:"scheme16",colors:["#583C39","#674E49","#948658","#F0E99A","#564E49"]},{name:"scheme17",colors:["#142D58","#447F6E","#E1B65B","#C8782A","#9E3E17"]},{name:"scheme18",colors:["#4D2B1F","#635D61","#7992A2","#97BFD5","#BFDCF5"]},{name:"scheme19",colors:["#844341","#D5CC92","#BBA146","#897B26","#55591C"]},{name:"scheme20",colors:["#56626B","#6C9380","#C0CA55","#F07C6C","#AD5472"]},{name:"scheme21",colors:["#96003A","#FF7347","#FFBC7B","#FF4154","#642223"]},{name:"scheme22",colors:["#5D7359","#E0D697","#D6AA5C","#8C5430","#661C0E"]},{name:"scheme23",colors:["#16193B","#35478C","#4E7AC7","#7FB2F0","#ADD5F7"]},{name:"scheme24",colors:["#7B1A25","#BF5322","#9DA860","#CEA457","#B67818"]},{name:"scheme25",colors:["#0081DA","#3AAFFF","#99C900","#FFEB3D","#309B46"]},{name:"scheme26",colors:["#0069A5","#0098EE","#7BD2F6","#FFB800","#FF6800"]},{name:"scheme27",colors:["#FF6800","#A0A700","#FF8D00","#678900","#0069A5"]},{name:"scheme28",colors:["#3A43BA","#281E5D","#48AAAD","#0492C2","#1E456E","#59788D","#52B2C0","#82EDFD"]},{name:"scheme29",colors:["#003F5C","#BC5090","#58508D","#FF6361","#FFA600"]},{name:"scheme30",colors:["#16736F","#A2D56A","#1C515C","#62B773","#EEEF63","#1F313F","#309577"]},{name:"scheme31",colors:["#74CC66","#191A4D","#2D867A","#EEE3CD","#224D19","#0D261B","#5771C7","#B6D7E7","#206052","#6B5724","#C3AF4B","#603620","#536722","#B6E7B9","#34819D","#94ACDB"]},{name:"scheme32",colors:["#87C5FF","#5B5B60","#9BE076","#F7A384","#7479D3","#F13A80","#E4D388","#2BC6B2","#F45B14"]}]}_clickHandler(e){const t=this;if(t.disabled||t._isRangeSelectorInstance)return;let i=e.pageX||e.clientX||e.screenX,s=e.pageY||e.clientY||e.screenY;const r=t.getBoundingClientRect();t._isTouchDevice&&(i=e.pageX,s=e.pageY),i-=r.left,s-=r.top,t._mouseX=i,t._mouseY=s,!isNaN(t._lastClickTs)&&(new Date).valueOf()-t._lastClickTs<100||(this._hostClickTimer=setTimeout((function(){if(t._isTouchDevice||(t._cancelTooltipTimer(),t._hideToolTip(),t._unselect()),t._pointMarker&&t._pointMarker.element){const i=t.seriesGroups[t._pointMarker.gidx],s=i.series[t._pointMarker.sidx];e.stopImmediatePropagation(),t._raiseItemEvent("click",i,s,t._pointMarker.iidx)}}),100),"HTML5"===t.renderEngine&&t._canvasClickHandler(i,s))}_canvasClickHandler(e,t){const i=this,s=i.renderer._elements;let r;for(let i in s)if(s.hasOwnProperty(i)&&"0"!==i){const a=s[i];if(t>a.y&&t<a.y+a.height&&e>a.x&&e<a.x+a.width){r=a;break}}if(r&&r.purpose&&"legend-toggle"===r.purpose){const e=r.data;i._toggleSerie(e.groupIndex,e.seriesIndex,e.itemIndex)}}_mouseleaveHandler(){if(this.disabled||this._isRangeSelectorInstance)return;const e=this._mouseX,t=this._mouseY,i=this._plotRect;i&&e>=i.x&&e<=i.x+i.width&&t>=i.y&&t<=i.y+i.height||(this._cancelTooltipTimer(),this._hideToolTip(0),this._unselect())}_moveHandler(e){const t=this;if(t.disabled)return;if(t._isRangeSelectorInstance){const i=t.parentChart;null===i.xAxis.rangeSelector.renderTo&&(i._unselect(),i._hideToolTip()),"touchmove"===e.originalEvent.type&&e.originalEvent.preventDefault()}else t.style.cursor="default";let i=e.pageX||e.clientX||e.screenX,s=e.pageY||e.clientY||e.screenY;const r=t.getBoundingClientRect();t._isTouchDevice&&(i=e.pageX,s=e.pageY),i-=r.left,s-=r.top,t.onmousemove(i,s)}_resizeHandler(){const e=this.animation;this._isRangeSelectorInstance||(this.animation="none",this.refresh(),this.animation=e)}propertyChangedHandler(e,t,i){const s=this;switch(e){case"animation":case"theme":s._ttEl&&s._ttEl.box.setAttribute(e,i);break;case"rightToLeft":if(!s._ttEl||!s._ttEl.box)break;i?s._ttEl.box.setAttribute("right-to-left",i):s._ttEl.box.removeAttribute("right-to-left");break;case"seriesGroups":s._observeSeriesGroups();break;case"xAxis_rangeSelector_renderTo":if(null===i){const e=t.getElementsByClassName("smart-chart-range-selector")[0];e.parentElement.removeChild(e)}}this.refresh()}_initRenderer(){this._draw=new Smart.Utilities.Draw(this.$.content,this.renderEngine),this.renderer=this._draw.renderer,this._smartPlot||(this._smartPlot=new Smart.Utilities.Plot(this.renderer)),this.$.content.firstElementChild.setAttribute("role","presentation")}_internalRefresh(){const e=this;if(!(e.offsetWidth||e.offsetHeight||e.getClientRects().length))return;e._stopAnimations(),e.renderer&&(e._isToggleRefresh||e._isUpdate)||(e._hideToolTip(0),e.$.content.innerHTML="",e._initRenderer());const t=e.renderer;if(!t)return;const i=t.getRect();e._render({x:1,y:1,width:i.width,height:i.height}),this.$.fireEvent("refreshBegin",{instance:this}),t instanceof Smart.Utilities.HTML5Renderer&&t.refresh(),e._isUpdate=!1,this.$.fireEvent("refreshEnd",{instance:this})}saveAsPNG(e){return this._saveAsImage("png",e)}saveAsJPEG(e){return this._saveAsImage("jpeg",e)}saveAsPDF(e,t){return this._saveAsImage("pdf",e,t)}print(){return this._saveAsImage("print")}_saveAsImage(e,t,i){return this._draw._widgetToImage(this,e,t,this._hasRangeSelector?this._selectorSaveAsImageCallback:void 0,i)}_selectorSaveAsImageCallback(e,t){let i=e;for(let e=0;e<i.seriesGroups.length;e++){let s=i._getXAxis(e);if(!s||!s.rangeSelector||!s.rangeSelector.visible||s.rangeSelector.renderTo)continue;let r=i._rangeSelectorInstances[e];if(!r)continue;let a=r.renderer.getRect(),l=r.renderer.getContainer().getElementsByTagName("canvas")[0].getContext("2d"),n=i._sliders[e],o="horizontal"===i.seriesGroups[e].orientation,h=o?"height":"width",d=o?"width":"height",u=o?"y":"x",g=o?"x":"y",f={};f[u]=n.startOffset+n.rect[u],f[g]=n.rect[g],f[h]=n.endOffset-n.startOffset,f[d]=n.rect[d];let p=s.rangeSelector.colorSelectedRange||"blue",c=s.rangeSelector.colorRangeLine||"grey",m=[];m.push(r.renderer.rect(f.x,f.y,f.width,f.height,{fill:p,opacity:.1}));const y=i.renderer;o?(m.push(r.renderer.line(y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(n.rect.y),y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(f.y),{stroke:c,opacity:.5})),m.push(r.renderer.line(y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(f.y+f.height),y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(n.rect.y+n.rect.height),{stroke:c,opacity:.5})),m.push(r.renderer.line(y._ptrnd(n.rect.x),y._ptrnd(f.y),y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(f.y),{stroke:c,opacity:.5})),m.push(r.renderer.line(y._ptrnd(n.rect.x),y._ptrnd(f.y+f.height),y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(f.y+f.height),{stroke:c,opacity:.5}))):(m.push(r.renderer.line(y._ptrnd(n.rect.x),y._ptrnd(n.rect.y),y._ptrnd(f.x),y._ptrnd(n.rect.y),{stroke:c,opacity:.5})),m.push(r.renderer.line(y._ptrnd(f.x+f.width),y._ptrnd(n.rect.y),y._ptrnd(n.rect.x+n.rect.width),y._ptrnd(n.rect.y),{stroke:c,opacity:.5})),m.push(r.renderer.line(y._ptrnd(f.x),y._ptrnd(n.rect.y),y._ptrnd(f.x),y._ptrnd(n.rect.y+n.rect.height),{stroke:c,opacity:.5})),m.push(r.renderer.line(y._ptrnd(f.x+f.width),y._ptrnd(n.rect.y),y._ptrnd(f.x+f.width),y._ptrnd(n.rect.y+n.rect.height),{stroke:c,opacity:.5}))),r.renderer.refresh();let _=l.getImageData(a.x,a.y,a.width,a.height);const x=t.getContext("2d"),v=i.getBoundingClientRect(),b=r.getBoundingClientRect();x.putImageData(_,b.left-v.left,b.top-v.top,1,1,a.width,a.height);for(let e=0;e<m.length;e++)r.renderer.removeElement(m[e]);r.renderer.refresh()}return!0}refresh(){this._internalRefresh(),this._setAriaProperties()}update(){this._isUpdate=!0,this._internalRefresh()}clear(){this.caption="",this.description="",this.refresh()}_validateSeriesGroups(){const e=this;Array.isArray(this.seriesGroups)||e.seriesGroups instanceof Smart.ObservableArray||e.error(e.localize("invalidSeriesGroups"));for(let t=0;t<this.seriesGroups.length;t++){const i=this.seriesGroups[t];i.type||e.error(e.localize("missingType")),Array.isArray(i.series)||i.series instanceof Smart.ObservableArray||e.error(e.localize("invalidSeries"))}}_render(e){var t=this.renderer;this._colorsCache.clear(),!this._isToggleRefresh&&this._isUpdate&&this._renderData&&this._renderDataClone(),this._renderData=[],t.clear(),this._unselect(),this._hideToolTip(0);var i=this.backgroundImage;this.style.backgroundImage=null==i||""===i?"":-1!==i.indexOf("(")?i:'url("'+i+'")',this._rect=e;var s=this.padding||{left:5,top:5,right:5,bottom:5},r=t.createClipRect(e),a=t.beginGroup();t.setClip(a,r);var l=t.rect(e.x,e.y,e.width-2,e.height-2);if(null==i||""===i?t.attr(l,{fill:this.backgroundColor||this._getThemeColor("background")}):t.attr(l,{fill:"transparent"}),!1!==this.showBorderLine){var n=this.borderLineWidth;(isNaN(n)||n<0||n>10)&&(n=1),t.attr(l,{"stroke-width":n,stroke:this.borderLineColor||this._getThemeColor("line")})}"function"==typeof this.drawBefore&&this.drawBefore(t,e);var o={x:s.left,y:s.top,width:e.width-s.left-s.right,height:e.height-s.top-s.bottom};this._paddedRect=o;var h,d=this.titlePadding||{left:2,top:2,right:2,bottom:2};if(this.caption&&this.caption.length>0){h=t.measureText(this.caption,0,{class:"smart-chart-title-text"}),t.text(this.caption,o.x+d.left,o.y+d.top,o.width-(d.left+d.right),h.height,0,{class:"smart-chart-title-text"},!0,"center","center").id=this.id+"TitleText",o.y+=h.height,o.height-=h.height}if(this.description&&this.description.length>0){h=t.measureText(this.description,0,{class:"smart-chart-title-description"}),t.text(this.description,o.x+d.left,o.y+d.top,o.width-(d.left+d.right),h.height,0,{class:"smart-chart-title-description"},!0,"center","center").id=this.id+"TitleDescription",o.y+=h.height,o.height-=h.height}(this.caption||this.description)&&(o.y+=d.bottom+d.top,o.height-=d.bottom+d.top);var u={x:o.x,y:o.y,width:o.width,height:o.height};this._plotRect=u,this._buildStats(u);var g,f=this._isPieOnlySeries(),p=this.seriesGroups,c={xAxis:{},valueAxis:{}};for(let e=0;e<p.length&&!f;e++){if("pie"===p[e].type||"donut"===p[e].type)continue;(H=this._getXAxis(e))||this.error(this.localize("missingAxis",{index:e,axis:"xAxis"}));let t=H===this._getXAxis()?-1:e;c.xAxis[t]=0}var m=this.axisPadding;isNaN(m)&&(m=5);var y={left:0,right:0,leftCount:0,rightCount:0},_=[];for(let e=0;e<p.length;e++){const t=p[e];if("pie"===t.type||"donut"===t.type||!0===t.spider||!0===t.polar){_.push({width:0,position:0,xRel:0});continue}g="horizontal"===t.orientation;let i=(H=this._getXAxis(e))===this._getXAxis()?-1:e;var x=(S=this._getValueAxis(e))===this._getValueAxis()?-1:e,v=g?H.axisSize:S.axisSize,b={x:0,y:u.y,width:u.width,height:u.height},N=g?this._getXAxis(e).position:S.position;v&&"auto"!==v||(g?(v=this._renderXAxis(e,b,!0,u).width,1==(1&c.xAxis[i])?v=0:v>0&&(c.xAxis[i]|=1)):(v=this._renderValueAxis(e,b,!0,u).width,1==(1&c.valueAxis[x])?v=0:v>0&&(c.valueAxis[x]|=1))),"left"!==N&&!0===this.rightToLeft&&(N="right"),"right"!==N&&(N="left"),y[N+"Count"]>0&&y[N]>0&&v>0&&(y[N]+=m),_.push({width:v,position:N,xRel:y[N]}),y[N]+=v,y[N+"Count"]++}var M=Math.max(1,Math.max(e.width,e.height)),A={top:0,bottom:0,topCount:0,bottomCount:0},w=[];for(let e=0;e<p.length;e++){const t=p[e];if("pie"===t.type||"donut"===t.type||!0===t.spider||!0===t.polar){w.push({height:0,position:0,yRel:0});continue}g="horizontal"===t.orientation;var S;x=(S=this._getValueAxis(e))===this._getValueAxis()?-1:e;let i=(H=this._getXAxis(e))===this._getXAxis()?-1:e,s=g?S.axisSize:H.axisSize;N=g?S.position:H.position;s&&"auto"!==s||(g?(s=this._renderValueAxis(e,{x:0,y:0,width:M,height:0},!0,u).height,2==(2&c.valueAxis[x])?s=0:s>0&&(c.valueAxis[x]|=2)):(s=this._renderXAxis(e,{x:0,y:0,width:M,height:0},!0).height,2==(2&c.xAxis[i])?s=0:s>0&&(c.xAxis[i]|=2))),"top"!==N&&(N="bottom"),A[N+"Count"]>0&&A[N]>0&&s>0&&(A[N]+=m),w.push({height:s,position:N,yRel:A[N]}),A[N]+=s,A[N+"Count"]++}this._createAnimationGroup("series");const C=!1!==this.showLegend,k=this._legendLayout;var T=C?this._renderLegend(k?this._rect:o,!0):{width:0,height:0};if(!k||isNaN(this.legendLayout.left)&&isNaN(this.legendLayout.top)||(T={width:0,height:0}),o.height<A.top+A.bottom+T.height||o.width<y.left+y.right)t.endGroup();else{u.height-=A.top+A.bottom+T.height,u.x+=y.left,u.width-=y.left+y.right,u.y+=A.top;var D=[];if(!f)for(let e=0;e<p.length;e++){const t=p[e];if(!0===t.polar||!0===t.spider||"pie"===t.type||"donut"===t.type)continue;g="horizontal"===t.orientation;var F=this._getXAxis(e)===this._getXAxis()?-1:e;x=this._getValueAxis(e)===this._getValueAxis()?-1:e;let i={x:u.x,y:0,width:u.width,height:w[e].height};if("top"!==w[e].position?i.y=u.y+u.height+w[e].yRel:i.y=u.y-w[e].yRel-w[e].height,g){if(4==(4&c.valueAxis[x]))continue;if(!this._isGroupVisible(e))continue;this._renderValueAxis(e,i,!1,u),c.valueAxis[x]|=4}else{if(D.push(i),4==(4&c.xAxis[F]))continue;if(!this._isGroupVisible(e))continue;this._renderXAxis(e,i,!1,u),c.xAxis[F]|=4}}if(C){const e=this._legendLayout,t=e?this._rect:o;var O=o.x+this.renderer._ptrnd((o.width-T.width)/2),I=u.y+u.height+A.bottom;v=o.width;let i=T.height;e&&(isNaN(this.legendLayout.left)||(O=this.legendLayout.left),isNaN(this.legendLayout.top)||(I=this.legendLayout.top),isNaN(this.legendLayout.width)||(v=this.legendLayout.width),isNaN(this.legendLayout.height)||(i=this.legendLayout.height)),O+v>t.x+t.width&&(v=t.x+t.width-O),I+i>t.y+t.height&&(i=t.y+t.height-I),this._renderLegend({x:O,y:I,width:v,height:i})}if(this._hasHorizontalLines=!1,!f)for(let e=0;e<p.length;e++){const t=p[e];if(!0===t.polar||!0===t.spider||"pie"===t.type||"donut"===t.type)continue;g="horizontal"===p[e].orientation;let i={x:u.x-_[e].xRel-_[e].width,y:u.y,width:_[e].width,height:u.height};"left"!==_[e].position&&(i.x=u.x+u.width+_[e].xRel);F=this._getXAxis(e)===this._getXAxis()?-1:e,x=this._getValueAxis(e)===this._getValueAxis()?-1:e;if(g){if(D.push(i),8==(8&c.xAxis[F]))continue;if(!this._isGroupVisible(e))continue;this._renderXAxis(e,i,!1,u),c.xAxis[F]|=8}else{if(8==(8&c.valueAxis[x]))continue;if(!this._isGroupVisible(e))continue;this._renderValueAxis(e,i,!1,u),c.valueAxis[x]|=8}}if(!(u.width<=0||u.height<=0)){this._plotRect={x:u.x,y:u.y,width:u.width,height:u.height};for(let e=0;e<p.length;e++)this._drawPlotAreaLines(e,!0,{gridLines:!1,tickMarks:!1,alternatingBackground:!0}),this._drawPlotAreaLines(e,!1,{gridLines:!1,tickMarks:!1,alternatingBackground:!0});for(let e=0;e<p.length;e++)this._drawPlotAreaLines(e,!0,{gridLines:!0,tickMarks:!0,alternatingBackground:!1}),this._drawPlotAreaLines(e,!1,{gridLines:!0,tickMarks:!0,alternatingBackground:!1});var P=!1;for(let e=0;e<p.length&&!P;e++){const t=p[e];if(void 0!==t.annotations||"function"==typeof t.draw||"function"==typeof t.drawBefore){P=!0;break}}var R=t.beginGroup();if(this.clip&&!P){var L=t.createClipRect({x:u.x-2,y:u.y,width:u.width+4,height:u.height});t.setClip(R,L)}for(let i=0;i<p.length;i++){const s=p[i];var G=!1;for(var V in this._seriesTypes)if(this._seriesTypes[V]===s.type){G=!0;break}G||this.error(this.localize("invalidType",{type:s.type})),"function"==typeof s.drawBefore&&s.drawBefore(t,e,i,this),!0!==s.polar&&!0!==s.spider||-1===s.type.indexOf("pie")&&-1===s.type.indexOf("donut")&&this._renderSpiderAxis(i,u),this._renderAxisBands(i,u,!0),this._renderAxisBands(i,u,!1)}for(let i=0;i<p.length;i++){const s=p[i];if(this._isColumnType(s.type)?this._renderColumnSeries(i,u):-1!==s.type.indexOf("pie")||-1!==s.type.indexOf("donut")?this._renderPieSeries(i,u):-1!==s.type.indexOf("line")||-1!==s.type.indexOf("area")?this._renderLineSeries(i,u):-1!==s.type.indexOf("scatter")||-1!==s.type.indexOf("bubble")?this._renderScatterSeries(i,u):-1===s.type.indexOf("candlestick")&&-1===s.type.indexOf("ohlc")||this._renderCandleStickSeries(i,u,-1!==s.type.indexOf("ohlc")),s.annotations){this._moduleAnnotations||this.error(this.localize("missingReference",{files:"smart.chart.annotations.js"}));for(let e=0;e<s.annotations.length;e++)this._renderAnnotation(i,s.annotations[e],u)}"function"==typeof s.draw&&s.draw(t,e,i,this)}if(t.endGroup(),this.disabled){var E=t.rect(e.x,e.y,e.width,e.height);t.attr(E,{fill:"#777777",opacity:.5,stroke:"#00FFFFFF"})}"function"==typeof this.draw&&this.draw(t,e),t.endGroup(),this._startAnimation("series"),this._credits&&this._credits();var B=!1;for(let e=0;e<this.seriesGroups.length&&!B;e++){var H;(H=this._getXAxis(e))&&H.rangeSelector&&H.rangeSelector.visible&&(B=!0,this._hasRangeSelector=!0)}if(B){this._moduleRangeSelector||this.error(this.localize("missingReference",{files:"smart.chart.rangeselector.js"}));var z=[];this._isSelectorRefresh||(this._rangeSelectorInstances={});for(let e=0;e<this.seriesGroups.length;e++){var W=this._getXAxis(e);-1===z.indexOf(W)&&this._renderXAxisRangeSelector(e,D[e])&&z.push(W)}}}}}_credits(){}_isPieOnlySeries(){let e=this.seriesGroups;if(0===e.length)return!1;for(let t=0;t<e.length;t++)if("pie"!==e[t].type&&"donut"!==e[t].type)return!1;return!0}_renderChartLegend(e,t,i,s){var r=this.renderer,a={x:t.x,y:t.y,width:t.width,height:t.height};a.width>=6&&(a.x+=3,a.width-=6),a.height>=6&&(a.y+=3,a.height-=6);var l={width:a.width,height:0},n=0,o=0,h=20,d=0,u=0;for(let I=0;I<e.length;I++){var g=e[I].css;g||(g="smart-chart-legend-text"),h=20;var f=e[I].text,p=r.measureText(f,0,{class:g});p.height>h&&(h=p.height),p.width>u&&(u=p.width),s?(0!==I&&(o+=h),o>a.height&&(o=0,n+=u+20+10,u=p.width,l.width=n+u)):(0!==n&&(n+=10),n+20+p.width>a.width&&p.width<a.width&&(n=0,o+=h,h=20,d=a.width,l.height=o+h));var c=!1;if(p.width>a.width){c=!0;var m=a.width,y=(F=f).split(/\s+/);let e=[],t="";for(let i=0;i<y.length;i++){var _=t+(t.length>0?" ":"")+y[i];(b=this.renderer.measureText(_,0,{class:g})).width>m&&_.length>0&&t.length>0?(e.push({text:t}),t=y[i]):t=_,i+1===y.length&&e.push({text:t})}p.width=0;var x=0;for(let t=0;t<e.length;t++){var v=e[t].text,b=this.renderer.measureText(v,0,{class:g});p.width=Math.max(p.width,b.width),x+=p.height}p.height=x}var N=n+p.width<a.width&&o+p.height<t.height;if(this._legendLayout)N=a.x+n+p.width<this._rect.x+this._rect.width&&a.y+o+p.height<this._rect.y+this._rect.height;if(!i&&N){var M=e[I].seriesIndex,A=e[I].groupIndex,w=e[I].itemIndex,S=e[I].fillColor,C=e[I].lineColor,k=this._isSerieVisible(A,M,w),T=r.beginGroup(),D=k?e[I].opacity:.1;if(c){var F=f,O=(m=a.width,y=F.split(/\s+/),0);let t=[],i="";for(let e=0;e<y.length;e++){_=i+(i.length>0?" ":"")+y[e];(b=this.renderer.measureText(_,0,{class:g})).width>m&&_.length>0&&i.length>0?(t.push({text:i,dy:O}),O+=b.height,i=y[e]):i=_,e+1===y.length&&t.push({text:i,dy:O})}for(let e=0;e<t.length;e++){v=t[e].text;O=t[e].dy;b=this.renderer.measureText(v,0,{class:g});s?this.renderer.text(v,a.x+n+15,a.y+o+O,p.width,h,0,{class:g},!1,"left","center"):this.renderer.text(v,a.x+n+15,a.y+o+O,p.width,h,0,{class:g},!1,"center","center")}let l=r.rect(a.x+n,a.y+o+5+O/2,10,10);s&&(o+=O),this.renderer.attr(l,{fill:S,"fill-opacity":D,stroke:C,"stroke-width":1,"stroke-opacity":e[I].opacity})}else{let t,i=r.rect(a.x+n,a.y+o+5,10,10);this.renderer.attr(i,{fill:S,"fill-opacity":D,stroke:C,"stroke-width":1,"stroke-opacity":e[I].opacity,purpose:"legend-toggle",data:e[I]}),t=s?this.renderer.text(f,a.x+n+15,a.y+o,p.width,p.height+5,0,{class:g},!1,"left","center"):this.renderer.text(f,a.x+n+15,a.y+o,p.width,h,0,{class:g},!1,"center","center"),r.attr(t,{purpose:"legend-toggle",data:e[I]})}this.renderer.endGroup(),this._setLegendToggleHandler(A,M,w,T)}s||d<(n+=p.width+20)&&(d=n)}if(i)return l.height=this.renderer._ptrnd(o+h+5),l.width=this.renderer._ptrnd(d),l}isSerieVisible(e,t,i){return this._isSerieVisible(e,t,i)}_isSerieVisible(e,t,i){for(;this._itemsToggleState.length<e+1;)this._itemsToggleState.push([]);let s=this._itemsToggleState[e];for(;s.length<t+1;)s.push(!!isNaN(i)||[]);let r=s[t];if(isNaN(i))return r;for(Array.isArray(r)||(s[t]=r=[]);r.length<i+1;)r.push(!0);return r[i]}isGroupVisible(e){return this._isGroupVisible(e)}_isGroupVisible(e){let t=!1,i=this.seriesGroups[e].series;if(!i)return t;for(let s=0;s<i.length;s++)if(this._isSerieVisible(e,s)){t=!0;break}return t}_toggleSerie(e,t,i,s){let r=!this._isSerieVisible(e,t,i);void 0!==s&&(r=s);let a=this.seriesGroups[e],l=a.series[t];if(this.$.fireEvent("toggle",{state:r,seriesGroup:a,serie:l,elementIndex:i}),isNaN(i))this._itemsToggleState[e][t]=r;else{let s=this._itemsToggleState[e][t];for(Array.isArray(s)||(s=[]);s.length<i;)s.push(!0);s[i]=r}this._isToggleRefresh=!0,this.update(),this._isToggleRefresh=!1}showSerie(e,t,i){this._toggleSerie(e,t,i,!0)}hideSerie(e,t,i){this._toggleSerie(e,t,i,!1)}_setLegendToggleHandler(e,t,i,s){let r=this.seriesGroups[e],a=r.series[t].enableSeriesToggle;if(null==a&&(a=!1!==r.enableSeriesToggle),a){let r=this;this.renderer.addHandler(s,"click",(function(){r._toggleSerie(e,t,i)}))}}_renderLegend(e,t){let i=this,s=[];for(let e=0;e<i.seriesGroups.length;e++){let t=i.seriesGroups[e];if(!1!==t.showLegend)for(let r=0;r<t.series.length;r++){let a=t.series[r];if(!1===a.showLegend)continue;let l,n=i._getSerieSettings(e,r);if("pie"===t.type||"donut"===t.type){let o=i._getXAxis(e);const h=a.legendFormatSettings||t.legendFormatSettings||i._getFormatSettings(o)||i._getFormatSettings(a)||i._getFormatSettings(t);let d=a.legendFormatFunction||t.legendFormatFunction||o.formatFunction||a.formatFunction||t.formatFunction,u=i._getDataLen(e);for(let t=0;t<u;t++){l=i._getDataValue(t,a.displayText,e),l=i._formatValue(l,h,d,e,r,t);let o=i._getColors(e,r,t);s.push({groupIndex:e,seriesIndex:r,itemIndex:t,text:l,css:a.displayTextClass,fillColor:o.fillColor,lineColor:o.lineColor,opacity:n.opacity})}continue}const o=a.legendFormatSettings||t.legendFormatSettings;let h=a.legendFormatFunction||t.legendFormatFunction;l=i._formatValue(a.displayText||a.dataField||"",o,h,e,r,NaN);let d=i._getSeriesColors(e,r),u=this._get([a.legendFillColor,a.legendColor,d.fillColor]),g=this._get([a.legendLineColor,a.legendColor,d.lineColor]);s.push({groupIndex:e,seriesIndex:r,text:l,css:a.displayTextClass,fillColor:u,lineColor:g,opacity:n.opacity})}}return i._renderChartLegend(s,e,t,i._legendLayout&&"vertical"===i.legendLayout.flow)}_getInterval(e,t){if(!e)return t;let i=this._get([e.unitInterval,t]);return isNaN(e.step)||null===e.step||(i=e.step*t),i}_getOffsets(e,t,i,s,r,a,l,n,o){let h,d=this._getInterval(r[e],n),u=[];if((""===e||r[e].visible&&"custom"!==r[e].visible)&&(u=this._generateIntervalValues(s,d,n,l,o)),"labels"!==e){let e=l?a.left:0;if(!l&&n>1&&(e=a.left*(n+1)),1===u.length&&(e*=2),h=this._valuesToOffsets(u,t,s,i,a,!1,e),!l){let e=(a.left+a.right)*d/n;t.flip?h.unshift(h[0]+e):h.push(h[h.length-1]+e)}}else{let e=a.left;1===u.length&&(e*=2),h=this._valuesToOffsets(u,t,s,i,a,l,e)}let g=this._arraysToObjectsArray([u,h],["value","offset"]);if(t[e]&&t[e].custom){let r=this._objectsArraysToArray(t[e].custom,"value"),n=this._objectsArraysToArray(t[e].custom,"offset"),o=this._valuesToOffsets(r,t,s,i,a,l,a.left);for(let i=0;i<t[e].custom.length;i++)g.push({value:r[i],offset:isNaN(n[i])?o[i]:n[i]})}return g}_renderXAxis(e,t,i,s){let r=this,a=r._getXAxis(e),l=r.seriesGroups[e],n="horizontal"===l.orientation,o={width:0,height:0},h=r._getAxisSettings(a);if(!a||!h.visible||"spider"===l.type)return o;if(!r._isGroupVisible(e)||this._isPieGroup(e))return o;let d=r._alignValuesWithTicks(e);for(;r._renderData.length<e+1;)r._renderData.push({});r.rightToLeft?(a._flip=a.flip,a.flip=!0):void 0!==a._flip&&(a.flip=a._flip);let u=n?t.height:t.width,g=r._calculateXOffsets(e,u),f=g.axisStats,p=a.rangeSelector&&a.rangeSelector.visible,c=0;p&&(this._moduleRangeSelector||r.error(r.localize("missingReference",{files:"smart.chart.rangeselector.js"})),c=this._selectorGetSize(a));let m=n&&"right"===a.position||!n&&"top"===a.position;!i&&p&&(n?(t.width-=c,"right"!==a.position&&(t.x+=c)):(t.height-=c,"top"===a.position&&(t.y+=c)));let y={rangeLength:g.rangeLength,itemWidth:g.itemWidth,intervalWidth:g.intervalWidth,data:g,settings:h,isMirror:m,rect:t};r._renderData[e].xAxis=y;let _=f.interval;if(isNaN(_))return o;n&&(h.title.angle-=90,h.labels.angle-=90);let x,v,b=this._getInterval(h.gridLines,_),N=this._getInterval(h.tickMarks,_),M=this._getInterval(h.labels,_),A=f.min,w=f.max,S=g.padding,C=!0===a.flip||r.rightToLeft,k={min:A,max:w};f.logAxis.enabled&&(k.min=f.logAxis.minPow,k.max=f.logAxis.maxPow),"date"===a.type?(h.gridLines.offsets=this._generateDTOffsets(A,w,u,S,b,_,f.dateTimeUnit,d,NaN,!1,C),h.tickMarks.offsets=this._generateDTOffsets(A,w,u,S,N,_,f.dateTimeUnit,d,NaN,!1,C),x=this._generateDTOffsets(A,w,u,S,M,_,f.dateTimeUnit,d,NaN,!0,C)):(h.gridLines.offsets=this._getOffsets("gridLines",a,u,f,h,S,d,_),h.tickMarks.offsets=this._getOffsets("tickMarks",a,u,f,h,S,d,_),x=this._getOffsets("labels",a,u,f,h,S,d,_)),r._elementRenderInfo&&r._elementRenderInfo.length>e&&(v=r._elementRenderInfo[e].xAxis);let T,D=[];h.labels.formatFunction&&(T=h.labels.formatFunction);const F=r._getFormatSettings(h.labels);let O;F&&(O=Object.assign({},F)),"date"===a.type&&(a.dateFormat&&!T?O?O.dateFormat=O.dateFormat||a.dateFormat:O={dateFormat:a.dateFormat}:T||O&&(!O||O.dateFormat)||(T=this._getDefaultDTFormatFn(a.baseUnit||"day")));for(let t=0;t<x.length;t++){let i=x[t].value,s=x[t].offset;if(isNaN(s))continue;let l=void 0;"date"!==a.type&&f.useIndeces&&a.dataField&&(l=Math.round(i),i=r._getDataValue(l,a.dataField,e),null==i&&(i=""));let n=r._formatValue(i,O,T,e,void 0,l);null!=n&&""!==n.toString()||(isNaN(l)&&(l=t),l>=f.filterRange.min&&l<=f.filterRange.max&&(n=f.useIndeces?(f.min+l).toString():void 0===i?"":i.toString()));let o={key:i,text:n,targetX:s,x:s};v&&v.itemOffsets[i]&&(o.x=v.itemOffsets[i].x,o.y=v.itemOffsets[i].y),D.push(o)}let I=r._getAnimProps(e),P=I.enabled&&D.length<500?I.duration:0;!1===r.enableAxisTextAnimation&&(P=0);let R={items:D,renderData:y},L=r._renderAxis(n,m,h,{x:t.x,y:t.y,width:t.width,height:t.height},s,_,!1,!0,R,i,P);return n?L.width+=c:L.height+=c,L}_animateAxisText(e,t){let i=e.items,s=e.textSettings;for(let e=0;e<i.length;e++){let r=i[e];if(!r)continue;if(!r.visible)continue;let a=r.targetX,l=r.targetY;isNaN(r.x)||isNaN(r.y)||(a=r.x+(a-r.x)*t,l=r.y+(l-r.y)*t),r.element&&(this.renderer.removeElement(r.element),r.element=void 0),r.element=this.renderer.text(r.text,a,l,r.width,r.height,s.angle,{class:s.style},!1,s.halign,s.valign,s.textRotationPoint)}}_getPolarAxisCoords(e,t){let i=this.seriesGroups[e],s=t.x+this._draw.getNum([i.offsetX,t.width/2]),r=t.y+this._draw.getNum([i.offsetY,t.height/2]),a=Math.min(t.width,t.height),l=i.radius;this._isPercent(l)&&(l=parseFloat(l)/100*a/2),isNaN(l)&&(l=a/2*.6);let n=this._alignValuesWithTicks(e),o=this._get([i.startAngle,i.minAngle,0])-90;o=isNaN(o)?0:2*Math.PI*o/360;let h=this._get([i.endAngle,i.maxAngle,360])-90;if(h=isNaN(h)?2*Math.PI:2*Math.PI*h/360,o>h){let e=o;o=h,h=e}let d=this.renderer._rnd(Math.abs(o-h)/(2*Math.PI),.001,!0),u=2*Math.PI*l*d,g=this._calcGroupOffsets(e,t).xoffsets;if(!g)return;let f,p=!(Math.abs(Math.abs(h-o)-2*Math.PI)>1e-5);if(i.spider){const t=this._getXAxisStats(e,this._getXAxis(e),u);let i=t.interval;(isNaN(i)||0===i)&&(i=1);let s=(t.max-t.min)/i+(p?1:0);if(s=Math.round(s),s>2){let e=Math.cos(Math.abs(h-o)/2/s);e=this.renderer._rnd(e,.01),0===e&&(e=1),f=l/e,f>l&&n&&(l=f)}}return l=this.renderer._ptrnd(l),{x:s,y:r,r:l,adjR:this._get([f,l]),itemWidth:g.itemWidth,rangeLength:g.rangeLength,valuesOnTicks:n,startAngle:o,endAngle:h,isClosedCircle:p,axisSize:u}}_toPolarCoord(e,t,i,s){let r=Math.abs(e.startAngle-e.endAngle)/(2*Math.PI),a=2*(i-t.x)*Math.PI*r/Math.max(1,t.width)+e.startAngle,l=(t.height+t.y-s)*e.r/Math.max(1,t.height),n=e.x+l*Math.cos(a),o=e.y+l*Math.sin(a);return{x:this.renderer._ptrnd(n),y:this.renderer._ptrnd(o)}}_renderSpiderAxis(e,t){let i=this,s=i._getXAxis(e),r=this._getAxisSettings(s);if(!s||!r.visible)return;let a=i.seriesGroups[e],l=i._getPolarAxisCoords(e,t);if(!l)return;let n=this.renderer._ptrnd(l.x),o=this.renderer._ptrnd(l.y),h=l.adjR,d=l.startAngle,u=l.endAngle;if(h<1)return;let g=this.renderer._rnd(Math.abs(d-u)/(2*Math.PI),.001,!0),f=2*Math.PI*h*g,p=l.isClosedCircle,c=this._renderData[e].xoffsets;if(!c.rangeLength)return;let m=c.axisStats.interval;for((isNaN(m)||m<1)&&(m=1);i._renderData.length<e+1;)i._renderData.push({});let y={rangeLength:c.rangeLength,itemWidth:c.itemWidth,data:c,rect:t,settings:r};i._renderData[e].xAxis=y,i._renderData[e].polarCoords=l;let _=!0;for(let t=0;t<e;t++){let e=i._renderData[t].polarCoords,r=i._getXAxis(t),a=!1;for(let t in l)if(l[t]!==e[t]){a=!0;break}a&&r===s||(_=!1)}let x,v,b=r.gridLines,N=r.tickMarks,M=r.labels,A=this._getInterval(b,m),w=this._getInterval(N,m),S=this._getInterval(M,m),C=i._alignValuesWithTicks(e),k=i.renderer,T=c.axisStats,D=T.min,F=T.max,O=this._getPaddingSize(c.axisStats,s,C,f,!0,p,!1),I=!0===s.flip||i.rightToLeft;"date"===s.type?(b.offsets=this._generateDTOffsets(D,F,f,O,A,m,s.baseUnit,!0,0,!1,I),N.offsets=this._generateDTOffsets(D,F,f,O,w,m,s.baseUnit,!0,0,!1,I),x=this._generateDTOffsets(D,F,f,O,S,m,s.baseUnit,!0,0,!0,I)):(r.gridLines.offsets=this._getOffsets("gridLines",s,f,T,r,O,!0,m),r.tickMarks.offsets=this._getOffsets("tickMarks",s,f,T,r,O,!0,m),x=this._getOffsets("labels",s,f,T,r,O,!0,m)),i._elementRenderInfo&&i._elementRenderInfo.length>e&&(v=i._elementRenderInfo[e].xAxis);let P=[],R=this._getDataLen(e);for(let t=0;t<x.length;t++){let r,a=x[t].offset,l=x[t].value;if("date"!==s.type&&T.useIndeces&&s.dataField){if(r=Math.round(l),r>=R)continue;l=i._getDataValue(r,s.dataField),null==l&&(l="")}let n=i._formatValue(l,i._getFormatSettings(M.formatSettings),M.formatFunction,e,void 0,r);null!=n&&""!==n.toString()||(n=T.useIndeces?(T.min+t).toString():null==l?"":l.toString());let o={key:l,text:n,targetX:a,x:a};v&&v.itemOffsets[l]&&(o.x=v.itemOffsets[l].x,o.y=v.itemOffsets[l].y),P.push(o)}let L={stroke:b.color||i._getThemeColor("line"),fill:"none","stroke-width":b.width,"stroke-dasharray":b.dashStyle||""};if(!a.spider)if(1===g)k.circle(n,o,h,L);else{let e=-d/Math.PI*180,t=-u/Math.PI*180;this.renderer.pieslice(n,o,0,h,Math.min(e,t),Math.max(e,t),void 0,L)}let G=d;if(b.visible&&_){C||p||b.offsets.unshift({offset:-O.right});for(let e=0;e<b.offsets.length;e++){let t=b.offsets[e].offset;C||(t+=p?O.right/2:O.right);const i=G+2*t*Math.PI*g/Math.max(1,f);if(i-u>.01)continue;let s=this.renderer._ptrnd(n+h*Math.cos(i)),r=this.renderer._ptrnd(o+h*Math.sin(i));k.line(n,o,s,r,L)}}if(N.visible&&_){let e=5,t={stroke:N.color||i._getThemeColor("line"),fill:"none","stroke-width":N.width,"stroke-dasharray":N.dashStyle||""};C||p||N.offsets.unshift({offset:-O.right});for(let i=0;i<N.offsets.length;i++){let s=N.offsets[i].offset;C||(s+=p?O.right/2:O.right);const r=G+2*s*Math.PI*g/Math.max(1,f);if(r-u>.01)continue;let a={x:n+h*Math.cos(r),y:o+h*Math.sin(r)},l={x:n+(h+e)*Math.cos(r),y:o+(h+e)*Math.sin(r)};k.line(this.renderer._ptrnd(a.x),this.renderer._ptrnd(a.y),this.renderer._ptrnd(l.x),this.renderer._ptrnd(l.y),t)}}let V=[];if(a.spider){let e=[];e="date"===s.type?this._generateDTOffsets(D,F,f,O,m,m,s.baseUnit,!0,0,!1,I):this._getOffsets("",s,f,T,r,O,!0,m),C||p||e.unshift({offset:-O.right});for(let t=0;t<e.length;t++){let i=e[t].offset;C||(i+=p?O.right/2:O.right);const s=G+2*i*Math.PI*g/Math.max(1,f);s-u>.01||V.push(s)}y.offsetAngles=V}let E=i._renderSpiderValueAxis(e,t,C?l.adjR:l.r,V);if(E||(E=[]),a.spider){if(!C)for(let e=0;e<E.length;e++)E[e]=E[e]*l.adjR/l.r;E.push(h),this._renderSpiderLines(n,o,E,l,V,L)}if(_&&M.visible){y.polarLabels=[];for(let e=0;e<P.length;e++){let t=G+2*P[e].x*Math.PI*g/Math.max(1,f);t=(360-t/(2*Math.PI)*360)%360,t<0&&(t=360+t);let i,s=k.measureText(P[e].text,0,{class:r.labels.style}),a=(C?l.adjR:l.r)+(N.visible?7:2),h=r.labels;if(h.autoRotate){let e=this._draw._ptRotate(n-s.width/2,o-a-s.height,n,o,-t/180*Math.PI),r=this._draw._ptRotate(n+s.width/2,o-a,n,o,-t/180*Math.PI);s.width=Math.abs(e.x-r.x),s.height=Math.abs(e.y-r.y),i={x:Math.min(e.x,r.x),y:Math.min(e.y,r.y)}}else i=this._adjustTextBoxPosition(n,o,s,a,t,!1,!1,!1);y.polarLabels.push({x:i.x,y:i.y,value:P[e].text}),k.text(P[e].text,i.x,i.y,s.width,s.height,h.autoRotate?90-t:h.angle,{class:h.style},!1,h.halign,h.valign)}}}_renderSpiderLines(e,t,i,s,r,a){let l=this.renderer,n=s.isClosedCircle;for(let s=0;s<i.length;s++){let o=i[s],h=void 0,d=void 0;for(let i=0;i<r.length;i++){let s=r[i],n=this.renderer._ptrnd(e+o*Math.cos(s)),u=this.renderer._ptrnd(t+o*Math.sin(s));h&&l.line(h.x,h.y,n,u,a),h={x:n,y:u},d||(d={x:n,y:u})}d&&n&&l.line(h.x,h.y,d.x,d.y,a)}}_renderSpiderValueAxis(e,t,i,s){var r=this.seriesGroups[e],a=this._getPolarAxisCoords(e,t);if(!a)return;var l=this.renderer._ptrnd(a.x),n=this.renderer._ptrnd(a.y);i=i||a.r;var o=a.startAngle,h=a.endAngle,d=this.renderer._rnd(Math.abs(o-h)/(2*Math.PI),.001,!0);if(i<1)return;i=this.renderer._ptrnd(i);var u=this._getValueAxis(e);const g=this._getAxisSettings(u);if(u&&!1!==g.visible){var f=this._stats.seriesGroups[e].mu,p=g.labels,c=this._getFormatSettings(p);-1!==r.type.indexOf("stacked")&&-1!==r.type.indexOf("100")&&!c&&(c={sufix:"%"});var m=this._get([p.step,p.unitInterval/f]);isNaN(m)&&(m=1),m=Math.max(1,Math.round(m)),this._calcValueAxisItems(e,i,m);var y=g.gridLines,_=g.tickMarks,x=g.labels,v={stroke:y.color||this._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":y.dashStyle||""},b=this._renderData[e].valueAxis,N=b.items,M=o;if(N.length&&g.line.visible){isNaN(g.line.angle)||(M=2*Math.PI*g.line.angle/360);var A=l+Math.cos(M)*i,w=n+Math.sin(M)*i;if(-1===s.indexOf(M)){var S=Object.assign({},v);S["stroke-width"]=g.line.lineWidth,S.stroke=g.line.color||this._getThemeColor("line"),S["stroke-dasharray"]=g.line.dashStyle,this.renderer.line(l,n,A,w,S)}}N=N.reverse();var C=this.renderer;b.polarLabels=[];for(let e=0;e<N.length-1;e++){var k=N[e];if(isNaN(k))continue;var T=x.formatFunction?x.formatFunction(k):this._formatNumber(k,c),D=C.measureText(T,0,{class:x.style}),F=l+(!1!==u.showTickMarks?3:2);let t=n-b.itemWidth*e-D.height/2;var O=this._draw._ptRotate(F,t,l,n,M),I=this._draw._ptRotate(F+D.width,t+D.height,l,n,M);F=Math.min(O.x,I.x),t=Math.min(O.y,I.y),D.width=Math.abs(O.x-I.x),D.height=Math.abs(O.y-I.y),F+=g.labels.textOffset.x,t+=g.labels.textOffset.y,b.polarLabels.push({x:F,y:t,value:T}),C.text(T,F,t,D.width,D.height,x.autoRotate?90+180*o/Math.PI:x.angle,{class:x.style},!1,x.halign,x.valign)}var P=!1!==u.valuesOnTicks,R=this._stats.seriesGroups[e],L=R.mu,G=!0===u.logarithmicScale;G&&(L=1);var V={min:R.min,max:R.max,logAxis:{enabled:!0===G,base:u.logarithmicScaleBase,minPow:R.minPow,maxPow:R.maxPow}};(y.visible||r.spider||u.alternatingBackgroundColor||u.alternatingBackgroundColor2)&&(y.offsets=this._getOffsets("gridLines",u,i,V,g,{left:0,right:0},P,L));var E=[];if(y.visible||r.spider){let e={stroke:y.color||this._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":y.dashStyle||""};for(let t=0;t<y.offsets.length;t++){let s=this.renderer._ptrnd(y.offsets[t].offset);if(s!==i)if(r.spider)E.push(s);else if(1!==d){var B=-o/Math.PI*180,H=-h/Math.PI*180;this.renderer.pieslice(l,n,0,s,Math.min(B,H),Math.max(B,H),void 0,e)}else C.circle(l,n,s,e)}}if(u.tickMarks&&(u.tickMarks.visible||u.showTickMarks)||(_.visible=!1),_.visible){_.offsets=this._getOffsets("tickMarks",u,i,V,g,{left:0,right:0},P,L);const e=2*_.size;let t={stroke:_.color||this._getThemeColor("line"),fill:"none","stroke-width":1,"stroke-dasharray":_.dashStyle||""};for(let i=0;i<_.offsets.length;i++){var z=_.offsets[i].offset;O={x:l+z*Math.cos(M)-e/2*Math.sin(M+Math.PI/2),y:n+z*Math.sin(M)-e/2*Math.cos(M+Math.PI/2)},I={x:l+z*Math.cos(M)+e/2*Math.sin(M+Math.PI/2),y:n+z*Math.sin(M)+e/2*Math.cos(M+Math.PI/2)};C.line(this.renderer._ptrnd(O.x),this.renderer._ptrnd(O.y),this.renderer._ptrnd(I.x),this.renderer._ptrnd(I.y),t)}}return E}}_renderAxis(e,t,i,s,r,a,l,n,o,h,d){if(i.customDraw&&!h)return{width:NaN,height:NaN};let u=i.title,g=i.labels,f=i.tickMarks,p=i.padding,c=f.visible?f.size:0,m={width:0,height:0},y={width:0,height:0};e?m.height=y.height=s.height:m.width=y.width=s.width,!h&&t&&e&&(s.x-=s.width);let _=o.renderData,x=_.itemWidth;if(u.visible&&void 0!==u.text&&null!==u.text&&""!==u){let i=u.angle,r=this.renderer.measureText(u.text,i,{class:u.style});y.width=r.width,y.height=r.height,h||this.renderer.text(u.text,s.x+u.offset.x+(e?t?-p.right-2+2*s.width-y.width:2+p.left:0),s.y+u.offset.y+(e?0:t?p.top+2:s.height-2-y.height-p.bottom),e?y.width:s.width,e?s.height:y.height,i,{class:u.style},!0,u.halign,u.valign,u.rotationPoint)}let v=0,b=n?-x/2:0;n&&!e&&(g.halign="center");let N=s.x,M=s.y,A=g.textOffset;A&&(isNaN(A.x)||(N+=A.x),isNaN(A.y)||(M+=A.y)),e?(N+=p.left+2+(y.width>0?y.width+2:0)+(t?s.width-y.width:0),M+=b):(N+=b,t?(M+=y.height>0?y.height+6:4,M+=c-(n?c:c/4)):M+=n?c:c/4,M+=p.top);let w=0,S=0,C=o.items;_.itemOffsets={},!this._isToggleRefresh&&this._isUpdate||(d=0);let k=!1,T=0;for(let i=0;i<C.length&&g.visible;i++,v+=x){if(!C[i]||isNaN(x))continue;let r=C[i].text;isNaN(C[i].targetX)||(v=C[i].targetX);let a=this.renderer.measureText(r,g.angle,{class:g.style});if(a.width>S&&(S=a.width),a.height>w&&(w=a.height),T+=e?w:S,!h){if(e&&v>s.height+2||!e&&v>s.width+2)continue;const r=e?N+(t?0===y.width?c:c-2:0):N+v;let a=e?M+v:M;_.itemOffsets[C[i].key]={x:r,y:a},k||(!isNaN(C[i].x)||!isNaN(C[i].y)&&d)&&(k=!0),C[i].targetX=r,C[i].targetY=a,C[i].width=e?s.width-p.left-p.right-4-c-(y.width>0?y.width+2:0):x,C[i].height=e?x:s.height-p.top-p.bottom-4-c-(y.height>0?y.height+2:0),C[i].visible=!0}}if(_.avgWidth=0===C.length?0:T/C.length,!h){let e={items:C,textSettings:g};if(!isNaN(d)&&k||(d=0),this._animateAxisText(e,0===d?1:0),0!==d){let t=this;this._enqueueAnimation("series",void 0,void 0,d,(function(e,i,s){t._animateAxisText(i,s)}),e)}}if(m.width+=4+c+y.width+S+(e&&y.width>0?2:0),m.height+=4+c+y.height+w+(!e&&y.height>0?2:0),e?m.width+=p.left+p.right:m.height+=p.top+p.bottom,!h&&i.line.visible){let r={stroke:i.line.color||self._getThemeColor("line"),"stroke-width":i.line.width,"stroke-dasharray":i.line.dashStyle||""};if(e){let e=s.x+s.width+(t?p.left:-p.right);e=this.renderer._ptrnd(e),this.renderer.line(e,s.y,e,s.y+s.height,r)}else{let e=this.renderer._ptrnd(s.y+(t?s.height-p.bottom:p.top));this.renderer.line(this.renderer._ptrnd(s.x),e,this.renderer._ptrnd(s.x+s.width+1),e,r)}}return m.width=this.renderer._rup(m.width),m.height=this.renderer._rup(m.height),m}_drawPlotAreaLines(e,t,i){var s=this.seriesGroups[e],r="horizontal"!==s.orientation;if(!this._renderData||this._renderData.length<=e)return;var a=t?"valueAxis":"xAxis",l=this._renderData[e][a];if(!l)return;var n=this._renderData.axisDrawState;n||(n=this._renderData.axisDrawState={});var o,h="";t?(h="valueAxis_"+(s.valueAxis?e:"")+(r?"swap":""),o=this._getValueAxis(e)):(h="xAxis_"+(s.xAxis?e:"")+(r?"swap":""),o=this._getXAxis(e)),n=n[h]?n[h]:n[h]={},t||(r=!r);var d=l.settings;if(!d)return;if(d.customDraw)return;var u=d.gridLines,g=d.tickMarks,f=d.padding,p=l.rect,c=this._plotRect;if(!u||!g)return;var m={};let y={stroke:u.color||self._getThemeColor("line"),"stroke-width":u.width,"stroke-dasharray":u.dashStyle||""};var _=t?p.y+p.height:p.x,x=u.offsets;let v;if(t&&!o.flip&&(x=(x=x.slice(0)).reverse()),x&&x.length>0){var b=NaN;for(let e=0;e<x.length;e++)if(r?(v=this.renderer._ptrnd(p.y+x[e].offset),v<p.y-.5&&(v=this.renderer._ptrnd(p.y)),v>p.y+p.height&&(v=p.y+p.height)):(v=this.renderer._ptrnd(p.x+x[e].offset),v>p.x+p.width+.5&&(v=this.renderer._ptrnd(p.x+p.width))),!isNaN(v)&&(isNaN(b)||!(Math.abs(v-b)<2))){if(b=v,i.gridLines&&!1!==u.visible&&!0!==n.gridLines&&(r?this.renderer.line(this.renderer._ptrnd(c.x),v,this.renderer._ptrnd(c.x+c.width),v,y):this.renderer.line(v,this.renderer._ptrnd(c.y),v,this.renderer._ptrnd(c.y+c.height),y)),m[v]=!0,i.alternatingBackground&&(u.alternatingBackgroundColor||u.alternatingBackgroundColor2)&&!0!==n.alternatingBackground){var N,M=e%2==0?u.alternatingBackgroundColor2:u.alternatingBackgroundColor;if(e>0&&M)N=r?this.renderer.rect(this.renderer._ptrnd(c.x),_,this.renderer._ptrnd(c.width-1),v-_,y):this.renderer.rect(_,this.renderer._ptrnd(c.y),v-_,this.renderer._ptrnd(c.height),y),this.renderer.attr(N,{"stroke-width":0,fill:M,opacity:u.alternatingBackgroundOpacity||1})}_=v}}if(y={stroke:g.color||self._getThemeColor("line"),"stroke-width":g.width,"stroke-dasharray":g.dashStyle||""},i.tickMarks&&g.visible&&!0!==n.tickMarks){var A=g.size;let e=g.offsets;b=NaN;for(let i=0;i<e.length;i++)if(r?(v=this.renderer._ptrnd(p.y+e[i].offset),v<p.y-.5&&(v=this.renderer._ptrnd(p.y)),v>p.y+p.height&&(v=p.y+p.height)):(v=this.renderer._ptrnd(p.x+e[i].offset),v>p.x+p.width+.5&&(v=this.renderer._ptrnd(p.x+p.width))),!isNaN(v)&&(isNaN(b)||!(Math.abs(v-b)<2))){if(m[v-1]?v--:m[v+1]&&v++,r){if(v>p.y+p.height+.5)break}else if(v>p.x+p.width+.5)break;b=v;var w=l.isMirror?A:-A;if(r){var S=p.x+p.width+("right"===o.position?f.left:-f.right);t||(S=p.x+(l.isMirror?f.left:-f.right+p.width)),this.renderer.line(S,v,S+w,v,y)}else{var C=p.y+(l.isMirror?p.height:0);C+=l.isMirror?-f.bottom:f.top,C=this.renderer._ptrnd(C),this.renderer.line(v,C,v,C-w,y)}}}n.tickMarks=n.tickMarks||i.tickMarks,n.gridLines=n.gridLines||i.gridLines,n.alternatingBackground=n.alternatingBackground||i.alternatingBackground}_calcValueAxisItems(e,t,i){let s=this._stats.seriesGroups[e];if(!s||!s.isValid)return!1;let r=this.seriesGroups[e],a=this._getValueAxis(e),l=!1!==a.valuesOnTicks,n=s.intervals,o=t/n,h=s.min,d=s.mu,u=!0===a.logarithmicScale,g=a.logarithmicScaleBase||10,f=-1!==r.type.indexOf("stacked")&&-1!==r.type.indexOf("100");for(u&&(d=isNaN(a.unitInterval)?1:a.unitInterval),l||(n=Math.max(n-1,1));this._renderData.length<e+1;)this._renderData.push({});this._renderData[e].valueAxis={};let p=this._renderData[e].valueAxis;p.itemWidth=p.intervalWidth=o,p.items=[];let c=p.items;for(let e=0;e<=n;e++){let t=0;t=u?f?s.max/Math.pow(g,n-e):h*Math.pow(g,e):l?h+e*d:h+(e+.5)*d,e%i==0?c.push(t):c.push(NaN)}return p.rangeLength=u&&!f?s.intervals:s.intervals*d,!0!==a.flip&&(c=c.reverse()),!0}_getDecimalPlaces(e,t,i){let s=0;isNaN(i)&&(i=10);for(let r=0;r<e.length;r++){let a=void 0===t?e[r]:e[r][t];if(isNaN(a))continue;let l=a.toString();for(let e=0;e<l.length;e++)if((l[e]<"0"||l[e]>"9")&&(s=l.length-(e+1),s>=0))return Math.min(s,i);for(s>0&&(a*=Math.pow(10,s));Math.round(a)!==a&&s<i;)s++,a*=10}return s}_renderValueAxis(e,t,i,s){let r=this.seriesGroups[e],a="horizontal"===r.orientation,l=this._getValueAxis(e);l||this.error(this.localize("missingAxis",{index:e,axis:"valueAxis"}));let n={width:0,height:0};if(!this._isGroupVisible(e)||this._isPieOnlySeries()||"spider"===r.type)return n;let o=!1!==l.valuesOnTicks,h=this._stats.seriesGroups[e],d=h.mu,u=!0===l.logarithmicScale,g=l.logarithmicScaleBase||10;if(u&&(d=isNaN(l.unitInterval)?1:l.unitInterval),0===d&&(d=1),isNaN(d))return n;let f=this._getAxisSettings(l),p=f.title,c=f.labels,m=l.labels||{};this._get([l.horizontalTextAlignment,m.horizontalAlignment])||0!==c.angle||(c.halign=a?"center":"right"===l.position?"left":"right");let y=this._get([c.step,c.unitInterval/d]);if(isNaN(y)&&(y=1),y=Math.max(1,Math.round(y)),!this._calcValueAxisItems(e,a?t.width:t.height,y)||!f.visible)return n;a||(p.angle=this.rightToLeft?90:-90,"centercenter"===p.rotationPoint&&("top"===p.valign?p.rotationPoint="rightcenter":"bottom"===p.valign&&(p.rotationPoint="leftcenter")));let _=this._renderData[e].valueAxis,x=this._getFormatSettings(c);-1!==r.type.indexOf("stacked")&&-1!==r.type.indexOf("100")&&!x&&(x={sufix:"%"}),c.formatFunction||x&&null!==x.decimalPlaces&&void 0!==x.decimalPlaces||(x=x||{},x.decimalPlaces=this._getDecimalPlaces([h.min,h.max,d],void 0,3));let v=f.gridLines,b=a?t.width:t.height,N=!0===l.flip;l.flip=!N;let M={min:h.min,max:h.max,logAxis:{enabled:!0===u,base:g,minPow:h.minPow,maxPow:h.maxPow}};(v.visible||l.alternatingBackgroundColor||l.alternatingBackgroundColor2)&&(v.offsets=this._getOffsets("gridLines",l,b,M,f,{left:0,right:0},o,d));let A=f.tickMarks;A.visible&&(A.offsets=this._getOffsets("tickMarks",l,b,M,f,{left:0,right:0},o,d));const w=this._getOffsets("labels",l,b,M,f,{left:0,right:0},o,d,!o);l.flip=N;let S,C=[];this._elementRenderInfo&&this._elementRenderInfo.length>e&&(S=this._elementRenderInfo[e].valueAxis);for(let e=0;e<w.length;e++){let t=w[e].value;if(isNaN(w[e].offset)){C.push(void 0);continue}let i={key:t,text:c.formatFunction?c.formatFunction(t):isNaN(t)?t:this._formatNumber(t,x)};S&&S.itemOffsets[t]&&(i.x=S.itemOffsets[t].x,i.y=S.itemOffsets[t].y),i.targetX=w[e].offset,isNaN(i.targetX)||C.push(i)}let k=a&&"top"===l.position||!a&&"right"===l.position||!a&&this.rightToLeft&&"left"!==l.position,T={items:C,renderData:_},D=this._getAnimProps(e),F=D.enabled&&C.length<500?D.duration:0;return!1===this.enableAxisTextAnimation&&(F=0),_.settings=f,_.isMirror=k,_.rect=t,this._renderAxis(!a,k,f,t,s,d,u,!0,T,i,F)}_objectsArraysToArray(e,t){let i=[];if(!Array.isArray(e))return i;for(let s=0;s<e.length;s++)i.push(e[s][t]);return i}_arraysToObjectsArray(e,t){let i=[];if(e.length!==t.length)return i;for(let s=0;s<e.length;s++)for(let r=0;r<e[s].length;r++)i.length<=r&&i.push({}),i[r][t[s]]=e[s][r];return i}_valuesToOffsets(e,t,i,s,r,a,l){let n=[];if(!t||!Array.isArray(e))return n;let o=i.logAxis.base,h=i.logAxis.enabled?"logarithmic":"linear",d=t.flip,u=s,g=0,f=0;r&&!isNaN(r.left)&&(g=r.left),r&&!isNaN(r.right)&&(f=r.right),u=s-g-f,s=u;for(let t=0;t<e.length;t++){let r=this._smartPlot.scale(e[t],{min:i.min.valueOf(),max:i.max.valueOf(),type:h,base:o},{min:0,max:a?s:u,flip:d},{});isNaN(r)?n.push(NaN):(isNaN(l)||(r+=l),r<=s+g+f+1?n.push(this.renderer._ptrnd(r)):n.push(NaN))}return n}_generateIntervalValues(e,t,i,s,r){let a=[],l=e.min,n=e.max;if(e.logAxis&&e.logAxis.enabled&&(l=e.logAxis.minPow,n=e.logAxis.maxPow),null==l||null==n)return a;if(l===n)return e.logAxis&&e.logAxis.enabled?[Math.pow(e.logAxis.base,l)]:[l];let o=1;i<1&&(o=1e6,l*=o,n*=o,i*=o);for(let e=l;e<=n;e+=i)a.push(e/o+(r?i/2:0));if(t>i){let e=[],s=Math.round(t/i);for(let t=0;t<a.length;t++)t%s==0&&e.push(a[t]);a=e}if(e.logAxis&&e.logAxis.enabled)for(let t=0;t<a.length;t++)a[t]=Math.pow(e.logAxis.base,a[t]);return a}_generateDTOffsets(e,t,i,s,r,a,l,n,o,h,d){l||(l="day");var u=[];if(e>t)return u;if(e===t)return h?u.push({offset:n?i/2:s.left,value:e}):n&&u.push({offset:i/2,value:e}),u;var g=i-s.left-s.right,f=e,p=s.left,c=p,m=a=Math.max(a,1),y=Math.min(1,a);for(a>1&&"millisecond"!==l&&(a=1);this.renderer._ptrnd(c)<=this.renderer._ptrnd(s.left+g+(n?0:s.right));){u.push({offset:c,value:f});var _=new Date(f.valueOf());if("millisecond"===l)_.setMilliseconds(f.getMilliseconds()+a);else if("second"===l)_.setSeconds(f.getSeconds()+a);else if("minute"===l)_.setMinutes(f.getMinutes()+a);else if("hour"===l){var x=_.valueOf();_.setHours(f.getHours()+a),x===_.valueOf()&&_.setHours(f.getHours()+a+1)}else"day"===l?_.setDate(f.getDate()+a):"month"===l?_.setMonth(f.getMonth()+a):"year"===l&&_.setFullYear(f.getFullYear()+a);c=p+((f=_).valueOf()-e.valueOf())*y/(t.valueOf()-e.valueOf())*g}if(d)for(let e=0;e<u.length;e++)u[e].offset=i-u[e].offset;if(m>1&&"millisecond"!==l){var v=[];for(let e=0;e<u.length;e+=m)v.push({offset:u[e].offset,value:u[e].value});u=v}if(!n&&!h&&u.length>1){(v=[]).push({offset:0,value:void 0});for(let e=1;e<u.length;e++)v.push({offset:u[e-1].offset+(u[e].offset-u[e-1].offset)/2,value:void 0});var b=v.length;b>1?v.push({offset:v[b-1].offset+(v[b-1].offset-v[b-2].offset)}):v.push({offset:i,value:void 0}),u=v}if(r>a){v=[];var N=Math.round(r/m);for(let e=0;e<u.length;e++)e%N==0&&v.push({offset:u[e].offset,value:u[e].value});u=v}return u}_hasStackValueReversal(e,t){let i=this.seriesGroups[e];if(!(-1!==i.type.indexOf("stacked")))return!1;let s=-1!==i.type.indexOf("waterfall"),r=this._getDataLen(e),a=0,l=!1,n=[];for(let t=0;t<i.series.length;t++)n[t]=this._isSerieVisible(e,t);for(let o=0;o<r;o++){let r=void 0;s||(l=!1);for(let s=0;s<i.series.length;s++){if(!n[s])continue;const h=this._getDataValueAsNumber(o,i.series[s].dataField,e);if(isNaN(h))continue;if(i.series[s].summary){if(void 0!==this._getDataValue(o,i.series[s].summary,e))continue}let d=l?h<0:h<t;if(l=!0,void 0===r&&(r=d),d!==r)return!0;r=d,a+=h}}return!1}_getValueAxis(e){let t=null==e?this.valueAxis:this.seriesGroups[e].valueAxis||this.valueAxis;return t||(t=this.valueAxis={}),t}_buildStats(e){var t={seriesGroups:[]};this._stats=t;for(let B=0;B<this.seriesGroups.length;B++){var i=this.seriesGroups[B];t.seriesGroups[B]={};var s=this._getXAxis(B),r=this._getValueAxis(B),a=this._getXAxisStats(B,s,"horizontal"!==i.orientation?e.width:e.height);let H=t.seriesGroups[B];H.isValid=!0;var l="horizontal"===i.orientation?e.width:e.height,n=!0===r.logarithmicScale,o=r.logarithmicScaleBase;isNaN(o)&&(o=10);var h=-1!==i.type.indexOf("stacked"),d=h&&-1!==i.type.indexOf("100"),u=-1!==i.type.indexOf("range"),g=-1!==i.type.indexOf("waterfall");g&&!this._moduleWaterfall&&self.error(self.localize("missingReference",{files:"smart.chart.waterfall.js"})),d&&(H.psums=[],H.nsums=[]);var f=NaN,p=NaN,c=NaN,m=NaN,y=r?r.baselineValue:NaN;isNaN(y)&&(y=n&&!d?1:0);var _=!1;0!==y&&h&&(_=this._hasStackValueReversal(B,y))&&(y=0),h&&g&&(_=this._hasStackValueReversal(B,y));var x=this._getDataLen(B),v=0,b=NaN,N=[];if(g)for(let e=0;e<i.series.length;e++)N.push(NaN);var M=NaN;for(let e=0;e<x&&H.isValid;e++){if(s.rangeSelector&&s.rangeSelector.visible){var A=s.dataField?this._getDataValue(e,s.dataField,B):e;if(A&&a.isDateTime&&(A=this._castAsDate(A,s.dateFormat)),a.useIndeces&&(A=e),A&&(A.valueOf()<a.min.valueOf()||A.valueOf()>a.max.valueOf()))continue}var w=r.minValue,S=r.maxValue;r.baselineValue&&(w=isNaN(w)?y:Math.min(y,w),S=isNaN(S)?y:Math.max(y,S));var C=0,k=0;for(let t=0;i.series&&t<i.series.length;t++)if(this._isSerieVisible(B,t)){var T=NaN,D=NaN,F=NaN;if(-1!==i.type.indexOf("candle")||-1!==i.type.indexOf("ohlc")){var O=["Open","Low","Close","High"];for(var I in O){var P=this._getDataValueAsNumber(e,i.series[t]["dataField"+O[I]],B);isNaN(P)||(F=isNaN(D)?P:Math.min(F,P),D=isNaN(D)?P:Math.max(D,P))}}else if(u){var R=this._getDataValueAsNumber(e,i.series[t].dataFieldFrom,B),L=this._getDataValueAsNumber(e,i.series[t].dataFieldTo,B);D=Math.max(R,L),F=Math.min(R,L)}else{if(T=this._getDataValueAsNumber(e,i.series[t].dataField,B),g){if(this._isSummary(B,e))if(void 0!==this._getDataValue(e,i.series[t].summary,B))continue;h?(isNaN(M)||(T+=M),M=T):(isNaN(N[t])?N[t]=T:T+=N[t],N[t]=T)}if(isNaN(T)||n&&T<=0)continue;F=D=T}(isNaN(S)||D>S)&&(isNaN(r.maxValue)||D<=r.maxValue)&&(S=D),(isNaN(w)||F<w)&&(isNaN(r.minValue)||F>=r.minValue)&&(w=F),isNaN(T)||!h||g||(T>y?C+=T:T<y&&(k+=T))}if(d||(isNaN(r.maxValue)||(C=Math.min(r.maxValue,C)),isNaN(r.minValue)||(k=Math.max(r.minValue,k))),n&&d)for(let t=0;t<i.series.length;t++)if(this._isSerieVisible(B,t)){T=this._getDataValueAsNumber(e,i.series[t].dataField,B);if(isNaN(T)||T<=0)b=.01;else{var G=0===C?0:T/C;(isNaN(b)||G<b)&&(b=G)}}else b=.01;var V=C-k;v<V&&(v=V),d&&(H.psums[e]=C,H.nsums[e]=k),(S>p||isNaN(p))&&(p=S),(w<f||isNaN(f))&&(f=w),(C>c||isNaN(c))&&(c=C),(k<m||isNaN(m))&&(m=k)}d&&(c=0===c?0:Math.max(c,-m),m=0===m?0:Math.min(m,-c)),f===p&&(!isNaN(r.minValue)&&isNaN(r.maxValue)?(f=r.minValue,p=n?f*o:f+1):isNaN(r.minValue)&&!isNaN(r.maxValue)&&(p=r.maxValue,f=n?p/o:p-1)),f===p&&(0===f?(f=-1,p=1):f<0?p=0:n?1===f&&(f/=o,p*=o):f=0);var E={gmin:f,gmax:p,gsumP:c,gsumN:m,gbase:y,isLogAxis:n,logBase:o,minPercent:b,gMaxRange:v,isStacked:h,isStacked100:d,isWaterfall:g,hasStackValueReversal:_,valueAxis:r,valueAxisSize:l};E.isStacked&&(E.gsumN<0&&(E.gmin=Math.min(E.gmin,E.gbase+E.gsumN)),E.gsumP>0&&(E.gmax=Math.max(E.gmax,E.gbase+E.gsumP))),H.context=E}this._mergeCommonValueAxisStats();for(let e=0;e<t.seriesGroups.length;e++){let i=t.seriesGroups[e];if(i.isValid){var B=this._calcOutputGroupStats(i.context);for(let e in B)i[e]=B[e];delete i.context}}}_mergeCommonValueAxisStats(){let e={};for(let t=0;t<this.seriesGroups.length;t++){if(!this._isGroupVisible(t))continue;if(this.seriesGroups[t].valueAxis)continue;let i=this._stats.seriesGroups[t].context;e.gbase=i.gbase,(isNaN(e.gmin)||i.gmin<e.gmin)&&(e.gmin=i.gmin),(isNaN(e.gmax)||i.gmax>e.gmax)&&(e.gmax=i.gmax),(isNaN(e.gsumP)||i.gsumP>e.gsumP)&&(e.gsumP=i.gsumP),(isNaN(e.gsumN)||i.gsumN<e.gsumN)&&(e.gsumN=i.gsumN),(isNaN(e.logBase)||i.logBase<e.logBase)&&(e.logBase=i.logBase),(isNaN(e.minPercent)||i.minPercent<e.minPercent)&&(e.minPercent=i.minPercent),e.gsumN>0&&(e.gmin=Math.min(e.gmin,e.gbase+e.gsumN)),e.gsumP>0&&(e.gmax=Math.max(e.gmax,e.gbase+e.gsumP))}for(let t=0;t<this.seriesGroups.length;t++){if(this.seriesGroups[t].valueAxis)continue;let i=this._stats.seriesGroups[t].context;for(let t in e)i[t]=e[t]}}_calcOutputGroupStats(e){let t=e.gmin,i=e.gmax,s=e.gsumP,r=e.gsumN,a=e.gbase,l=e.isLogAxis,n=e.logBase,o=e.minPercent,h=e.gMaxRange,d=e.isStacked,u=e.isStacked100,g=e.isWaterfall,f=e.hasStackValueReversal,p=e.valueAxis,c=e.valueAxisSize,m=e.valueAxis.unitInterval;m||(m=this._calcInterval(t,i,Math.max(c/80,2))),t===i&&(t=a,i*=2);let y=NaN,_=0,x=0;if(l){if(u){y=0;let e=1;for(_=x=this._draw.log(100,n);e>o;)e/=n,_--,y++;t=Math.pow(n,_)}else d&&!g&&(i=Math.max(i,s)),x=this.renderer._rnd(this._draw.log(i,n),1,!0),i=Math.pow(n,x),_=this.renderer._rnd(this._draw.log(t,n),1,!1),t=Math.pow(n,_);m=n}t<r&&(r=t),i>s&&(s=i);let v=t,b=i;if(l||0!=Math.abs(b-v)%m&&(v=this.renderer._rnd(t,m,!1),b=this.renderer._rnd(i,m,!0)),u&&b>100&&(b=100),u&&!l&&(b=b>0?100:0,v=v<0?-100:0,m=p.unitInterval,(isNaN(m)||m<=0||m>=100)&&(m=10),100%m!=0))for(;m>=1&&100%m!=0;m--);return isNaN(b)||isNaN(v)||isNaN(m)?{}:(isNaN(y)&&(y=parseInt(((b-v)/(0===m?1:m)).toFixed())),l&&!u&&(y=x-_,h=Math.pow(n,y)),y<1?{}:{min:v,max:b,logarithmic:l,logBase:n,base:l?v:a,minPow:_,maxPow:x,sumP:s,sumN:r,mu:m,maxRange:h,intervals:y,hasStackValueReversal:f})}_getDataLen(e){let t=this.dataSource;return null!=e&&-1!==e&&this.seriesGroups[e].dataSource&&(t=this.seriesGroups[e].dataSource),t?t.length:0}_getDataValue(e,t,i){let s=this.dataSource;if(null!=i&&-1!==i&&(s=this.seriesGroups[i].dataSource||s),!(!s||e<0||e>s.length-1))return"function"==typeof t?t(e,s):t&&""!==t?s[e][t]:s[e]}_getDataValueAsNumber(e,t,i){let s=this._getDataValue(e,t,i);return this._isDate(s)?s.valueOf():("number"!=typeof s&&(s=parseFloat(s)),"number"!=typeof s&&(s=void 0),s)}_isPieGroup(e){let t=this.seriesGroups[e];return!(!t||!t.type)&&(-1!==t.type.indexOf("pie")||-1!==t.type.indexOf("donut"))}_renderPieSeries(e,t){let i=this._getDataLen(e),s=this.seriesGroups[e],r=this._calcGroupOffsets(e,t).offsets;for(let a=0;a<s.series.length;a++){let l=s.series[a];if(l.customDraw)continue;let n=this._getSerieSettings(e,a),o=this._getAnimProps(e,a),h=o.enabled&&i<5e3&&!this._isToggleRefresh&&o.duration;this._isTouchDevice&&this.renderer instanceof Smart.Utilities.HTML5Renderer&&(h=0);let d=this._get([l.minAngle,l.startAngle]);(isNaN(d)||d<0||d>360)&&(d=0);let u=this._get([l.maxAngle,l.endAngle]);(isNaN(u)||u<0||u>360)&&(u=360);let g={rect:t,minAngle:d,maxAngle:u,groupIndex:e,serieIndex:a,settings:n,items:[]};for(let t=0;t<i;t++){let i=r[a][t];if(!i.visible)continue;let s=i.fromAngle,l=i.toAngle,n=this.renderer.pieslice(i.x,i.y,i.innerRadius,i.outerRadius,s,0===h?l:s,i.centerOffset);this._setRenderInfo(e,a,t,{element:n});let o={displayValue:i.displayValue,itemIndex:t,visible:i.visible,x:i.x,y:i.y,innerRadius:i.innerRadius,outerRadius:i.outerRadius,fromAngle:s,toAngle:l,centerOffset:i.centerOffset};g.items.push(o)}this._animatePieSlices(g,0);let f=this;this._enqueueAnimation("series",void 0,void 0,h,(function(e,t,i){f._animatePieSlices(t,i)}),g)}}_sliceSortFunction(e,t){return e.fromAngle-t.fromAngle}_animatePieSlices(e,t){var i;this._elementRenderInfo&&this._elementRenderInfo.length>e.groupIndex&&this._elementRenderInfo[e.groupIndex].series&&this._elementRenderInfo[e.groupIndex].series.length>e.serieIndex&&(i=this._elementRenderInfo[e.groupIndex].series[e.serieIndex]);var s=this._getLabelsSettings(e.groupIndex,e.serieIndex,NaN),r=s.visible,a=[];for(let s=0;s<e.items.length;s++){const r=e.items[s];if(!r.visible)continue;let h=r.fromAngle;var l=r.fromAngle+t*(r.toAngle-r.fromAngle);if(i&&i[r.displayValue]){var n=i[r.displayValue].fromAngle,o=i[r.displayValue].toAngle;h=n+(h-n)*t,l=o+(l-o)*t}a.push({index:s,from:h,to:l})}i&&a.sort(this._sliceSortFunction);var h=NaN;for(let n=0;n<a.length;n++){const o=e.items[a[n].index];var d=this._getRenderInfo(e.groupIndex,e.serieIndex,o.itemIndex);let p=a[n].from;l=a[n].to;i&&(!isNaN(h)&&p>h&&(p=h),h=l,n===a.length-1&&l!==a[0].from&&(l=e.maxAngle+a[0].from));var u=this.renderer.pieSlicePath(o.x,o.y,o.innerRadius,o.outerRadius,p,l,o.centerOffset);this.renderer.attr(d.element,{d:u});var g=this._getColors(e.groupIndex,e.serieIndex,o.itemIndex,"radialGradient",o.outerRadius),f=e.settings;d.colors=g,d.settings=f,this.renderer.attr(d.element,{fill:g.fillColor,stroke:g.lineColor,"stroke-width":f.stroke,"fill-opacity":f.opacity,"stroke-opacity":f.opacity,"stroke-dasharray":"none"}),r&&this._showPieLabel(e.groupIndex,e.serieIndex,o.itemIndex,s,void 0,d.colors.lineColor),1===t&&this._installHandlers(d.element,"pieslice",e.groupIndex,e.serieIndex,o.itemIndex)}}_showPieLabel(e,t,i,s,r){let a=this._renderData[e].offsets[t][i];if(a.elementInfo.labelElement&&this.renderer.removeElement(a.elementInfo.labelElement),s||(s=this._getLabelsSettings(e,t,NaN)),!s.visible)return;let l=a.fromAngle,n=a.toAngle,o=Math.abs(l-n);o>360&&(l=0,n=360);let h=o/2+l;h%=360;let d,u=h*Math.PI*2/360;!0===s.autoRotate&&(d=h<90||h>270?360-h:180-h);let g=s.linesEnabled,f=this._showLabel(e,t,i,{x:0,y:0,width:0,height:0},"center","center",!0,!1,!1,d),p=s.radius||a.outerRadius+Math.max(f.width,f.height);this._isPercent(p)&&(p=parseFloat(p)/100*Math.min(this._plotRect.width,this._plotRect.height)/2),p+=a.centerOffset,isNaN(r)&&(r=0),p+=r;let c=this.seriesGroups[e],m=c.series[t],y=this._draw.getNum([m.offsetX,c.offsetX,this._plotRect.width/2]),_=this._draw.getNum([m.offsetY,c.offsetY,this._plotRect.height/2]),x=this._plotRect.x+y,v=this._plotRect.y+_,b=this._adjustTextBoxPosition(x,v,f,p,h,a.outerRadius>p,!1!==s.linesAngles,!0===s.autoRotate);const N={},M=b.x<x?0:f.width/2,A=Math.sqrt(Math.pow(b.x-x,2)+Math.pow(b.y-v,2))+M<a.outerRadius?arguments[5]:void 0;if(a.elementInfo.labelElement=this._showLabel(e,t,i,{x:b.x,y:b.y,width:f.width,height:f.height},"left","top",!1,!1,!1,d,N,A),p>a.outerRadius+r+5&&!1!==g){let e={lineColor:a.elementInfo.colors.lineColor,stroke:a.elementInfo.settings.stroke,opacity:a.elementInfo.settings.opacity,dashStyle:a.elementInfo.settings.dashStyle};a.elementInfo.labelArrowPath=this._updateLebelArrowPath(a.elementInfo.labelArrowPath,x,v,p,a.outerRadius+r,u,!1!==s.linesAngles,e,N)}}_updateLebelArrowPath(e,t,i,s,r,a,l,n,o){const h=this.renderer;let d=h._ptrnd(t+(s-0)*Math.cos(a)),u=h._ptrnd(i-(s-0)*Math.sin(a)),g=h._ptrnd(t+(r+2)*Math.cos(a)),f=h._ptrnd(i-(r+2)*Math.sin(a)),p=[];p.push({x:o.x+o.width/2,y:o.y}),p.push({x:o.x+o.width/2,y:o.y+o.height}),p.push({x:o.x,y:o.y+o.height/2}),p.push({x:o.x+o.width,y:o.y+o.height/2}),l||(p.push({x:o.x,y:o.y}),p.push({x:o.x+o.width,y:o.y}),p.push({x:o.x+o.width,y:o.y+o.height}),p.push({x:o.x,y:o.y+o.height})),p=p.sort((function(e,s){return h._ptdist(e.x,e.y,t,i)-h._ptdist(s.x,s.y,t,i)})),p=p.sort((function(e,s){return Math.abs(e.x-t)+Math.abs(e.y-i)-(Math.abs(s.x-t)+Math.abs(s.y-i))}));for(let e=0;e<p.length;e++)p[e].x=h._ptrnd(p[e].x),p[e].y=h._ptrnd(p[e].y);d=p[0].x,u=p[0].y;let c="M "+d+","+u+" L"+g+","+f;return l&&(c="M "+d+","+u+" L"+g+","+u+" L"+g+","+f),e?h.attr(e,{d:c}):e=h.path(c,{}),h.attr(e,{fill:"none",stroke:n.lineColor,"stroke-width":n.stroke,"stroke-opacity":n.opacity,"stroke-dasharray":"none"}),e}_adjustTextBoxPosition(e,t,i,s,r,a,l,n){let o=r*Math.PI*2/360,h=this.renderer._ptrnd(e+s*Math.cos(o)),d=this.renderer._ptrnd(t-s*Math.sin(o));if(n){let r=i.width,a=i.height,l=Math.atan(a/r)%(2*Math.PI),n=o%(2*Math.PI),h=0;n<=l?h=r/2*Math.cos(o):n>=l&&n<Math.PI-l?h=a/2*Math.sin(o):n>=Math.PI-l&&n<Math.PI+l?h=r/2*Math.cos(o):n>=Math.PI+l&&n<2*Math.PI-l?h=a/2*Math.sin(o):n>=2*Math.PI-l&&n<2*Math.PI&&(h=r/2*Math.cos(o)),s+=Math.abs(h)+3;let d=this.renderer._ptrnd(e+s*Math.cos(o)),u=this.renderer._ptrnd(t-s*Math.sin(o));return d-=i.width/2,u-=i.height/2,{x:d,y:u}}return a?(h-=i.width/2,d-=i.height/2):l?r>=90&&r<270?(d-=i.height/2,h-=i.width):d-=i.height/2:r>=0&&r<45||r>=315&&r<360?d-=i.height/2:r>=45&&r<135?(d-=i.height,h-=i.width/2):r>=135&&r<225?(d-=i.height/2,h-=i.width):r>=225&&r<315&&(h-=i.width/2),{x:h,y:d}}_isColumnType(e){return-1!==e.indexOf("column")||-1!==e.indexOf("waterfall")}_getColumnGroupsCount(e){let t=0;e=e||"vertical";let i=this.seriesGroups;for(let s=0;s<i.length;s++){let r=i[s].orientation||"vertical";this._isColumnType(i[s].type)&&r===e&&t++}return this.columnSeriesOverlap&&(t=1),t}_getColumnGroupIndex(e){let t=0,i=this.seriesGroups[e].orientation||"vertical";for(let s=0;s<e;s++){let e=this.seriesGroups[s],r=e.orientation||"vertical";this._isColumnType(e.type)&&r===i&&t++}return t}_renderAxisBands(e,t,i){var s=i?this._getXAxis(e):this._getValueAxis(e),r=this.seriesGroups[e],a=i?void 0:r.bands;if(!a){for(let t=0;t<e;t++){if((i?this._getXAxis(t):this._getValueAxis(t))===s)return}a=s.bands}if(Array.isArray(a)){var l=t,n="horizontal"===r.orientation;n&&(l={x:t.y,y:t.x,width:t.height,height:t.width}),this._calcGroupOffsets(e,l);for(let s=0;s<a.length;s++){var o=a[s],h=o.minValue,d=o.maxValue,u=i?this.getXAxisDataPointOffset(h,e):this.getValueAxisDataPointOffset(h,e),g=i?this.getXAxisDataPointOffset(d,e):this.getValueAxisDataPointOffset(d,e);if(!isNaN(u)&&!isNaN(g)){var f,p=Math.abs(u-g);if(r.polar||r.spider){var c=this._renderData[e],m=c.polarCoords;if(i)if(r.spider){const t=this.getPolarDataPointOffset(h,this._stats.seriesGroups[e].max,e),i=this.getPolarDataPointOffset(d,this._stats.seriesGroups[e].max,e);let s="M "+m.x+","+m.y;s+=" L "+t.x+","+t.y,s+=" L "+i.x+","+i.y,f=this.renderer.path(s)}else{var y={},_={x:Math.min(u,g),y:t.y,width:p,height:t.height};this._columnAsPieSlice(y,t,m,_),f=y.element}else{var x=this._toPolarCoord(m,t,t.x,c.baseOffset),v=this._toPolarCoord(m,t,t.x,u),b=this._toPolarCoord(m,t,t.x,g),N=this.renderer._ptdist(x.x,x.y,v.x,v.y),M=this.renderer._ptdist(x.x,x.y,b.x,b.y),A=Math.round(360*-m.startAngle/(2*Math.PI)),w=Math.round(360*-m.endAngle/(2*Math.PI));if(A>w){const e=A;A=w,w=e}if(r.spider){var S=c.xAxis.offsetAngles;let e="";var C=[M,N],k=S;for(var T in m.isClosedCircle&&(k=S.slice(0)).push(k[0]),C){for(let t=0;t<k.length;t++){var D=0===T?t:S.length-t-1,F=m.x+C[T]*Math.cos(k[D]),O=m.y+C[T]*Math.sin(k[D]);e+=""===e?"M ":" L",e+=this.renderer._ptrnd(F)+","+this.renderer._ptrnd(O)}if(0===T){F=m.x+C[1]*Math.cos(k[D]),O=m.y+C[1]*Math.sin(k[D]);e+=" L"+this.renderer._ptrnd(F)+","+this.renderer._ptrnd(O)}}e+=" Z",f=this.renderer.path(e)}else f=this.renderer.pieslice(m.x,m.y,N,M,A,w)}}else{var I={x:Math.min(u,g),y:l.y,width:p,height:l.height};if(i||(I={x:l.x,y:Math.min(u,g),width:l.width,height:p}),n){let e=I.x;I.x=I.y,I.y=e,e=I.width,I.width=I.height,I.height=e}f=0===p||1===p?this.renderer.line(this.renderer._ptrnd(I.x),this.renderer._ptrnd(I.y),this.renderer._ptrnd(I.x+(n?0:I.width)),this.renderer._ptrnd(I.y+(n?I.height:0))):this.renderer.rect(I.x,I.y,I.width,I.height)}var P=o.color||this._getThemeColor("band"),R=o.lineColor||P,L=o.lineWidth;isNaN(L)&&(L=1);var G=o.opacity;(isNaN(G)||G<0||G>1)&&(G=1),this.renderer.attr(f,{fill:P,"fill-opacity":G,stroke:R,"stroke-opacity":G,"stroke-width":L,"stroke-dasharray":o.dashStyle})}}}}_getColumnGroupWidth(e,t,i){let s=this.seriesGroups[e],r=-1!==s.type.indexOf("stacked"),a=this._getColumnGroupsCount(s.orientation);(isNaN(a)||0===a)&&(a=1);let l=t.rangeLength>=1?t.itemWidth:.9*i,n=s.columnsMinWidth;isNaN(n)&&(n=1),isNaN(s.columnsMaxWidth)||(n=Math.min(s.columnsMaxWidth,n)),n>l&&t.length>0&&(l=Math.max(l,.9*i/t.length));let o=n;if(!r){let e=s.seriesGapPercent;(isNaN(e)||e<0)&&(e=10),e/=100;let t=n;t*=1+e,o+=s.series.length*t}return{requiredWidth:o,availableWidth:l,targetWidth:Math.max(l/a,o)}}_getColumnSerieWidthAndOffset(e,t){let i=this.seriesGroups[e],s="horizontal"===i.orientation,r=this._plotRect;s&&(r={x:r.y,y:r.x,width:r.height,height:r.width});let a=this._calcGroupOffsets(e,r);if(!a||0===a.xoffsets.length)return;let l=this._getColumnGroupsCount(i.orientation);"candlestick"!==i.type&&"ohlc"!==i.type||(l=1);let n=this._getColumnGroupIndex(e),o=this._getColumnGroupWidth(e,a.xoffsets,s?r.height:r.width),h=0,d=o.targetWidth;(!0===this.columnSeriesOverlap||Math.round(d)>Math.round(o.availableWidth/l))&&(l=1,n=0),h-=d*l/2,h+=d*n;let u=i.columnsGapPercent;u<=0&&(u=0),(isNaN(u)||u>=100)&&(u=25),u/=100;let g=d*u;g+o.requiredWidth>o.targetWidth&&(g=Math.max(0,o.targetWidth-o.requiredWidth)),Math.round(d)>Math.round(o.availableWidth)&&(g=0),d-=g,h+=g/2;let f=i.seriesGapPercent;(isNaN(f)||f<0)&&(f=10);let p=-1!==i.type.indexOf("stacked"),c=d;p||(c/=i.series.length);let m=this._get([i.seriesGap,d*f/100/(i.series.length-1)]);(!0===i.polar||!0===i.spider||p||i.series.length<=1)&&(m=0);let y=m*(i.series.length-1);i.series.length>1&&y>d-1*i.series.length&&(y=d-1*i.series.length,m=y/Math.max(1,i.series.length-1));let _=c-y/i.series.length,x=0,v=i.columnsMaxWidth;isNaN(v)||_>v&&(x=_-v,_=v);let b=0;if(p)b=x/2;else{b=(d-_*i.series.length-y)/2+_*t+Math.max(0,t)*m}return{width:_,offset:h+b}}_renderColumnSeries(e,t){let i=this.seriesGroups[e];if(!i.series||0===i.series.length)return;let s="horizontal"===i.orientation,r=t;s&&(r={x:t.y,y:t.x,width:t.height,height:t.width});let a,l=this._calcGroupOffsets(e,r);if(!l||0===l.xoffsets.length)return;!0!==i.polar&&!0!==i.spider||(a=this._getPolarAxisCoords(e,r));let n={groupIndex:e,rect:t,vertical:!s,seriesCtx:[],renderData:l,polarAxisCoords:a};n.columnGroupWidth=this._getColumnGroupWidth(e,l.xoffsets,s?r.height:r.width);let o,h=this._getGroupGradientType(e);for(let t=0;t<i.series.length;t++){let s=i.series[t];if(s.customDraw)continue;let r=this._getAnimProps(e,t);o=r.enabled&&!this._isToggleRefresh&&l.xoffsets.length<100?r.duration:0;let d=this._getColumnSerieWidthAndOffset(e,t),u=this._isSerieVisible(e,t),g=this._getSerieSettings(e,t),f=this._getColors(e,t,NaN,this._getGroupGradientType(e),4),p=[];if("function"==typeof s.colorFunction&&!a)for(let i=l.xoffsets.first;i<=l.xoffsets.last;i++)p.push(this._getColors(e,t,i,h,4));let c={seriesIndex:t,serieColors:f,itemsColors:p,settings:g,columnWidth:d.width,xAdjust:d.offset,isVisible:u};n.seriesCtx.push(c)}this._animColumns(n,0===o?1:0);let d=this;this._enqueueAnimation("series",void 0,void 0,o,(function(e,t,i){d._animColumns(t,i)}),n)}_getPercent(e,t,i,s){return isNaN(e)&&(e=t),!isNaN(i)&&!isNaN(e)&&e<i&&(e=i),!isNaN(s)&&!isNaN(e)&&e>s&&(e=s),isNaN(e)?NaN:e}_getColumnVOffsets(e,t,i,s,r,a){var l=this.seriesGroups[t],n=this._getPercent(l.columnsTopWidthPercent,100,0,100),o=this._getPercent(l.columnsBottomWidthPercent,100,0,100);0===n&&0===o&&(o=100);var h=this._getPercent(l.columnsNeckHeightPercent,NaN,0,100)/100,d=this._getPercent(l.columnsNeckWidthPercent,100,0,100)/100,u=[],g=NaN;for(let l=0;l<i.length;l++){var f,p=(k=i[l]).seriesIndex,c=e.offsets[p][s].from,m=e.offsets[p][s].to,y=e.xoffsets.data[s],_=k.isVisible;_||(m=c);var x=this._elementRenderInfo;if(_&&x&&x.length>t&&x[t].series.length>p){var v=e.xoffsets.xvalues[s];!(f=x[t].series[p][v])||isNaN(f.from)||isNaN(f.to)||(c=f.from+(c-f.from)*a,m=f.to+(m-f.to)*a,y=f.xoffset+(y-f.xoffset)*a)}f||(m=c+(m-c)*(r?1:a)),isNaN(c)&&(c=isNaN(g)?e.baseOffset:g),g=!isNaN(m)&&r?m:c,isNaN(m)&&(m=c);var b={from:c,to:m,xOffset:y};100===n&&100===o||(b.funnel=!0,b.toWidthPercent=n,b.fromWidthPercent=o),u.push(b)}if(r&&u.length>1&&!(this._elementRenderInfo&&this._elementRenderInfo.length>t)){var N=0,M=0,A=-1/0,w=1/0,S=1/0,C=-1/0;for(let e=0;e<u.length;e++){var k;(k=i[e]).isVisible&&(u[e].to>=u[e].from?(M+=u[e].to-u[e].from,S=Math.min(S,u[e].from),C=Math.max(C,u[e].to)):(N+=u[e].from-u[e].to,A=Math.max(A,u[e].from),w=Math.min(w,u[e].to)))}var T=N,D=M;N*=a,M*=a;var F=0,O=0;for(let e=0;e<u.length;e++)if(u[e].to>=u[e].from){let t=u[e].to-u[e].from;t+O>M&&(t=Math.max(0,M-O),u[e].to=u[e].from+t),100===n&&100===o||(u[e].funnel=!0,!isNaN(h)&&D*h>=O?u[e].fromWidthPercent=100*d:u[e].fromWidthPercent=Math.abs(u[e].from-S)/D*(n-o)+o,!isNaN(h)&&D*h>=0+(O+t)?u[e].toWidthPercent=100*d:u[e].toWidthPercent=Math.abs(u[e].to-S)/D*(n-o)+o),O+=t}else{let t=u[e].from-u[e].to;t+F>N&&(t=Math.max(0,N-F),u[e].to=u[e].from-t),100===n&&100===o||(u[e].funnel=!0,!isNaN(h)&&T*h>=F?u[e].fromWidthPercent=100*d:u[e].fromWidthPercent=Math.abs(u[e].from-A)/T*(n-o)+o,!isNaN(h)&&T*h>=0+(F+t)?u[e].toWidthPercent=100*d:u[e].toWidthPercent=Math.abs(u[e].to-A)/T*(n-o)+o),F+=t}}return u}_columnAsPieSlice(e,t,i,s){let r=this._toPolarCoord(i,t,s.x,s.y),a=this._toPolarCoord(i,t,s.x,s.y+s.height),l=this.renderer._ptdist(i.x,i.y,a.x,a.y),n=this.renderer._ptdist(i.x,i.y,r.x,r.y),o=t.width,h=180*Math.abs(i.startAngle-i.endAngle)/Math.PI,d=-(s.x-t.x)*h/o,u=-(s.x+s.width-t.x)*h/o,g=i.startAngle;if(g=360*g/(2*Math.PI),d-=g,u-=g,e)if(void 0!==e.element&&null!==e.element){let t=this.renderer.pieSlicePath(i.x,i.y,l,n,u,d,0);t+=" Z",this.renderer.attr(e.element,{d:t})}else e.element=this.renderer.pieslice(i.x,i.y,l,n,u,d,0);return{fromAngle:u,toAngle:d,innerRadius:l,outerRadius:n}}_setRenderInfo(e,t,i,s){this._renderData[e].offsets[t][i].elementInfo=s}_getRenderInfo(e,t,i){return this._renderData[e].offsets[t][i].elementInfo||{}}_animColumns(e,t){var i=e.groupIndex,s=this.seriesGroups[i],r=e.renderData,a=-1!==s.type.indexOf("waterfall"),l=this._getXAxis(i),n=-1!==s.type.indexOf("stacked"),o=e.polarAxisCoords,h=-1;for(let e=0;e<s.series.length;e++)if(this._isSerieVisible(i,e)){h=e;break}var d=NaN,u=NaN;for(let t=0;t<e.seriesCtx.length;t++){var g=e.seriesCtx[t];(isNaN(d)||d>g.xAdjust)&&(d=g.xAdjust),(isNaN(u)||u<g.xAdjust+g.columnWidth)&&(u=g.xAdjust+g.columnWidth)}var f=Math.abs(u-d),p=this._get([s.columnsGapPercent,25])/100;(isNaN(p)<0||p>=1)&&(p=.25);var c=p*f,m=e.renderData.xoffsets,y=-1,_={},x=!0===s.skipOverlappingPoints;for(let d=m.first;d<=m.last;d++){var v=m.data[d];if(!isNaN(v)&&!(-1!==y&&Math.abs(v-y)<f-1+c&&x)){y=v;var b=this._getColumnVOffsets(r,i,e.seriesCtx,d,n,t),N=!1;if(a)for(let e=0;e<s.series.length;e++)s.series[e].summary&&m.xvalues[d][s.series[e].summary]&&(N=!0);for(let u=0;u<e.seriesCtx.length;u++){var M=(g=e.seriesCtx[u]).seriesIndex,A=s.series[M],w=b[u].from,S=b[u].to,C=b[u].xOffset,k=(e.vertical?e.rect.x:e.rect.y)+g.xAdjust,T=g.settings;let f=0!==g.itemsColors.length?g.itemsColors[d-r.xoffsets.first]:g.serieColors;var D=this._isSerieVisible(i,M);if(D){var F={x:v=this.renderer._ptrnd(k+C),width:g.columnWidth};b[u].funnel&&(F.fromWidthPercent=b[u].fromWidthPercent,F.toWidthPercent=b[u].toWidthPercent);var O=!0;e.vertical?(F.y=w,F.height=S-w,F.height<0&&(F.y+=F.height,F.height=-F.height,O=!1)):(F.x=w<S?w:S,F.width=Math.abs(w-S),O=w-S<0,F.y=v,F.height=g.columnWidth);var I=w-S;if(!isNaN(I)){I=Math.abs(I);var P=void 0,R=this._getRenderInfo(i,M,d),L=R.element,G=R.labelElement,V=null==L;if(G&&(this.renderer.removeElement(G),G=void 0),o){var E={element:L};P=this._columnAsPieSlice(E,e.rect,o,F),L=E.element,f=this._getColors(i,M,void 0,"radialGradient",P.outerRadius)}else if(b[u].funnel){var B=this._getTrapezoidPath(Object.assign({},F),e.vertical,O);V?L=this.renderer.path(B,{}):this.renderer.attr(L,{d:B})}else V?L=this.renderer.rect(F.x,F.y,e.vertical?F.width:0,e.vertical?0:F.height):!0===e.vertical?this.renderer.attr(L,{x:F.x,y:F.y,height:I}):this.renderer.attr(L,{x:F.x,y:F.y,width:I});if(I<1&&(1!==t||o)?this.renderer.attr(L,{display:"none"}):this.renderer.attr(L,{display:"block"}),V&&this.renderer.attr(L,{fill:f.fillColor,"fill-opacity":T.opacity,"stroke-opacity":T.opacity,stroke:f.lineColor,"stroke-width":T.stroke,"stroke-dasharray":T.dashStyle}),G&&this.renderer.removeElement(G),!D||0===I&&t<1)R={element:L,labelElement:G},this._setRenderInfo(i,M,d,R);else{if(a&&!1!==this._get([A.showWaterfallLines,s.showWaterfallLines])){if(!n||n&&u===h){var H=n?-1:u;if(1===t&&!isNaN(r.offsets[u][d].from)&&!isNaN(r.offsets[u][d].to)){var z=_[H];if(null!=z){var W={x:z.x,y:this.renderer._ptrnd(z.y)},j={x:v,y:W.y},X=s.columnsTopWidthPercent/100;(isNaN(X)||X>1||X<0)&&(X=1);var U=s.columnsBottomWidthPercent/100;(isNaN(U)||U>1||U<0)&&(U=1);var Y=e.vertical?F.width:F.height;if(W.x=W.x-Y/2+Y/2*X,N){let e=Y*X/2;j.x=j.x+Y/2-(l.flip?-e:e)}else{let e=Y*U/2;j.x=j.x+Y/2-(l.flip?-e:e)}e.vertical||(this._swapXY([W]),this._swapXY([j])),this.renderer.line(W.x,W.y,j.x,j.y,{stroke:z.color,"stroke-width":T.stroke,"stroke-opacity":T.opacity,"fill-opacity":T.opacity,"stroke-dasharray":T.dashStyle})}}}1===t&&0!==I&&(_[n?-1:u]={y:S,x:e.vertical?F.x+F.width:F.y+F.height,color:f.lineColor})}if(o){Y=this._showLabel(i,M,d,F,void 0,void 0,!0);var q=P.outerRadius+10;const e=this._adjustTextBoxPosition(o.x,o.y,Y,q,(P.fromAngle+P.toAngle)/2,!0,!1,!1);G=this._showLabel(i,M,d,{x:e.x,y:e.y},void 0,void 0,!1,!1,!1)}else G=this._showLabel(i,M,d,F,void 0,void 0,!1,!1,O);R={element:L,labelElement:G},this._setRenderInfo(i,M,d,R),1===t&&this._installHandlers(L,"column",i,M,d)}}}}}}}_getTrapezoidPath(e,t,i){let s="",r=e.fromWidthPercent/100,a=e.toWidthPercent/100;if(!t){let t=e.width;e.width=e.height,e.height=t,t=e.x,e.x=e.y,e.y=t}let l=e.x+e.width/2,n=[{x:l-e.width*(i?a:r)/2,y:e.y+e.height},{x:l-e.width*(i?r:a)/2,y:e.y},{x:l+e.width*(i?r:a)/2,y:e.y},{x:l+e.width*(i?a:r)/2,y:e.y+e.height}];t||this._swapXY(n),s+="M "+this.renderer._ptrnd(n[0].x)+","+this.renderer._ptrnd(n[0].y);for(let e=1;e<n.length;e++)s+=" L "+this.renderer._ptrnd(n[e].x)+","+this.renderer._ptrnd(n[e].y);return s+=" Z",s}_swapXY(e){for(let t=0;t<e.length;t++){let i=e[t].x;e[t].x=e[t].y,e[t].y=i}}_renderCandleStickSeries(e,t,i){let s=this,r=s.seriesGroups[e];if(!r.series||0===r.series.length)return;let a="horizontal"===r.orientation,l=t;a&&(l={x:t.y,y:t.x,width:t.height,height:t.width});let n,o=s._calcGroupOffsets(e,l);if(!o||0===o.xoffsets.length)return;(r.polar||r.spider)&&(n=s._getPolarAxisCoords(e,l));let h=s._getGroupGradientType(e),d=[];for(let t=0;t<r.series.length;t++)d[t]=s._getColumnSerieWidthAndOffset(e,t);for(let l=0;l<r.series.length;l++){if(!this._isSerieVisible(e,l))continue;let u=s._getSerieSettings(e,l),g=r.series[l];if(g.customDraw)continue;let f="function"==typeof g.colorFunction?void 0:s._getColors(e,l,NaN,h),p={rect:t,inverse:a,groupIndex:e,seriesIndex:l,symbolType:g.symbolType,symbolSize:g.symbolSize,"fill-opacity":u.opacity,"stroke-opacity":u.opacity,"stroke-width":u.stroke,"stroke-dasharray":u.dashStyle,gradientType:h,colors:f,renderData:o,polarAxisCoords:n,columnsInfo:d,isOHLC:i,items:[],self:s},c=s._getAnimProps(e,l),m=c.enabled&&!s._isToggleRefresh&&o.xoffsets.length<5e3?c.duration:0;s._animCandleStick(p,0),s._enqueueAnimation("series",void 0,void 0,m,(function(e,t,i){s._animCandleStick(t,i)}),p)}}_animCandleStick(e,t){var i=["Open","Low","Close","High"],s=e.columnsInfo[e.seriesIndex].width,r=e.self.seriesGroups[e.groupIndex],a=e.renderData.xoffsets,l=-1,n=Math.abs(a.data[a.last]-a.data[a.first]);n*=t;var o=NaN,h=NaN;for(let t=0;t<e.columnsInfo.length;t++){var d=e.columnsInfo[t];(isNaN(o)||o>d.offset)&&(o=d.offset),(isNaN(h)||h<d.offset+d.width)&&(h=d.offset+d.width)}var u=Math.abs(h-o),g=!1!==r.skipOverlappingPoints;for(let o=a.first;o<=a.last;o++){var f=a.data[o];if(!isNaN(f)&&!(-1!==l&&Math.abs(f-l)<u&&g)){if(Math.abs(a.data[o]-a.data[a.first])>n)break;l=f;var p=e.items[o]=e.items[o]||{};for(let t in i){var c=e.self._getDataValueAsNumber(o,r.series[e.seriesIndex]["dataField"+i[t]],e.groupIndex);if(isNaN(c))break;var m=e.renderData.offsets[e.seriesIndex][o][i[t]];if(isNaN(m))break;p[i[t]]=m}if(f+=e.inverse?e.rect.y:e.rect.x,e.polarAxisCoords){var y=this._toPolarCoord(e.polarAxisCoords,this._plotRect,f,m);f=y.x,m=y.y}for(var _ in f=this.renderer._ptrnd(f),i)p[_]=this.renderer._ptrnd(p[_]);var x=e.colors;if(x||(x=e.self._getColors(e.groupIndex,e.seriesIndex,o,e.gradientType)),e.isOHLC){var v="M"+f+","+p.Low+" L"+f+","+p.High+" M"+(f-s/2)+","+p.Open+" L"+f+","+p.Open+" M"+(f+s/2)+","+p.Close+" L"+f+","+p.Close;e.inverse&&(v="M"+p.Low+","+f+" L"+p.High+","+f+" M"+p.Open+","+(f-s/2)+" L"+p.Open+","+f+" M"+p.Close+","+f+" L"+p.Close+","+(f+s/2)),(b=p.lineElement)||(b=this.renderer.path(v,{}),this.renderer.attr(b,{fill:x.fillColor,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:x.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),p.lineElement=b),1===t&&this._installHandlers(b,"column",e.groupIndex,e.seriesIndex,o)}else{var b;(b=p.lineElement)||(b=e.inverse?this.renderer.line(p.Low,f,p.High,f):this.renderer.line(f,p.Low,f,p.High),this.renderer.attr(b,{fill:x.fillColor,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:x.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),p.lineElement=b);var N=p.stickElement;if(f-=s/2,!N){var M=x.fillColor;p.Close<=p.Open&&x.fillColorAlt&&(M=x.fillColorAlt),N=e.inverse?this.renderer.rect(Math.min(p.Open,p.Close),f,Math.abs(p.Close-p.Open),s):this.renderer.rect(f,Math.min(p.Open,p.Close),s,Math.abs(p.Close-p.Open)),this.renderer.attr(N,{fill:M,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:x.lineColor,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]}),p.stickElement=N}1===t&&this._installHandlers(N,"column",e.groupIndex,e.seriesIndex,o)}}}}_renderScatterSeries(e,t,i){var s=this.seriesGroups[e];if(s.series&&0!==s.series.length){var r=-1!==s.type.indexOf("bubble"),a="horizontal"===s.orientation,l=t;a&&(l={x:t.y,y:t.x,width:t.height,height:t.width});var n=this._calcGroupOffsets(e,l);if(n&&0!==n.xoffsets.length){var o,h=l.width;(s.polar||s.spider)&&(h=2*(o=this._getPolarAxisCoords(e,l)).r);var d=this._getGroupGradientType(e);i||(i="to");for(let V=0;V<s.series.length;V++){var u=this._getSerieSettings(e,V),g=s.series[V];if(!g.customDraw){var f=g.dataField,p="function"==typeof g.colorFunction,c=this._getColors(e,V,NaN,d),m=NaN,y=NaN;if(r)for(let t=n.xoffsets.first;t<=n.xoffsets.last;t++){"number"!=typeof(w=this._getDataValueAsNumber(t,g.radiusDataField||g.sizeDataField,e))&&this.error(this.localize("invalidRadiusDataField",{index:t})),isNaN(w)||((isNaN(m)||w<m)&&(m=w),(isNaN(y)||w>y)&&(y=w))}var _=g.minRadius||g.minSymbolSize;isNaN(_)&&(_=h/50);var x=g.maxRadius||g.maxSymbolSize;isNaN(x)&&(x=h/25),_>x&&(x=_);var v=g.radius;v=isNaN(v)&&!isNaN(g.symbolSize)?"circle"===g.symbolType?g.symbolSize/2:g.symbolSize:5;var b=this._getAnimProps(e,V),N=b.enabled&&!this._isToggleRefresh&&n.xoffsets.length<5e3?b.duration:0,M={groupIndex:e,seriesIndex:V,symbolType:g.symbolType,symbolSize:g.symbolSize,"fill-opacity":u.opacity,"stroke-opacity":u.opacity,"stroke-width":u.stroke,"stroke-width-symbol":u.strokeSymbol,"stroke-dasharray":u.dashStyle,items:[],polarAxisCoords:o},A=void 0;for(let s=n.xoffsets.first;s<=n.xoffsets.last;s++){var w;if("number"==typeof(w=this._getDataValueAsNumber(s,f,e))){var S=n.xoffsets.data[s],C=n.xoffsets.xvalues[s],k=n.offsets[V][s][i];if(!(k<l.y||k>l.y+l.height||isNaN(S)||isNaN(k))){if(a){var T=S;S=k,k=T+t.y}else S+=t.x;if(!(!p&&A&&this.enableSampling&&this.renderer._ptdist(A.x,A.y,S,k)<1)){A={x:S,y:k};var D=v;if(r){var F=this._getDataValueAsNumber(s,g.radiusDataField||g.sizeDataField,e);if("number"!=typeof F)continue;D=_+(x-_)*(F-m)/Math.max(1,y-m),isNaN(D)&&(D=_)}n.offsets[V][s].radius=D;var O=NaN,I=NaN,P=0,R=this._elementRenderInfo;if(null!=C&&R&&R.length>e&&R[e].series.length>V){var L=R[e].series[V][C];if(L&&!isNaN(L.to)){if(O=L.to,I=L.xoffset,P=v,a){T=I;I=O,O=T+t.y}else I+=t.x;r&&(P=_+(x-_)*(L.valueRadius-m)/Math.max(1,y-m),isNaN(P)&&(P=_))}}p&&(c=this._getColors(e,V,s,d)),M.items.push({from:P,to:D,itemIndex:s,fill:c.fillColor,stroke:c.lineColor,x:S,y:k,xFrom:I,yFrom:O})}}}}this._animR(M,0);var G=this;this._enqueueAnimation("series",void 0,void 0,N,(function(e,t,i){G._animR(t,i)}),M)}}}}}_animR(e,t){let i=e.items,s=e.symbolType||"circle",r=e.symbolSize;for(let a=0;a<i.length;a++){let l=i[a],n=l.x,o=l.y,h=Math.round((l.to-l.from)*t+l.from);if(isNaN(l.yFrom)||(o=l.yFrom+(o-l.yFrom)*t),isNaN(l.xFrom)||(n=l.xFrom+(n-l.xFrom)*t),e.polarAxisCoords){let t=this._toPolarCoord(e.polarAxisCoords,this._plotRect,n,o);n=t.x,o=t.y}n=this.renderer._ptrnd(n),o=this.renderer._ptrnd(o),h=this.renderer._ptrnd(h);let d=this._getRenderInfo(e.groupIndex,e.seriesIndex,i[a].itemIndex),u=d.element,g=d.labelElement;"circle"===s?(u||(u=this.renderer.circle(n,o,h),this.renderer.attr(u,{fill:l.fill,"fill-opacity":e["fill-opacity"],"stroke-opacity":e["fill-opacity"],stroke:l.stroke,"stroke-width":e["stroke-width"],"stroke-dasharray":e["stroke-dasharray"]})),this.renderer.attr(u,{r:h,cy:o,cx:n})):(u&&this.renderer.removeElement(u),u=this._drawSymbol(s,n,o,l.fill,e["fill-opacity"],l.stroke,e["stroke-opacity"]||e["fill-opacity"],e["stroke-width-symbol"],e["stroke-dasharray"],r||h)),g&&this.renderer.removeElement(g),g=this._showLabel(e.groupIndex,e.seriesIndex,l.itemIndex,{x:n-h,y:o-h,width:2*h,height:2*h}),t>=1&&this._installHandlers(u,"circle",e.groupIndex,e.seriesIndex,l.itemIndex),this._setRenderInfo(e.groupIndex,e.seriesIndex,i[a].itemIndex,{element:u,labelElement:g})}}_showMultiSeriesToolTip(e){let t=this,i="<div style='text-align:left'>",s="";for(let r=0;r<t.seriesGroups.length;r++){if(t._isPieGroup(r))continue;let a=t._getXAxis(r),l=t._getValueAxis(r),n=t.seriesGroups[r],o=this._getAxisSettings(a),h=this._getFormatSettings(o,"toolTipFormatSettings"),d=o.toolTipFormatFunction,u=t._getDataValue(e,a.dataField,r);void 0!==a.dataField&&null!==a.dataField&&""!==a.dataField||(u=e),"date"===a.type&&(u=t._castAsDate(u,(h?h.dateFormat:void 0)||a.dateFormat)),d||h||"date"!==a.type||(d=this._getDefaultDTFormatFn(a.baseUnit||"day"));let g=a.displayText||a.dataField||"";""!==g&&(g+=": ");let f=g+t._formatValue(u,h,d,r,void 0,e);s!==f&&(""!==s&&(i+="<br />"),i+=f+"<br /><br />",s=f);for(let s=0;s<n.series.length;s++){let a=n.series[s];if(!1===n.showToolTips||!1===a.showToolTips)continue;if(!t._isSerieVisible(r,s))continue;let o=t._get([t._getFormatSettings(a,"toolTipFormatSettings"),t._getFormatSettings(n,"toolTipFormatSettings"),t._getFormatSettings(l,"toolTipFormatSettings"),t._getFormatSettings(t,"toolTipFormatSettings")]),h=t._get([a.toolTipFormatFunction,n.toolTipFormatFunction,l.toolTipFormatFunction,t.toolTipFormatFunction]),d=t._getFormattedValue(r,s,e,o,h);i+='<span style="color:'+t._getColors(r,s,e).lineColor+';">'+d+"</span><br />\n"}}let r=this._get([t.toolTipClass,"smart-chart-tooltip-text"]),a=this._get([t.toolTipBackground,t._getThemeColor("background")]),l=this._get([t.toolTipLineColor,t._getThemeColor("line")]),n=this._get([t.toolTipOpacity,1]);i+="</div>";let o=this.getItemCoord(t._ttEl.gidx,t._ttEl.sidx,t._ttEl.iidx);o.x+=window.pageXOffset,o.y+=window.pageYOffset,t._createTooltip(o,t.seriesGroups[t._ttEl.gidx],i,{css:r,fill:a,stroke:l,fillOpacity:n,symbolSize:3})}_showToolTip(e,t,i,s,r){let a=this,l=a._getXAxis(i),n=a._getValueAxis(i);if(a._ttEl&&i===a._ttEl.gidx&&s===a._ttEl.sidx&&r===a._ttEl.iidx)return;let o=a.seriesGroups[i],h=o.series[s],d=a.enableCrosshairs;a._pointMarker?(e=parseInt(a._pointMarker.x+5),t=parseInt(a._pointMarker.y-5)):d=!1;let u=d&&!1===a.showToolTips;if(e=this.renderer._ptrnd(e),t=this.renderer._ptrnd(t),!1===o.showToolTips||!1===h.showToolTips)return;a._ttEl||(a._ttEl={}),a._ttEl.sidx=s,a._ttEl.gidx=i,a._ttEl.iidx=r;let g=0;for(let e=0;e<a.seriesGroups.length;e++)for(let t=0;t<a.seriesGroups[e].series.length;t++)g++;if(d){let e=this.renderer._ptrnd(a._pointMarker.x),t=this.renderer._ptrnd(a._pointMarker.y),s=a.crosshairsColor||a._getThemeColor("line");if(o.polar||o.spider){let r=this._getPolarAxisCoords(i,this._plotRect);if(this.renderer._ptdist(e,t,r.x,r.y)>r.r)return;let l=Math.atan2(t-r.y,e-r.x),n=Math.cos(l)*r.r+r.x,o=Math.sin(l)*r.r+r.y;a._ttEl.vLine?a.renderer.attr(a._ttEl.vLine,{x1:r.x,y1:r.y,x2:n,y2:o}):a._ttEl.vLine=a.renderer.line(r.x,r.y,n,o,{stroke:s,"stroke-width":a.crosshairsLineWidth||1,"stroke-dasharray":a.crosshairsDashStyle||""})}else a._ttEl.vLine&&a._ttEl.hLine?(a.renderer.attr(a._ttEl.vLine,{x1:e,x2:e}),a.renderer.attr(a._ttEl.hLine,{y1:t,y2:t})):(a._ttEl.vLine=a.renderer.line(e,a._plotRect.y,e,a._plotRect.y+a._plotRect.height,{stroke:s,"stroke-width":a.crosshairsLineWidth||1,"stroke-dasharray":a.crosshairsDashStyle||""}),a._ttEl.hLine=a.renderer.line(a._plotRect.x,t,a._plotRect.x+a._plotRect.width,t,{stroke:s,"stroke-width":a.crosshairsLineWidth||1,"stroke-dasharray":a.crosshairsDashStyle||""}))}if(a.showToolTipsOnAllSeries&&!a._isPieGroup(i)&&g>1)return void a._showMultiSeriesToolTip(r);let f=a._get([a._getFormatSettings(h,"toolTipFormatSettings"),a._getFormatSettings(o,"toolTipFormatSettings"),a._getFormatSettings(n,"toolTipFormatSettings"),a._getFormatSettings(a,"toolTipFormatSettings")]),p=a._get([h.toolTipFormatFunction,o.toolTipFormatFunction,n.toolTipFormatFunction,a.toolTipFormatFunction]),c=a._getColors(i,s,r),m=a._getDataValue(r,l.dataField,i);void 0!==l.dataField&&null!==l.dataField&&""!==l.dataField||(m=r),"date"===l.type&&(m=a._castAsDate(m,(f?f.dateFormat:void 0)||l.dateFormat));let y="";if("function"==typeof p){let e={},t=0;for(let s in h)0===s.indexOf("dataField")&&(e[s.substring(9,s.length).toLowerCase()]=a._getDataValue(r,h[s],i),t++);0===t?e=a._getDataValue(r,void 0,i):1===t&&(e=e[""]),y=p(e,r,h,o,m,l)}else{y=a._getFormattedValue(i,s,r,f,p);let e=this._getAxisSettings(l),t=a._getFormatSettings(e,"toolTipFormatSettings"),n=e.toolTipFormatFunction;n||t||"date"!==l.type||(n=this._getDefaultDTFormatFn(l.baseUnit||"day"));let o=a._formatValue(m,t,n,i,s,r);if(a._isPieGroup(i))m=a._getDataValue(r,h.displayText||h.dataField,i),o=a._formatValue(m,t,n,i,s,r),y=o+": "+y;else{let e=l.displayText||l.dataField||"";y=e.length>0?e+": "+o+"<br>"+y:o+"<br>"+y}}if(!u&&!1!==a.showToolTips){let e=this._get([h.toolTipClass,o.toolTipClass,a.toolTipClass,"smart-chart-tooltip-text"]),t=this._get([h.toolTipBackground,o.toolTipBackground,a.toolTipBackground,a._getThemeColor("background")]),l=this._get([h.toolTipLineColor,o.toolTipLineColor,a.toolTipLineColor,c.lineColor,a._getThemeColor("line")]),n=this._get([h.toolTipOpacity,o.toolTipOpacity,a.toolTipOpacity,1]),d=this.getItemCoord(i,s,r);d.y=Math.min(Math.max(d.y,this._plotRect.y),this._plotRect.y+this._plotRect.y+this._plotRect.height);let u=0;a._pointMarker&&a._pointMarker.element&&(u=h.symbolSizeSelected,isNaN(u)&&(u=h.symbolSize),(isNaN(u)||u>50||u<0)&&(u=o.symbolSize),(isNaN(u)||u>50||u<0)&&(u=8)),a._createTooltip(d,o,y,{css:e,fill:t,stroke:l,fillOpacity:n,symbolSize:u})}}_fitTooltip(e,t,i,s,r){let a={},l=2+r/2;if(t.x-i.width-7-l>e.x&&t.y+t.height/2-i.height/2>e.y&&t.y+t.height/2+i.height/2<e.y+e.height&&(a.left={arrowLocation:"right",x:t.x-i.width-7-l,y:t.y+t.height/2-i.height/2,width:i.width+7,height:i.height}),t.x+t.width+i.width+7+l<e.x+e.width&&t.y+t.height/2-i.height/2>e.y&&t.y+t.height/2+i.height/2<e.y+e.height&&(a.right={arrowLocation:"left",x:t.x+t.width+l,y:t.y+t.height/2-i.height/2,width:i.width+7,height:i.height}),t.y-i.height-l-7>e.y&&t.x+t.width/2-i.width/2>e.x&&t.x+t.width/2+i.width/2<e.x+e.width&&(a.top={arrowLocation:"bottom",x:t.x+t.width/2-i.width/2,y:t.y-i.height-l-7,width:i.width,height:i.height+7}),t.y+t.height+i.height+7+l<e.y+e.height&&t.x+t.width/2-i.width/2>e.x&&t.x+t.width/2+i.width/2<e.x+e.width&&(a.bottom={arrowLocation:"top",x:t.x+t.width/2-i.width/2,y:t.y+t.height+l,width:i.width,height:i.height+7}),t.width>t.height||(-1!==s.type.indexOf("stackedcolumn")||-1!==s.type.indexOf("stackedwaterfall"))&&"horizontal"!==s.orientation){if(a.left)return a.left;if(a.right)return a.right}else{if(a.top)return a.top;if(a.bottom)return a.bottom}for(let e in a)if(a[e])return a[e];return{arrowLocation:""}}_createTooltip(e,t,i,s){const r=this,a=t.type;let l=r._ttEl.box;if(!l){l=r._ttEl.box=document.createElement("div"),l.id=r.id+"Tooltip",l.className="smart-chart-tooltip",l.setAttribute("animation",r.animation),l.setAttribute("theme",r.theme),l.setAttribute("role","tooltip");const e=document.createElement("div"),t=document.createElement("div"),i=document.createElement("div");if(e.className="smart-chart-tooltip-arrow-outer",e.setAttribute("role","presentation"),t.className="smart-chart-tooltip-arrow-inner",t.setAttribute("role","presentation"),i.className="smart-chart-tooltip-content",i.setAttribute("role","presentation"),l.appendChild(i),l.appendChild(e),l.appendChild(t),r.getRootNode().host?r.getShadowRootOrBody().appendChild(l):document.body.appendChild(l),r.hasAttribute("aria-owns")){const e=r.getAttribute("aria-owns");r.setAttribute("aria-owns",e+" "+l.id)}else r.setAttribute("aria-owns",l.id)}if(!i||0===i.length)return void l.classList.add("smart-visibility-hidden");r.rightToLeft?l.setAttribute("right-to-left",""):l.removeAttribute("right-to-left"),l.classList.add("smart-visibility-hidden");const n=l.firstElementChild,o=l.children[1],h=l.children[2];h.style.opacity=o.style.opacity=s.fillOpacity,n.style.backgroundColor=s.fill,n.style.borderColor=s.stroke,n.style.opacity=s.fillOpacity;const d='<span class="'+s.css+'" role="presentation">'+i+"</span>";n.innerHTML=d;const u=r._measureHtml(d),g=r._plotRect;if(u.width>g.width||u.height>g.height)return;let f={width:u.width,height:u.height},p="",c=r._isColumnType(a),m=Math.max(e.x,g.x),y=Math.max(e.y,g.y);if(-1!==a.indexOf("pie")||-1!==a.indexOf("donut")){let t=(e.fromAngle+e.toAngle)/2;t*=Math.PI/180;let i=!isNaN(e.innerRadius)&&e.innerRadius>0?(e.innerRadius+e.outerRadius)/2:.75*e.outerRadius;m=e.x=e.center.x+Math.cos(t)*i,y=e.y=e.center.y-Math.sin(t)*i,e.width=e.height=1}else c&&(t.polar||t.spider)&&(e.width=e.height=1);let _=this._fitTooltip(this._plotRect,e,f,t,s.symbolSize);""!==_.arrowLocation&&(p=_.arrowLocation,m=_.x,y=_.y,f.width=_.width,f.height=_.height),"top"===p||"bottom"===p?(f.height+=7,m-=3.5,"bottom"===p&&(y-=7)):"left"!==p&&"right"!==p||(f.width+=7,y-=3.5,"right"===p&&(m-=7)),m+f.width>g.x+g.width&&(p="",m=g.x+g.width-f.width),y+f.height>g.y+g.height&&(p="",y=g.y+g.height-f.height);let x={x:0,y:0},v={x:0,y:0};n.style.width=u.width+"px",n.style.height=u.height+"px",o.style["margin-top"]=o.style["margin-left"]=0,h.style["margin-top"]=h.style["margin-left"]=0,n.style["margin-top"]=n.style["margin-left"]=0;switch(p){case"left":x={x:0,y:(u.height-7)/2},v={x:7,y:0},n.style["margin-left"]="7px",o.style["margin-left"]="0px",o.style["margin-top"]=x.y+"px",o.style["border-left"]="",o.style["border-right"]="7px solid "+s.stroke,o.style["border-top"]="7px solid transparent",o.style["border-bottom"]="7px solid transparent",h.style["margin-left"]="1px",h.style["margin-top"]=x.y+"px",h.style["border-left"]="",h.style["border-right"]="7px solid "+s.fill,h.style["border-top"]="7px solid transparent",h.style["border-bottom"]="7px solid transparent";break;case"right":x={x:f.width-7,y:(u.height-7)/2},v={x:0,y:0},o.style["margin-left"]=x.x+"px",o.style["margin-top"]=x.y+"px",o.style["border-left"]="7px solid "+s.stroke,o.style["border-right"]="",o.style["border-top"]="7px solid transparent",o.style["border-bottom"]="7px solid transparent",h.style["margin-left"]=x.x-1+"px",h.style["margin-top"]=x.y+"px",h.style["border-left"]="7px solid "+s.fill,h.style["border-right"]="",h.style["border-top"]="7px solid transparent",h.style["border-bottom"]="7px solid transparent";break;case"top":x={x:f.width/2-3.5,y:0},v={x:0,y:7},n.style["margin-top"]=v.y+"px",o.style["margin-left"]=x.x+"px",o.style["border-top"]="",o.style["border-bottom"]="7px solid "+s.stroke,o.style["border-left"]="7px solid transparent",o.style["border-right"]="7px solid transparent",h.style["margin-left"]=x.x+"px",h.style["margin-top"]="1px",h.style["border-top"]="",h.style["border-bottom"]="7px solid "+s.fill,h.style["border-left"]="7px solid transparent",h.style["border-right"]="7px solid transparent";break;case"bottom":x={x:f.width/2-3.5,y:f.height-7},v={x:0,y:0},o.style["margin-left"]=x.x+"px",o.style["margin-top"]=x.y+"px",o.style["border-top"]="7px solid "+s.stroke,o.style["border-bottom"]="",o.style["border-left"]="7px solid transparent",o.style["border-right"]="7px solid transparent",h.style["margin-left"]=x.x+"px",h.style["margin-top"]=x.y-1+"px",h.style["border-top"]="7px solid "+s.fill,h.style["border-bottom"]="",h.style["border-left"]="7px solid transparent",h.style["border-right"]="7px solid transparent"}""===p?(o.classList.add("smart-hidden"),h.classList.add("smart-hidden")):(o.classList.remove("smart-hidden"),h.classList.remove("smart-hidden")),l.style.width=f.width+"px",l.style.height=f.height+"px";const b=r.getBoundingClientRect();l.style.left=m+b.left+window.pageXOffset+"px",l.style.top=y+b.top+window.pageYOffset+"px",l.classList.remove("smart-visibility-hidden")}_measureHtml(e){const t=this;let i=t._measureDiv;i||(t._measureDiv=i=document.createElement("div"),i.className="smart-chart-tooltip",i.style.position="absolute",i.style.visibility="hidden",i.style.left=0,i.style.top=0,(t.shadowRoot||t).appendChild(i)),i.innerHTML=e;const s={width:i.offsetWidth+2,height:i.offsetHeight+2};return Smart.Utilities.Core.Browser.Firefox&&(s.height+=3),s}_hideToolTip(){this._ttEl&&(this._ttEl.box&&this._ttEl.box.classList.add("smart-visibility-hidden"),this._hideCrosshairs(),this._ttEl.gidx=void 0)}_hideCrosshairs(){this._ttEl&&(this._ttEl.vLine&&(this.renderer.removeElement(this._ttEl.vLine),this._ttEl.vLine=void 0),this._ttEl.hLine&&(this.renderer.removeElement(this._ttEl.hLine),this._ttEl.hLine=void 0))}_get(e){return this._draw.getByPriority(e)}_getAxisSettings(e){if(!e)return{};let t=e.gridLines||{},i={visible:this._get([t.visible,!0]),color:this._get([t.color,this._getThemeColor("line")]),unitInterval:t.unitInterval,step:t.step,dashStyle:t.dashStyle,width:this._get([t.lineWidth,1]),offsets:[],alternatingBackgroundColor:e.alternatingBackgroundColor,alternatingBackgroundColor2:e.alternatingBackgroundColor2,alternatingBackgroundOpacity:e.alternatingBackgroundOpacity},s=e.tickMarks||{},r={visible:this._get([s.visible,e.showTickMarks,!0]),color:this._get([s.color,e.tickMarksColor,this._getThemeColor("line")]),unitInterval:this._get([s.unitInterval,s.interval,e.tickMarksInterval]),step:this._get([s.step,e.tickMarksStep]),dashStyle:this._get([s.dashStyle,e.tickMarksDashStyle]),width:this._get([s.lineWidth,1]),size:this._get([s.size,4]),offsets:[]},a=e.title||{},l={visible:this._get([a.visible,!0]),text:this._get([e.description,a.text]),style:this._get([e.descriptionClass,a.class,"smart-chart-axis-description"]),halign:this._get([e.horizontalDescriptionAlignment,a.horizontalAlignment,"center"]),valign:this._get([e.verticalDescriptionAlignment,a.verticalAlignment,"center"]),angle:0,rotationPoint:this._get([a.rotationPoint,"centercenter"]),offset:this._get([a.offset,{x:0,y:0}])},n=e.line||{},o={visible:this._get([n.visible,!0]),color:this._get([n.color,i.color,this._getThemeColor("line")]),dashStyle:this._get([n.dashStyle,i.dashStyle,""]),width:this._get([n.lineWidth,1]),angle:this._get([n.angle,NaN])},h=e.padding||{};h={left:h.left||0,right:h.right||0,top:h.top||0,bottom:h.bottom||0};let d=this._getAxisLabelsSettings(e);return{visible:this._get([e.visible,!0]),customDraw:this._get([e.customDraw,!1]),gridLines:i,tickMarks:r,line:o,title:l,labels:d,padding:h,toolTipFormatFunction:this._get([e.toolTipFormatFunction,e.formatFunction,d.formatFunction]),toolTipFormatSettings:this._get([this._getFormatSettings(e,"toolTipFormatSettings"),this._getFormatSettings(e),this._getFormatSettings(d)])}}_getAxisLabelsSettings(e){let t=e.labels||{};return{visible:this._get([e.showLabels,t.visible,!0]),unitInterval:this._get([t.unitInterval,t.interval,e.labelsInterval]),step:this._get([t.step,e.labelsStep]),angle:this._get([e.textRotationAngle,t.angle,0]),style:this._get([e.class,t.class,"smart-chart-axis-text"]),halign:this._get([e.horizontalTextAlignment,t.horizontalAlignment,"center"]),valign:this._get([e.verticalTextAlignment,t.verticalAlignment,"center"]),textRotationPoint:this._get([e.textRotationPoint,t.rotationPoint,"auto"]),textOffset:this._get([e.textOffset,t.offset,{x:0,y:0}]),autoRotate:this._get([e.labelsAutoRotate,t.autoRotate,!1]),formatSettings:this._get([this._getFormatSettings(e),this._getFormatSettings(t),void 0]),formatFunction:this._get([e.formatFunction,t.formatFunction,void 0])}}_getLabelsSettings(e,t,i,s){let r=this.seriesGroups[e],a=r.series[t],l=isNaN(i)?void 0:this._getDataValue(i,a.dataField,e),n=s||["Visible","Offset","Angle","HorizontalAlignment","VerticalAlignment","Class","BackgroundColor","BorderColor","BorderOpacity","Padding","Opacity","BackgroundOpacity","LinesAngles","LinesEnabled","AutoRotate","Radius"],o={};for(let e=0;e<n.length;e++){let t=n[e],s="labels"+t,h="label"+t,d=t.substring(0,1).toLowerCase()+t.substring(1),u=void 0;r.labels&&"object"==typeof r.labels&&(u=r.labels[d]),a.labels&&"object"==typeof a.labels&&void 0!==a.labels[d]&&null!==a.labels[d]&&(u=a.labels[d]),u=this._get([a[s],a[h],u,r[s],r[h]]),o[d]="function"==typeof u?u(l,i,a,r):u}o.class=o.class||"smart-chart-label-text",o.visible=this._get([o.visible,a.showLabels,r.showLabels,void 0!==a.labels&&null!==a.labels||void 0,void 0!==r.labels&&null!==r.labels||void 0]);let h=o.padding||1;return o.padding={left:this._get([h.left,isNaN(h)?1:h]),right:this._get([h.right,isNaN(h)?1:h]),top:this._get([h.top,isNaN(h)?1:h]),bottom:this._get([h.bottom,isNaN(h)?1:h])},o}_showLabel(e,t,i,s,r,a,l,n,o,h,d){let u={width:0,height:0};if(isNaN(i))return;let g=this._getLabelsSettings(e,t,i);if(!g.visible)return l?u:void 0;if(s.width<0||s.height<0)return l?u:void 0;let f=g.angle;isNaN(h)||(f=h);let p=g.offset||{},c={x:p.x,y:p.y};isNaN(c.x)&&(c.x=0),isNaN(c.y)&&(c.y=0),r=r||g.horizontalAlignment||"center",a=a||g.verticalAlignment||"center";let m=this._getFormattedValue(e,t,i,void 0,void 0,!0),y=s.width,_=s.height;if(!0===n&&"center"!==r&&(r="right"===r?"left":"right"),!0===o&&"center"!==a&&"middle"!==a&&(a="top"===a?"bottom":"top",c.y*=-1),u=this.renderer.measureText(m,f,{class:g.class}),l)return u;let x=0,v=0;y>0&&(""===r||"center"===r?x+=(y-u.width)/2:"right"===r&&(x+=y-u.width)),_>0&&(""===a||"center"===a?v+=(_-u.height)/2:"bottom"===a&&(v+=_-u.height)),x+=s.x+c.x,v+=s.y+c.y;let b=this._plotRect;x<=b.x&&(x=b.x+2),v<=b.y&&(v=b.y+2);let N,M=Math.max(u.width,1),A=Math.max(u.height,1);v+A>=b.y+b.height&&(v=b.y+b.height-A-2),x+M>=b.x+b.width&&(x=b.x+b.width-M-2);let w=g.backgroundColor,S=g.borderColor,C=g.padding;(w||S)&&(N=this.renderer.beginGroup(),this.renderer.rect(x-C.left,v-C.top,u.width+C.left+C.right,u.height+C.bottom+C.bottom,{fill:w||"transparent","fill-opacity":g.backgroundOpacity||1,stroke:S||"transparent","stroke-opacity":g.borderOpacity,"stroke-width":1}));let k=this.renderer.text(m,x,v,u.width,u.height,f,{class:g.class,opacity:g.opacity||1},!1,"center","center",void 0,arguments[11]);return d&&(d.x=x-C.left,d.y=v-C.top,d.width=u.width+C.left+C.right,d.height=u.height+C.bottom+C.bottom),N&&this.renderer.endGroup(),N||k}_getAnimProps(e,t){let i=this.seriesGroups[e],s=isNaN(t)?void 0:i.series[t],r=this.hasAnimation;i.animation&&(r="none"!==i.animation),s&&s.animation&&(r="none"!==s.animation);let a=this.animationDuration;isNaN(a)&&(a=1e3);let l=i.animationDuration;if(isNaN(l)||(a=l),s){let e=s.animationDuration;isNaN(e)||(a=e)}return a>5e3&&(a=1e3),{enabled:r,duration:a}}_isColorTransition(e,t,i,s){if(s-1<i.xoffsets.first)return!1;let r=this._getColors(e,t,s,this._getGroupGradientType(e)),a=this._getColors(e,t,s-1,this._getGroupGradientType(e));return r.fillColor!==a.fillColor}_renderLineSeries(e,t){var i=this.seriesGroups[e];if(i.series&&0!==i.series.length){var s=-1!==i.type.indexOf("area"),r=-1!==i.type.indexOf("stacked"),a=r&&-1!==i.type.indexOf("100"),l=-1!==i.type.indexOf("spline"),n=-1!==i.type.indexOf("step"),o=-1!==i.type.indexOf("range"),h=!0===i.polar||!0===i.spider;if(h&&(n=!1),!n||!l){var d="horizontal"===i.orientation,u=!0===this._getXAxis(e).flip,g=t;d&&(g={x:t.y,y:t.x,width:t.height,height:t.width});var f=this._calcGroupOffsets(e,g);if(f&&0!==f.xoffsets.length){this._linesRenderInfo||(this._linesRenderInfo={}),this._linesRenderInfo[e]={};for(let t=i.series.length-1;t>=0;t--){var p=this._getSerieSettings(e,t),c={groupIndex:e,rect:g,serieIndex:t,swapXY:d,isArea:s,isSpline:l,isRange:o,isPolar:h,settings:p,segments:[],pointsLength:0};if(this._isSerieVisible(e,t)){var m=i.series[t];if(!m.customDraw){var y,_="function"==typeof m.colorFunction,x=f.xoffsets.first,v=x,b=this._getColors(e,t,NaN,this._getGroupGradientType(e));do{var N=[],M=[],A=[],w=0,S=0,C=NaN,k=NaN,T=NaN;if(!(f.xoffsets.length<1)){var D=this._getAnimProps(e,t),F=D.enabled&&!this._isToggleRefresh&&f.xoffsets.length<1e4&&D.duration,O=x;y=!1;var I=void 0;for(let r=x;r<=f.xoffsets.last;r++){x=r;var P=f.xoffsets.data[r],R=f.xoffsets.xvalues[r];if(!isNaN(P)&&(w=P=Math.max(P,1),S=f.offsets[t][r].to,!(!_&&I&&this.enableSampling&&this.renderer._ptdist(I.x,I.y,w,S)<1))){I={x:w,y:S};var L=f.offsets[t][r].from;if(isNaN(S)||isNaN(L)){if("connect"===m.emptyPointsDisplay)continue;if("zero"!==m.emptyPointsDisplay){y=!0;break}isNaN(S)&&(S=f.baseOffset),isNaN(L)&&(L=f.baseOffset)}if(_&&this._isColorTransition(e,t,f,x)&&N.length>1){x--;break}var G=this._elementRenderInfo;if(G&&G.length>e&&G[e].series.length>t){var V=G[e].series[t][R],E=(T=this.renderer._ptrnd(V?V.to:void 0),this.renderer._ptrnd(g.x+(V?V.xoffset:void 0)));A.push(d?{y:E,x:T,index:r}:{x:E,y:T,index:r})}v=r,p.stroke<2&&(S-g.y<=1&&(S=g.y+1),L-g.y<=1&&(L=g.y+1),g.y+g.height-S<=1&&(S=g.y+g.height-1),g.y+g.height-L<=1&&(L=g.y+g.height-1)),!s&&a&&(S<=g.y&&(S=g.y+1),S>=g.y+g.height&&(S=g.y+g.height-1),L<=g.y&&(L=g.y+1),L>=g.y+g.height&&(L=g.y+g.height-1)),w=(P=Math.max(P,1))+g.x,!0===i.skipOverlappingPoints&&!isNaN(C)&&Math.abs(C-w)<=1||(!n||isNaN(C)||isNaN(k)||k!==S&&N.push(d?{y:w,x:this.renderer._ptrnd(k)}:{x:w,y:this.renderer._ptrnd(k)}),N.push(d?{y:w,x:this.renderer._ptrnd(S),index:r}:{x:w,y:this.renderer._ptrnd(S),index:r}),M.push(d?{y:w,x:this.renderer._ptrnd(L),index:r}:{x:w,y:this.renderer._ptrnd(L),index:r}),C=w,k=S,isNaN(T)&&(T=S))}}if(0!==N.length){var B=N[N.length-1].index;_&&(b=this._getColors(e,t,B,this._getGroupGradientType(e)));var H=g.x+f.xoffsets.data[O],z=g.x+f.xoffsets.data[v];if(s&&!0===i.alignEndPointsWithIntervals&&(H>g.x&&(H=g.x),z<g.x+g.width&&(z=g.x+g.width),u)){var W=H;H=z,z=W}z=this.renderer._ptrnd(z),H=this.renderer._ptrnd(H);var j=f.baseOffset;T=this.renderer._ptrnd(T);var X=this.renderer._ptrnd(S)||j;o&&(N=N.concat(M.reverse())),c.pointsLength+=N.length;var U={lastItemIndex:B,colorSettings:b,pointsArray:N,pointsStart:A,left:H,right:z,pyStart:T,pyEnd:X,yBase:j,labelElements:[],symbolElements:[]};c.segments.push(U)}else x++}}while(x<f.xoffsets.first+f.xoffsets.length-1||y);this._linesRenderInfo[e][t]=c}}else this._linesRenderInfo[e][t]=c}var Y=this._linesRenderInfo[e],q=[];for(let e in Y)q.push(Y[e]);q=q.sort((function(e,t){return e.serieIndex-t.serieIndex})),s&&r&&q.reverse();for(let e=0;e<q.length;e++){c=q[e];this._animateLine(c,0===F?1:0);var Z=this;this._enqueueAnimation("series",void 0,void 0,F,(function(e,t,i){Z._animateLine(t,i)}),c)}}}}}_animateLine(e,t){let i=e.settings,s=e.groupIndex,r=e.serieIndex,a=this.seriesGroups[s],l=a.series[r],n=this._getSymbol(s,r),o=this._getLabelsSettings(s,r,NaN,["Visible"]).visible,h=!0;e.isPolar&&(isNaN(a.endAngle)||360===Math.round(Math.abs((isNaN(a.startAngle)?0:a.startAngle)-a.endAngle))||(h=!1)),!1===l.endPointsConnect&&(h=!1);let d=0;for(let a=0;a<e.segments.length;a++){let u=e.segments[a],g=this._calculateLine(s,e.pointsLength,d,u.pointsArray,u.pointsStart,u.yBase,t,e.isArea,e.swapXY);if(d+=u.pointsArray.length,""===g)continue;let f=g.split(" "),p=g;p=""!==p?this._buildLineCmd(g,e.isRange,u.left,u.right,u.pyStart,u.pyEnd,u.yBase,e.isArea,e.isPolar,h,e.isSpline,e.swapXY):"M 0 0";let c=u.colorSettings;if(u.pathElement?this.renderer.attr(u.pathElement,{d:p}):(u.pathElement=this.renderer.path(p,{"stroke-width":i.stroke,stroke:c.lineColor,"stroke-opacity":i.opacity,"fill-opacity":i.opacity,"stroke-dasharray":i.dashStyle,fill:e.isArea?c.fillColor:"none"}),this._installHandlers(u.pathElement,"path",s,r,u.lastItemIndex)),u.labelElements){for(let e=0;e<u.labelElements.length;e++)this.renderer.removeElement(u.labelElements[e]);u.labelElements=[]}if(u.symbolElements){for(let e=0;e<u.symbolElements.length;e++)this.renderer.removeElement(u.symbolElements[e]);u.symbolElements=[]}if(u.pointsArray.length===f.length&&("none"!==n||o)){let e=l.symbolSize,t=this._plotRect;for(let a=0;a<f.length;a++){let l=f[a].split(",");if(l={x:parseFloat(l[0]),y:parseFloat(l[1])},!(l.x<t.x||l.x>t.x+t.width||l.y<t.y||l.y>t.y+t.height)){if("none"!==n){let t=this._getColors(s,r,u.pointsArray[a].index,this._getGroupGradientType(s)),o=this._drawSymbol(n,l.x,l.y,t.fillColorSymbol,i.opacity,t.lineColorSymbol,i.opacity,i.strokeSymbol,void 0,e);u.symbolElements.push(o)}if(o&&(l=this._adjustLineLabelPosition(s,r,u.pointsArray[a].index,l),l)){let e=this._showLabel(s,r,u.pointsArray[a].index,{x:l.x,y:l.y,width:0,height:0});u.labelElements.push(e)}}}}if(1===t&&"none"!==n)for(let e=0;e<u.symbolElements.length;e++)isNaN(u.pointsArray[e].index)||this._installHandlers(u.symbolElements[e],"symbol",s,r,u.pointsArray[e].index)}}_adjustLineLabelPosition(e,t,i,s){let r=this._showLabel(e,t,i,{width:0,height:0},"","",!0);if(!r)return;let a={x:s.x-r.width/2,y:0};return a.y=s.y-1.5*r.height,a}_calculateLine(e,t,i,s,r,a,l,n,o){let h,d=this.seriesGroups[e];!0!==d.polar&&!0!==d.spider||(h=this._getPolarAxisCoords(e,this._plotRect));let u="",g=s.length;if(!n&&0===r.length){g=t*l-i}for(let e=0;e<g+1&&e<s.length;e++){e>0&&(u+=" ");let t=s[e].y,i=s[e].x,d=n?a:t,f=i;if(r&&r.length>e&&(d=r[e].y,f=r[e].x,(isNaN(d)||isNaN(f))&&(d=t,f=i)),g<=s.length&&e>0&&e===g&&(f=s[e-1].x,d=s[e-1].y),o?(i=this.renderer._ptrnd((i-d)*(n?l:1)+d),t=this.renderer._ptrnd(t)):(i=this.renderer._ptrnd((i-f)*l+f),t=this.renderer._ptrnd((t-d)*l+d)),h){let e=this._toPolarCoord(h,this._plotRect,i,t);i=e.x,t=e.y}u+=i+","+t}return u}_buildLineCmd(e,t,i,s,r,a,l,n,o,h,d,u){let g=e,f=u?l+","+i:i+","+l;!n||o||t||(g=f+" "+e+" "+(u?l+","+s:s+","+l)),d&&(g=this._getBezierPoints(g));let p=g.split(" ");if(0===p.length)return"";if(1===p.length){let e=p[0].split(",");return"M "+p[0]+" L"+(parseFloat(e[0])+1)+","+(parseFloat(e[1])+1)}let c=p[0].replace("M","");return n&&!o?g=t?"M "+c+" L "+c+(d?"":" L "+c+" ")+g:"M "+f+" L "+c+" "+g:d||(g="M "+c+" L "+c+" "+g),(o&&h||t)&&(g+=" Z"),g}_getSerieSettings(e,t){let i=this.seriesGroups[e],s=-1!==i.type.indexOf("area"),r=-1!==i.type.indexOf("line"),a=i.series[t],l=a.dashStyle||i.dashStyle||"",n=a.opacity||i.opacity;(isNaN(n)||n<0||n>1)&&(n=1);let o=a.lineWidth;isNaN(o)&&"auto"!==o&&(o=i.lineWidth),("auto"===o||isNaN(o)||o<0||o>15)&&(o=s?2:r?3:1);let h=a.lineWidthSymbol;return isNaN(h)&&(h=1),{stroke:o,strokeSymbol:h,opacity:n,dashStyle:l}}_getColors(e,t,i,s,r){let a=this.seriesGroups[e],l=a.series[t],n=this._get([l.useGradientColors,a.useGradientColors,!1]),o=this._getSeriesColors(e,t,i),h=[[0,1.4],[100,1]],d=[[0,1],[25,1.1],[50,1.4],[100,1]],u=[[0,1.3],[90,1.2],[100,1]],g=NaN;if(isNaN(r)||(g=2===r?h:d),n){let r={};for(let e in o)r[e]=o[e];if(o=r,"verticalLinearGradient"===s||"horizontalLinearGradient"===s){let e="verticalLinearGradient"===s?g||h:g||d,t=["fillColor","fillColorSelected","fillColorAlt","fillColorAltSelected"];for(let i in t){let r=o[t[i]];r&&(o[t[i]]=this.renderer._toLinearGradient(r,"verticalLinearGradient"===s,e))}}else if("radialGradient"===s){let s,r=h;("pie"===a.type||"donut"===a.type||a.polar)&&null!=i&&this._renderData[e]&&this._renderData[e].offsets[t]&&(s=this._renderData[e].offsets[t][i],r=u),o.fillColor=this.renderer._toRadialGradient(o.fillColor,r,s),o.fillColorSelected=this.renderer._toRadialGradient(o.fillColorSelected,r,s)}}return o}_installHandlers(e,t,i,s,r){if(!this.enableEvents)return!1;var a=this,l=this.seriesGroups[i],n=this.seriesGroups[i].series[s],o=-1!==l.type.indexOf("line")||-1!==l.type.indexOf("area");o||!1===l.enableSelection||!1===n.enableSelection||this.renderer.addHandler(e,"mousemove",(function(e){var t=a._selected;t&&t.isLineType&&"click"===t.linesUnselectMode&&(t.group!==i||t.series!==s)||a._ttEl&&a._ttEl.gidx===i&&a._ttEl.sidx===s&&a._ttEl.iidx===r||a._startTooltipTimer(i,s,r)})),!1!==l.enableSelection&&!1!==n.enableSelection&&this.renderer.addHandler(e,"mouseover",(function(){var l=a._selected;l&&l.isLineType&&"click"===l.linesUnselectMode&&(l.group!==i||l.series!==s)||a._select(e,t,i,s,r,r)})),this.renderer.addHandler(e,"click",(function(e){clearTimeout(a._hostClickTimer),a._lastClickTs=(new Date).valueOf(),o&&"symbol"!==t&&"pointMarker"!==t||(a._isColumnType(l.type)&&a._unselect(),isNaN(r)||(e.stopImmediatePropagation(),a._raiseItemEvent("click",l,n,r)))}))}_getHorizontalOffset(e,t,i,s){let r=this._plotRect;if(0===this._getDataLen(e))return{index:void 0,value:i};let a=this._calcGroupOffsets(e,this._plotRect);if(0===a.xoffsets.length)return{index:void 0,value:void 0};let l,n,o,h,d,u=i,g=s,f=this.seriesGroups[e];(f.polar||f.spider)&&(l=this._getPolarAxisCoords(e,r));for(let e=a.xoffsets.first;e<=a.xoffsets.last;e++){let i=a.xoffsets.data[e],s=a.offsets[t][e].to,p=0;if(l){let e=this._toPolarCoord(l,r,i+r.x,s);i=e.x,s=e.y,p=this.renderer._ptdist(u,g,i,s)}else if("horizontal"===f.orientation){i+=r.y;let e=s;s=i,i=e,p=this.renderer._ptdist(u,g,i,s)}else i+=r.x,p=Math.abs(u-i);(isNaN(n)||n>p)&&(n=p,o=e,h=i,d=s)}return{index:o,value:a.xoffsets.data[o],polarAxisCoords:l,x:h,y:d}}onmousemove(e,t){if(this._mouseX===e&&this._mouseY===t)return;if(this._mouseX=e,this._mouseY=t,!this._selected)return;let i=this._selected.group,s=this._selected.series,r=this.seriesGroups[i],a=r.series[s],l=this._plotRect;if(this.renderer&&(l=this.renderer.getRect(),l.x+=5,l.y+=5,l.width-=10,l.height-=10),e<l.x+window.scrollX||e>l.x+l.width+window.scrollX||t<l.y+window.scrollY||t>l.y+l.height+window.scrollY)return this._hideToolTip(),void this._unselect();let n="horizontal"===r.orientation;if(l=this._plotRect,-1!==r.type.indexOf("line")||-1!==r.type.indexOf("area")){let o=this._getHorizontalOffset(i,this._selected.series,e,t),h=o.index;if(null==h)return;if(this._selected.item!==h){let e=this._linesRenderInfo[i][s].segments,t=0;for(;h>e[t].lastItemIndex;)if(t++,t>=e.length)return;let r=e[t].pathElement,a=e[t].lastItemIndex;this._unselect(!1),this._select(r,"path",i,s,h,a)}let d=this._getSymbol(this._selected.group,this._selected.series);"none"===d&&(d="circle");let u=this._calcGroupOffsets(i,l),g=u.offsets[this._selected.series][h].to,f=g;-1!==r.type.indexOf("range")&&(f=u.offsets[this._selected.series][h].from);let p=n?e:t;if(t=!isNaN(f)&&Math.abs(p-f)<Math.abs(p-g)?f:g,isNaN(t))return;if(e=o.value,n){let i=e;e=t,t=i+l.y}else e+=l.x;if(o.polarAxisCoords&&(e=o.x,t=o.y),t=this.renderer._ptrnd(t),e=this.renderer._ptrnd(e),this._pointMarker&&this._pointMarker.element&&(this.renderer.removeElement(this._pointMarker.element),this._pointMarker.element=void 0),isNaN(e)||isNaN(t))return;let c=this._getSeriesColors(i,s,h),m=this._getSerieSettings(i,s),y=a.symbolSizeSelected;isNaN(y)&&(y=a.symbolSize),(isNaN(y)||y>50||y<0)&&(y=r.symbolSize),(isNaN(y)||y>50||y<0)&&(y=8),(this.showToolTips||this.enableCrosshairs)&&(this._pointMarker={type:d,x:e,y:t,gidx:i,sidx:s,iidx:h},this._pointMarker.element=this._drawSymbol(d,e,t,c.fillColorSymbolSelected,m.opacity,c.lineColorSymbolSelected,m.opacity,m.strokeSymbol,m.dashStyle,y),this._installHandlers(this._pointMarker.element,"pointMarker",i,s,h)),this._startTooltipTimer(i,this._selected.series,h)}}_drawSymbol(e,t,i,s,r,a,l,n,o,h){let d,u,g=h||6,f=g/2;switch(e){case"none":return;case"circle":d=this.renderer.circle(t,i,g/2);break;case"square":g-=1,f=g/2,d=this.renderer.rect(t-f,i-f,g,g);break;case"diamond":u="M "+(t-f)+","+i+" L"+t+","+(i-f)+" L"+(t+f)+","+i+" L"+t+","+(i+f)+" Z",d=this.renderer.path(u);break;case"triangle_up":case"triangle":u="M "+(t-f)+","+(i+f)+" L "+(t+f)+","+(i+f)+" L "+t+","+(i-f)+" Z",d=this.renderer.path(u);break;case"triangle_down":u="M "+(t-f)+","+(i-f)+" L "+t+","+(i+f)+" L "+(t+f)+","+(i-f)+" Z",d=this.renderer.path(u);break;case"triangle_left":u="M "+(t-f)+","+i+" L "+(t+f)+","+(i+f)+" L "+(t+f)+","+(i-f)+" Z",d=this.renderer.path(u);break;case"triangle_right":u="M "+(t-f)+","+(i-f)+" L "+(t-f)+","+(i+f)+" L "+(t+f)+","+i+" Z",d=this.renderer.path(u);break;default:d=this.renderer.circle(t,i,g)}return this.renderer.attr(d,{fill:s,"fill-opacity":r,stroke:a,"stroke-width":n,"stroke-opacity":l,"stroke-dasharray":o||""}),"circle"!==e&&(this.renderer.attr(d,{r:g/2}),"square"!==e&&this.renderer.attr(d,{x:t,y:i})),d}_getSymbol(e,t){let i,s=["circle","square","diamond","triangle_up","triangle_down","triangle_left","triangle_right"],r=this.seriesGroups[e],a=r.series[t];return void 0!==a.symbolType&&null!==a.symbolType&&(i=a.symbolType),null==i&&(i=r.symbolType),"default"===i?s[t%s.length]:null!=i?i:"none"}_startTooltipTimer(e,t,i,s,r,a,l){this._cancelTooltipTimer();let n=this,o=this.toolTipShowDelay;(isNaN(o)||o>1e4||o<0)&&(o=500),(this._ttEl||!0===this.enableCrosshairs&&!1===this.showToolTips)&&(o=0),isNaN(a)||(o=a),clearTimeout(this._tttimerHide),isNaN(s)&&(s=n._mouseX),isNaN(r)&&(r=n._mouseY-3),0===o&&n._showToolTip(s,r,e,t,i),this._tttimer=setTimeout((function(){0!==o&&n._showToolTip(s,r,e,t,i);let a=n.toolTipHideDelay;isNaN(l)||(a=l),isNaN(a)&&(a=4e3),n._tttimerHide=setTimeout((function(){n._hideToolTip(),n._unselect()}),a)}),o)}_cancelTooltipTimer(){clearTimeout(this._tttimer)}_getGroupGradientType(e){let t=this.seriesGroups[e];return-1!==t.type.indexOf("area")?"horizontal"===t.orientation?"horizontalLinearGradient":"verticalLinearGradient":this._isColumnType(t.type)||-1!==t.type.indexOf("candle")?t.polar?"radialGradient":"horizontal"===t.orientation?"verticalLinearGradient":"horizontalLinearGradient":-1!==t.type.indexOf("scatter")||-1!==t.type.indexOf("bubble")||this._isPieGroup(e)?"radialGradient":void 0}_select(e,t,i,s,r,a){if(this._selected){if(this._selected.item===r&&this._selected.series===s&&this._selected.group===i)return;this._unselect()}let l=this.seriesGroups[i],n=l.series[s];if(!1===l.enableSelection||!1===n.enableSelection)return;let o=-1!==l.type.indexOf("line")&&-1===l.type.indexOf("area");this._selected={element:e,type:t,group:i,series:s,item:r,iidxBase:a,isLineType:o,linesUnselectMode:n.linesUnselectMode||l.linesUnselectMode};let h=this._getColors(i,s,a||r,this._getGroupGradientType(i)),d=h.fillColorSelected;o&&(d="none");let u=this._getSerieSettings(i,s),g="symbol"===t?h.lineColorSymbolSelected:h.lineColorSelected;d="symbol"===t?h.fillColorSymbolSelected:d;let f="symbol"===t?1:u.stroke;"symbol"!==t&&this.renderer.getAttr(e,"fill")===h.fillColorAlt&&(d=h.fillColorAltSelected),this.renderer.attr(e,{stroke:g,fill:d,"stroke-width":f}),-1===l.type.indexOf("pie")&&-1===l.type.indexOf("donut")||this._applyPieSelect(),this._raiseItemEvent("mouseover",l,n,r),this._isTouchDevice&&this._startTooltipTimer(i,s,r)}_applyPieSelect(){var e=this;e._createAnimationGroup("animPieSlice");var t=this._selected;if(t){var i=this.getItemCoord(t.group,t.series,t.item);if(i){var s={element:this._getRenderInfo(t.group,t.series,t.item),coord:i};this._enqueueAnimation("animPieSlice",void 0,void 0,300,(function(i,s,r){var a=s.coord,l=a.selectedRadiusChange*r,n=e.renderer.pieSlicePath(a.center.x,a.center.y,0===a.innerRadius?0:a.innerRadius+l,a.outerRadius+l,a.fromAngle,a.toAngle,a.centerOffset);e.renderer.attr(s.element.element,{d:n}),e._showPieLabel(t.group,t.series,t.item,void 0,l,s.element.colors.lineColor)}),s),e._startAnimation("animPieSlice")}}}_applyPieUnselect(){this._stopAnimations();let e=this._selected;if(!e)return;let t=this.getItemCoord(e.group,e.series,e.item);if(!t||!t.center)return;let i=this.renderer.pieSlicePath(t.center.x,t.center.y,t.innerRadius,t.outerRadius,t.fromAngle,t.toAngle,t.centerOffset);this.renderer.attr(e.element,{d:i}),this._showPieLabel(e.group,e.series,e.item,void 0,0,this._getRenderInfo(e.group,e.series,e.item).colors.lineColor)}_unselect(){let e=this;if(e._selected){let t=e._selected.group,i=e._selected.series,s=e._selected.item,r=e._selected.iidxBase,a=e._selected.type,l=e.seriesGroups[t],n=l.series[i],o=-1!==l.type.indexOf("line")&&-1===l.type.indexOf("area"),h=e._getColors(t,i,r||s,e._getGroupGradientType(t)),d=h.fillColor;o&&(d="none");let u=e._getSerieSettings(t,i),g="symbol"===a?h.lineColorSymbol:h.lineColor;d="symbol"===a?h.fillColorSymbol:d,"symbol"!==a&&this.renderer.getAttr(e._selected.element,"fill")===h.fillColorAltSelected&&(d=h.fillColorAlt);let f="symbol"===a?1:u.stroke;e.renderer.attr(e._selected.element,{stroke:g,fill:d,"stroke-width":f}),-1===l.type.indexOf("pie")&&-1===l.type.indexOf("donut")||this._applyPieUnselect(),e._selected=void 0,isNaN(s)||e._raiseItemEvent("mouseout",l,n,s)}e._pointMarker&&(e._pointMarker.element&&(e.renderer.removeElement(e._pointMarker.element),e._pointMarker.element=void 0),e._pointMarker=void 0,e._hideCrosshairs())}_raiseItemEvent(e,t,i,s){let r=i[e]||t[e],a=0;for(;a<this.seriesGroups.length&&this.seriesGroups[a]!==t;a++);if(a===this.seriesGroups.length)return;let l={event:e,seriesGroup:t,serie:i,elementIndex:s,elementValue:this._getDataValue(s,i.dataField,a)};r&&"function"==typeof r&&r(l),this.$.fireEvent(e,l)}_calcInterval(e,t,i){let s=Math.abs(t-e)/i,r=.1,a=[1,2,3,4,5,10,15,20,25,50,100];s<1&&(a=[.5,.25,.125,.1],r=10);let l=0;do{l=0,s>=1?r*=10:r/=10;for(let e=1;e<a.length&&Math.abs(a[l]*r-s)>Math.abs(a[e]*r-s);e++)l=e}while(l===a.length-1);return a[l]*r}_renderDataClone(){if(!this._renderData||this._isToggleRefresh)return;let e=this._elementRenderInfo=[];if(!this._isSelectorRefresh)for(let t=0;t<this._renderData.length;t++){for(;e.length<=t;)e.push({});let i=e[t],s=this._renderData[t];if(!s.offsets)continue;if(s.valueAxis){i.valueAxis={itemOffsets:{}};for(let e in s.valueAxis.itemOffsets)i.valueAxis.itemOffsets[e]=s.valueAxis.itemOffsets[e]}if(s.xAxis){i.xAxis={itemOffsets:{}};for(let e in s.xAxis.itemOffsets)i.xAxis.itemOffsets[e]=s.xAxis.itemOffsets[e]}i.series=[];let r=i.series,a=this._isPieGroup(t);for(let e=0;e<s.offsets.length;e++){r.push({});for(let i=0;i<s.offsets[e].length;i++)if(a){let t=s.offsets[e][i];r[e][t.displayValue]={value:t.value,x:t.x,y:t.y,fromAngle:t.fromAngle,toAngle:t.toAngle}}else s.xoffsets?r[e][s.xoffsets.xvalues[i]]={value:s.offsets[e][i].value,valueRadius:s.offsets[e][i].valueRadius,xoffset:s.xoffsets.data[i],from:s.offsets[e][i].from,to:s.offsets[e][i].to}:(s.xoffsets=this._calculateXOffsets(t,self._plotRect.width),s.xoffsets&&(r[e][s.xoffsets.xvalues[i]]={value:s.offsets[e][i].value,valueRadius:s.offsets[e][i].valueRadius,xoffset:s.xoffsets.data[i],from:s.offsets[e][i].from,to:s.offsets[e][i].to}))}}}getPolarDataPointOffset(e,t,i){let s=this._renderData[i];if(!s)return{x:NaN,y:NaN};let r=this.getValueAxisDataPointOffset(t,i),a=this.getXAxisDataPointOffset(e,i),l=this._toPolarCoord(s.polarCoords,s.xAxis.rect,a,r);return{x:l.x,y:l.y}}_getDataPointOffsetDiff(e,t,i,s,r,a,l){let n=this._getDataPointOffset(e,i,s,r,a,l),o=this._getDataPointOffset(t,i,s,r,a,l);return Math.abs(n-o)}_getXAxisRenderData(e){if(e>=this._renderData.length)return;let t=this.seriesGroups[e],i=this._renderData[e].xAxis;if(i){if(void 0===t.xAxis||null===t.xAxis)for(let t=0;t<=e;t++)if(void 0===this.seriesGroups[t].xAxis||null===this.seriesGroups[t].xAxis){i=this._renderData[t].xAxis;break}return i}}getXAxisDataPointOffset(e,t){let i=this.seriesGroups[t];if(isNaN(e))return NaN;const s=this._getXAxisRenderData(t);if(!s)return NaN;let r=s.data.axisStats,a=r.min.valueOf(),l=r.max.valueOf(),n=l-a;if(0===n&&(n=1),e.valueOf()>l||e.valueOf()<a)return NaN;let o=this._getXAxis(t),h="horizontal"===i.orientation?"height":"width",d="horizontal"===i.orientation?"y":"x",u=(e.valueOf()-a)/n,g=s.rect[h]-s.data.padding.left-s.data.padding.right;if(i.polar||i.spider){this._renderData[t].polarCoords.isClosedCircle&&(g=s.data.axisSize)}return this._plotRect[d]+s.data.padding.left+g*(o.flip?1-u:u)}getValueAxisDataPointOffset(e,t){let i=this._getValueAxis(t);if(!i)return NaN;let s=this._renderData[t];if(!s)return NaN;let r=!0===i.flip,a=s.logBase,l=s.scale,n=s.gbase,o=s.baseOffset;return this._getDataPointOffset(e,n,a,l,o,r)}_getDataPointOffset(e,t,i,s,r,a){let l;return isNaN(e)&&(e=t),l=isNaN(i)?(e-t)*s:(this._draw.log(e,i)-this._draw.log(t,i))*s,l=a?r+l:r-l,l}_calcGroupOffsets(e,t){let i=this.seriesGroups[e];for(;this._renderData.length<e+1;)this._renderData.push({});if(null!==this._renderData[e]&&void 0!==this._renderData[e].offsets)return this._renderData[e];if(this._isPieGroup(e))return this._calcPieSeriesGroupOffsets(e,t);let s=this._getValueAxis(e);if(!s||!i.series||0===i.series.length)return this._renderData[e];let r=!0===s.flip,a=!0===s.logarithmicScale,l=s.logarithmicScaleBase||10,n=[],o=-1!==i.type.indexOf("stacked"),h=o&&-1!==i.type.indexOf("100"),d=-1!==i.type.indexOf("range"),u=this._isColumnType(i.type),g=-1!==i.type.indexOf("waterfall"),f=this._getDataLen(e),p=i.baselineValue||s.baselineValue||0;h&&(p=0);let c=this._stats.seriesGroups[e];if(!c||!c.isValid)return;let m=c.hasStackValueReversal;if(m&&(p=0),g&&o){if(m)return;p=c.base}p>c.max&&(p=c.max),p<c.min&&(p=c.min);let y=h||a?c.maxRange:c.max-c.min,_=c.min,x=c.max,v=t.height/(a?c.intervals:y),b=0;h?_*x<0?(y/=2,b=-(y+p)*v):b=-p*v:b=-(p-_)*v,r?b=t.y-b:b+=t.y+t.height;let N,M=[],A=[],w=[];a&&(N=this._draw.log(x,l)-this._draw.log(p,l),o&&(N=c.intervals,p=h?0:_),r||(b=t.y+N/c.intervals*t.height)),b=this.renderer._ptrnd(b);let S=_*x<0?t.height/2:t.height,C=[],k=[],T=o&&(u||a),D=[];n=new Array(i.series.length);for(let e=0;e<i.series.length;e++)n[e]=new Array(f);for(let t=0;t<f;t++){!g&&o&&(k=[]);for(let s=0;s<i.series.length;s++){!o&&a&&(C=[]);let u=i.series[s],g=u.dataField,f=u.dataFieldFrom,m=u.dataFieldTo,y=u.radiusDataField||u.sizeDataField;n[s][t]={};let _=this._isSerieVisible(e,s);if(-1!==i.type.indexOf("candle")||-1!==i.type.indexOf("ohlc")){let i=["Open","Close","High","Low"];for(let o in i){let h="dataField"+i[o];u[h]&&(n[s][t][i[o]]=this._getDataPointOffset(this._getDataValueAsNumber(t,u[h],e),p,a?l:NaN,v,b,r))}continue}if(o)for(;k.length<=t;)k.push(0);let x=NaN;d&&(x=this._getDataValueAsNumber(t,f,e),isNaN(x)&&(x=p));let N=NaN;N=d?this._getDataValueAsNumber(t,m,e):this._getDataValueAsNumber(t,g,e);let F,O=this._getDataValueAsNumber(t,y,e);if(o&&(k[t]+=_?N:0),_||(N=NaN),isNaN(N)||a&&N<=0){n[s][t]={from:void 0,to:void 0};continue}o&&(T?F=N>=p?M:A:N=k[t]);let I=v*(N-p);if(d&&(I=v*(N-x)),o&&T&&(D[t]?I=v*N:(D[t]=!0,I=v*(N-p))),a){for(;C.length<=t;)C.push({p:{value:0,height:0},n:{value:0,height:0}});let e=d||d?x:p,i=N>e?C[t].p:C[t].n;i.value+=N,h?(N=i.value/(c.psums[t]+c.nsums[t])*100,I=(this._draw.log(N,l)-c.minPow)*v):(I=this._draw.log(i.value,l)-this._draw.log(e,l),I*=v),I-=i.height,i.height+=I}let P=b;if(d){let e=0;e=a?(this._draw.log(x,l)-this._draw.log(p,l))*v:(x-p)*v,P+=r?e:-e}if(o){if(h&&!a){let e=c.psums[t]-c.nsums[t];N>p?(I=c.psums[t]/e*S,0!==c.psums[t]&&(I*=N/c.psums[t])):(I=c.nsums[t]/e*S,0!==c.nsums[t]&&(I*=N/c.nsums[t]))}T&&(isNaN(F[t])&&(F[t]=P),P=F[t])}isNaN(w[t])&&(w[t]=0);let R=w[t];I=Math.abs(I);let L=I;if(I>=1){const e=this.renderer._ptrnd(I)-1;I=Math.abs(I-e)>.5?Math.round(I):e}if(R+=I-L,o||(R=0),Math.abs(R)>.5&&(R>0?(I-=1,R-=1):(I+=1,R+=1)),w[t]=R,s===i.series.length-1&&h){let e=0;for(let i=0;i<s;i++)e+=Math.abs(n[i][t].to-n[i][t].from);if(e+=I,e<S)if(I>.5)I=this.renderer._ptrnd(I+S-e);else{let i=s-1;for(;i>=0;){if(Math.abs(n[i][t].to-n[i][t].from)>1){n[i][t].from>n[i][t].to&&(n[i][t].from+=S-e);break}i--}}}r&&(I*=-1);let G=N<p;d&&(G=x>N);let V=isNaN(x)?N:{from:x,to:N};G?(T&&(F[t]+=I),n[s][t]={from:P,to:P+I,value:V,valueRadius:O}):(T&&(F[t]-=I),n[s][t]={from:P,to:P-I,value:V,valueRadius:O})}}let F=this._renderData[e];return F.baseOffset=b,F.gbase=p,F.logBase=a?l:NaN,F.scale=v,F.offsets=g?this._applyWaterfall(n,f,e,b,p,a?l:NaN,v,r,o):n,F.xoffsets=this._calculateXOffsets(e,t.width),this._renderData[e]}_isPercent(e){return"string"==typeof e&&e.length>0&&e.indexOf("%")===e.length-1}_calcPieSeriesGroupOffsets(e,t){var i=this._getDataLen(e),s=this.seriesGroups[e],r=this._renderData[e]={},a=r.offsets=[];for(let r=0;r<s.series.length;r++){var l=s.series[r],n=this._get([l.minAngle,l.startAngle]);(isNaN(n)||n<0||n>360)&&(n=0);var o=this._get([l.maxAngle,l.endAngle]);(isNaN(o)||o<0||o>360)&&(o=360);var h=o-n,d=l.initialAngle||0;d<n&&(d=n),d>o&&(d=o);var u=l.centerOffset||0,g=this._draw.getNum([l.offsetX,s.offsetX,t.width/2]),f=this._draw.getNum([l.offsetY,s.offsetY,t.height/2]),p=Math.min(t.width,t.height)/2,c=d,m=l.radius;this._isPercent(m)&&(m=parseFloat(m)/100*p),isNaN(m)&&(m=.4*p);var y=l.innerRadius;this._isPercent(y)&&(y=parseFloat(y)/100*p),(isNaN(y)||y>=m)&&(y=0);var _=l.selectedRadiusChange;this._isPercent(_)&&(_=parseFloat(_)/100*(m-y)),isNaN(_)&&(_=.1*(m-y)),a.push([]);var x=0,v=0;for(let t=0;t<i;t++){var b=this._getDataValueAsNumber(t,l.dataField,e);isNaN(b)||(this._isSerieVisible(e,r,t)||!0===l.hiddenPointsDisplay)&&(b>0?x+=b:v+=b)}var N=x-v;0===N&&(N=1);for(let s=0;s<i;s++){b=this._getDataValueAsNumber(s,l.dataField,e);if(isNaN(b))a[r].push({});else{var M=l.displayText||l.displayField,A=this._getDataValue(s,M,e);null==A&&(A=s);var w=0,S=this._isSerieVisible(e,r,s);(S||!0===l.hiddenPointsDisplay)&&(w=Math.abs(b)/N*h);var C=t.x+g,k=t.y+f,T=u;"function"==typeof u&&(T=u({seriesIndex:r,seriesGroupIndex:e,itemIndex:s})),isNaN(T)&&(T=0);var D={key:e+"_"+r+"_"+s,value:b,displayValue:A,x:C,y:k,fromAngle:c,toAngle:c+w,centerOffset:T,innerRadius:y,outerRadius:m,selectedRadiusChange:_,visible:S};a[r].push(D),c+=w}}}return r}_isPointSeriesOnly(){for(let e=0;e<this.seriesGroups.length;e++){let t=this.seriesGroups[e];if(-1===t.type.indexOf("line")&&-1===t.type.indexOf("area")&&-1===t.type.indexOf("scatter")&&-1===t.type.indexOf("bubble"))return!1}return!0}_hasColumnSeries(){let e=["column","ohlc","candlestick","waterfall"];for(let t=0;t<this.seriesGroups.length;t++){let i=this.seriesGroups[t];for(let t in e)if(-1!==i.type.indexOf(e[t]))return!0}return!1}_alignValuesWithTicks(e){let t=this._isPointSeriesOnly(),i=this.seriesGroups[e],s=this._getXAxis(e),r=void 0===s.valuesOnTicks||null===s.valuesOnTicks?t:!1!==s.valuesOnTicks;return s.logarithmicScale&&(r=!0),null==e||void 0===i.valuesOnTicks||null===i.valuesOnTicks?r:i.valuesOnTicks}_getYearsDiff(e,t){return t.getFullYear()-e.getFullYear()}_getMonthsDiff(e,t){return 12*(t.getFullYear()-e.getFullYear())+t.getMonth()-e.getMonth()}_getDateDiff(e,t,i,s){let r=0;switch("year"!==i&&"month"!==i&&(r=t.valueOf()-e.valueOf()),i){case"year":r=this._getYearsDiff(e,t);break;case"month":r=this._getMonthsDiff(e,t);break;case"day":r/=864e5;break;case"hour":r/=36e5;break;case"minute":r/=6e4;break;case"second":r/=1e3}return"year"!==i&&"month"!==i&&!1!==s&&(r=this.renderer._rnd(r,1,!0)),r}_getBestDTUnit(e,t,i,s,r){let a="day",l=t.valueOf()-e.valueOf();a=l<1e3?"second":l<36e5?"minute":l<864e5?"hour":l<2592e6?"day":l<31104e6?"month":"year";let n=[{key:"year",cnt:l/31536e6},{key:"month",cnt:l/2592e6},{key:"day",cnt:l/864e5},{key:"hour",cnt:l/36e5},{key:"minute",cnt:l/6e4},{key:"second",cnt:l/1e3},{key:"millisecond",cnt:l}],o=-1;for(let e=0;e<n.length;e++)if(n[e].key===a){o=e;break}let h=-1,d=-1;for(;o<n.length&&!(n[o].cnt/100>s);o++){let a=this._estAxisInterval(e,t,i,s,n[o].key,r),l=this._getDTIntCnt(e,t,a,n[o].key);(-1===h||h<l)&&(h=l,d=o)}return a=n[d].key,a}_getXAxisStats(e,t,i){let s=this._getDataLen(e),r="date"===t.type||"time"===t.type;if(r&&!this._autoDateFormats){this._autoDateFormats||(this._autoDateFormats=[]);let e=this._testXAxisDateFormat();e&&this._autoDateFormats.push(e)}let a=r?this._castAsDate(t.minValue,t.dateFormat):this._castAsNumber(t.minValue),l=r?this._castAsDate(t.maxValue,t.dateFormat):this._castAsNumber(t.maxValue);if(this._selectorRange&&this._selectorRange[e]){let i=this._selectorRange[e].min;isNaN(i)||(a=r?this._castAsDate(i,t.dateFormat):this._castAsNumber(i));let s=this._selectorRange[e].max;isNaN(s)||(l=r?this._castAsDate(s,t.dateFormat):this._castAsNumber(s))}let n,o,h=a,d=l,u=void 0===t.type||null===t.type||"auto"===t.type,g=u||"basic"===t.type,f=0,p=0;for(let i=0;i<s&&t.dataField;i++){let s=this._getDataValue(i,t.dataField,e);s=r?this._castAsDate(s,t.dateFormat):this._castAsNumber(s),isNaN(s)||(r?f++:p++,(isNaN(n)||s<n)&&(n=s),(isNaN(o)||s>=o)&&(o=s))}u&&(!r&&p===s||r&&f===s)&&(g=!1),g&&(n=0,o=Math.max(0,s-1)),isNaN(h)&&(h=n),isNaN(d)&&(d=o),r?(this._isDate(h)||(h=this._isDate(d)?d:new Date),this._isDate(d)||(d=this._isDate(h)?h:new Date)):(isNaN(h)&&(h=0),isNaN(d)&&(d=g?Math.max(0,s-1):h)),null==n&&(n=h),null==o&&(o=d);let c,m,y=t.rangeSelector&&t.rangeSelector.visible;if(y){let e=y.minValue||h;e&&r&&(e=this._castAsDate(e,y.dateFormat||t.dateFormat));let i=y.maxValue||d;i&&r&&(i=this._castAsDate(i,y.dateFormat||t.rangeSelector)),h<e&&(h=e),d<e&&(d=i),h>i&&(h=e),d>i&&(d=i)}r&&(c=t.baseUnit,c||(c=this._getBestDTUnit(h,d,e,i)),m="hour"===c||"minute"===c||"second"===c||"millisecond"===c);let _=!0===t.logarithmicScale,x=t.logarithmicScaleBase;(isNaN(x)||x<=1)&&(x=10);let v=t.unitInterval;_?v=1:(isNaN(v)||v<=0)&&(v=this._estAxisInterval(h,d,e,i,c));let b,N,M={min:h,max:d},A=this.seriesGroups[e];return _?(h||(h=1,d&&h>d&&(h=d)),d||(d=h),M={min:h,max:d},b=this.renderer._rnd(this._draw.log(h,x),1,!1),N=this.renderer._rnd(this._draw.log(d,x),1,!0),d=Math.pow(x,N),h=Math.pow(x,b)):r||!A.polar&&!A.spider||(h=this.renderer._rnd(h,v,!1),d=this.renderer._rnd(d,v,!0)),{min:h,max:d,logAxis:{enabled:_,base:x,minPow:b,maxPow:N},dsRange:{min:n,max:o},filterRange:M,useIndeces:g,isDateTime:r,isTimeUnit:m,dateTimeUnit:c,interval:v}}_getDefaultDTFormatFn(e){let t,i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return t="year"===e||"month"===e||"day"===e?function(e){return e.getDate()+"-"+i[e.getMonth()]+"-"+e.getFullYear()}:function(e){return e.getDate()+"-"+i[e.getMonth()]+"-"+e.getFullYear()+"<br>"+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()},t}_getDTIntCnt(e,t,i,s){let r=0,a=new Date(e),l=new Date(t);if(l=l.valueOf(),i<=0)return 1;for(;a.valueOf()<l;)"millisecond"===s?a=new Date(a.valueOf()+i):"second"===s?a=new Date(a.valueOf()+1e3*i):"minute"===s?a=new Date(a.valueOf()+6e4*i):"hour"===s?a=new Date(a.valueOf()+6e4*i*24):"day"===s?a.setDate(a.getDate()+i):"month"===s?a.setMonth(a.getMonth()+i):"year"===s&&a.setFullYear(a.getFullYear()+i),r++;return r}_estAxisInterval(e,t,i,s,r,a){if(isNaN(e)||isNaN(t))return NaN;let l=[1,2,5,10,15,20,50,100,200,500],n=0,o=s/(!isNaN(a)&&a>0?a:50);if(this._renderData&&this._renderData.length>i&&this._renderData[i].xAxis&&!isNaN(this._renderData[i].xAxis.avgWidth)){let e=Math.max(1,this._renderData[i].xAxis.avgWidth);0!==e&&isNaN(a)&&(o=.9*s/e)}if(o<=1)return Math.abs(t-e);let h,d=0;for(;h=n>=l.length?Math.pow(10,3+n-l.length):l[n],d=this._isDate(e)&&this._isDate(t)?this._getDTIntCnt(e,t,h,r):(t-e)/h,!(d<=o);)n++;let u=this.seriesGroups[i];return(u.spider||u.polar)&&2*h>t-e&&(h=t-e),h}_getPaddingSize(e,t,i,s,r,a,l){var n=e.min,o=e.max;e.logAxis.enabled&&(n=e.logAxis.minPow,o=e.logAxis.maxPow);var h=e.interval,d=e.dateTimeUnit;if(r){var u=s/Math.max(1,o-n+h)*h;return a?{left:0,right:u}:i?{left:0,right:0}:{left:u/2,right:u/2}}if(i&&!l)return{left:0,right:0};if(this._isDate(n)&&this._isDate(o)){var g,f=this._getDTIntCnt(n,o,Math.min(h,o-n),d);return{left:(g=s/Math.max(2,f))/2,right:g/2}}if(1===(f=Math.max(1,o-n))){const e=s/4;return{left:e,right:e}}return{left:(g=s/(f+1))/2,right:g/2}}_calculateXOffsets(e,t){var i=this.seriesGroups[e],s=this._getXAxis(e),r=[],a=[],l=this._getDataLen(e),n=this._getXAxisStats(e,s,t),o=n.min,h=n.max,d=n.isDateTime,u=n.isTimeUnit,g=this._hasColumnSeries(),f=i.polar||i.spider,p=this._get([i.startAngle,i.minAngle,0]),c=this._get([i.endAngle,i.maxAngle,360]),m=f&&!(Math.abs(Math.abs(c-p)-360)>1e-4),y=this._alignValuesWithTicks(e),_=this._getPaddingSize(n,s,y,t,f,m,g),x=h-o,v=n.filterRange;0===x&&(x=1);var b=t-_.left-_.right;f&&y&&!m&&(_.left=_.right=0);var N=-1,M=-1;for(let t=0;t<l;t++){var A=void 0===s.dataField?t:this._getDataValue(t,s.dataField,e);if(n.useIndeces){if(t<v.min||t>v.max){r.push(NaN),a.push(void 0);continue}if(S=_.left+(t-o)/x*b,!0===n.logAxis.enabled){var w=n.logAxis.base;S=this._smartPlot.scale(A,{min:o.valueOf(),max:h.valueOf(),type:"logarithmic",base:w},{min:0,max:b,flip:!1})}r.push(this.renderer._ptrnd(S)),a.push(A),-1===N&&(N=t),(-1===M||M<t)&&(M=t)}else if(A=d?this._castAsDate(A,s.dateFormat):this._castAsNumber(A),isNaN(A)||A<v.min||A>v.max)r.push(NaN),a.push(void 0);else{var S=0;if(!0===n.logAxis.enabled){w=n.logAxis.base;S=this._smartPlot.scale(A,{min:o.valueOf(),max:h.valueOf(),type:"logarithmic",base:w},{min:0,max:b,flip:!1})}else S=!d||d&&u?(A-o)*b/x:(A.valueOf()-o.valueOf())/(h.valueOf()-o.valueOf())*b;S=this.renderer._ptrnd(_.left+S),r.push(S),a.push(A),-1===N&&(N=t),(-1===M||M<t)&&(M=t)}}if(!0===s.flip)for(let e=0;e<r.length;e++)isNaN(r[e])||(r[e]=t-r[e]);(u||d)&&(x=this._getDateDiff(o,h,s.baseUnit),x=this.renderer._rnd(x,1,!1));var C=Math.max(1,x),k=b/C;return N===M&&1===C&&(r[N]=_.left+b/2),{axisStats:n,data:r,xvalues:a,first:N,last:M,length:-1===M?0:M-N+1,itemWidth:k,intervalWidth:k*n.interval,rangeLength:x,useIndeces:n.useIndeces,padding:_,axisSize:b}}_getXAxis(e){return null==e||this.seriesGroups.length<=e?this.xAxis:this.seriesGroups[e].xAxis||this.xAxis}_isGreyScale(e,t){let i=this.seriesGroups[e],s=i.series[t];return!0===s.greyScale||!1!==s.greyScale&&(!0===i.greyScale||!1!==i.greyScale&&!0===this.greyScale)}_getSeriesColors(e,t,i){let s=this._getSeriesColorsInternal(e,t,i);if(this._isGreyScale(e,t))for(let e in s)s[e]=this._draw.toGreyScale(s[e]);return s}_getColorFromScheme(e,t,i){let s="#000000",r=this.seriesGroups[e],a=r.series[t];if(this._isPieGroup(e)){let l=this._getDataLen(e);s=this._getItemColorFromScheme(a.colorScheme||r.colorScheme||this.colorScheme,t*l+i,e,t)}else{let i=0;for(let s=0;s<=e;s++)for(let r=0;r<this.seriesGroups[s].series.length&&(s!==e||parseInt(r)!==t);r++)i++;let a=this.colorScheme;if(r.colorScheme&&(a=r.colorScheme),null!=a&&""!==a||(a=this.colorSchemes[0].name),!a)return s;for(let e=0;e<this.colorSchemes.length;e++){let t=this.colorSchemes[e];if(t.name===a){for(;i>t.colors.length;)i-=t.colors.length,++e>=this.colorSchemes.length&&(e=0),t=this.colorSchemes[e];s=t.colors[i%t.colors.length]}}}return s}_createColorsCache(){this._colorsCache={get:function(e){if(this._store[e])return this._store[e]},set:function(e,t){this._size<1e4&&(this._store[e]=t,this._size++)},clear:function(){this._store={},this._size=0},_size:0,_store:{}}}_getSeriesColorsInternal(e,t,i){let s=this.seriesGroups[e],r=s.series[t];"function"===(r.colorFunction,!1)&&"pie"!==s.type&&"donut"!==s.type&&(i=NaN);let a=e+"_"+t+"_"+(isNaN(i)?"NaN":i);if(this._colorsCache.get(a))return this._colorsCache.get(a);let l,n={lineColor:"#222222",lineColorSelected:"#151515",lineColorSymbol:"#222222",lineColorSymbolSelected:"#151515",fillColor:"#222222",fillColorSelected:"#333333",fillColorSymbol:"#222222",fillColorSymbolSelected:"#333333",fillColorAlt:"#222222",fillColorAltSelected:"#333333"};if("function"==typeof r.colorFunction){let t=isNaN(i)?NaN:this._getDataValue(i,r.dataField,e);if(-1!==s.type.indexOf("range")&&!isNaN(i)){t={from:this._getDataValue(i,r.dataFieldFrom,e),to:this._getDataValue(i,r.dataFieldTo,e)}}if(l=r.colorFunction(t,i,r,s),"object"==typeof l)for(let e in l)n[e]=l[e];else n.fillColor=l}else{for(let e in n)r[e]&&(n[e]=r[e]);r.fillColor||r.color?r.fillColor=r.fillColor||r.color:n.fillColor=this._getColorFromScheme(e,t,i)}let o={fillColor:{baseColor:"fillColor",adjust:1},fillColorSelected:{baseColor:"fillColor",adjust:1.1},fillColorSymbol:{baseColor:"fillColor",adjust:1},fillColorSymbolSelected:{baseColor:"fillColorSymbol",adjust:2},fillColorAlt:{baseColor:"fillColor",adjust:4},fillColorAltSelected:{baseColor:"fillColor",adjust:3},lineColor:{baseColor:"fillColor",adjust:.95},lineColorSelected:{baseColor:"lineColor",adjust:.95},lineColorSymbol:{baseColor:"lineColor",adjust:1},lineColorSymbolSelected:{baseColor:"lineColorSelected",adjust:1}};for(let e in n)"object"==typeof l&&l[e]||r[e]&&(n[e]=r[e]);for(let e in n)"object"==typeof l&&l[e]||r[e]||(n[e]=this.renderer.adjustColor(n[o[e].baseColor],o[e].adjust));return this._colorsCache.set(a,n),n}_getItemColorFromScheme(e,t,i,s){let r;for(void 0!==e&&""!==e||(e=this.colorSchemes[0].name),r=0;r<this.colorSchemes.length&&e!==this.colorSchemes[r].name;r++);let a=0;for(;a<=t;){r===this.colorSchemes.length&&(r=0);let e=this.colorSchemes[r].colors.length;if(!(a+e<=t)){let e=this.colorSchemes[r].colors[t-a];return this._isGreyScale(i,s)&&0===e.indexOf("#")&&(e=this._draw.toGreyScale(e)),e}a+=e,r++}}getColorScheme(e){for(let t=0;t<this.colorSchemes.length;t++)if(this.colorSchemes[t].name===e)return this.colorSchemes[t].colors}addColorScheme(e,t){for(let i=0;i<this.colorSchemes.length;i++)if(this.colorSchemes[i].name===e)return void(this.colorSchemes[i].colors=t);this.colorSchemes.push({name:e,colors:t})}removeColorScheme(e){for(let t=0;t<this.colorSchemes.length;t++)if(this.colorSchemes[t].name===e){this.colorSchemes.splice(t,1);break}}_formatValue(e,t,i,s,r,a){if(null==e)return"";if(this._isObject(e)&&!this._isDate(e)&&!i)return"";if(i){if("function"!=typeof i)return e.toString();try{return i(e,a,r,s)}catch(e){return e.message}}return this._isNumber(e)?this._formatNumber(e,t):this._isDate(e)?this._formatDate(e,t):t?(t.prefix||"")+e.toString()+(t.sufix||""):e.toString()}_getFormattedValue(e,t,i,s,r,a){let l=this.seriesGroups[e],n=l.series[t],o="",h=s,d=r;n.labels&&(h=h||this._getFormatSettings(n.labels),d=d||n.labels.formatFunction),h||d||(h=this._getFormatSettings(n),d=n.formatFunction,h||d||(h=this._getFormatSettings(l),d=l.formatFunction));let u={},g=0;for(let t in n)0===t.indexOf("dataField")&&(u[t.substring(9).toLowerCase()]=this._getDataValue(i,n[t],e),g++);if(0===g&&(u=this._getDataValue(i,void 0,e)),-1!==l.type.indexOf("waterfall")&&this._isSummary(e,i)&&(u=this._renderData[e].offsets[t][i].value,g=0),d&&"function"==typeof d)try{return d(1===g?u[""]:u,i,n,l)}catch(e){return e.message}if(1===g&&this._isPieGroup(e))return this._formatValue(u[""],h,d,e,t,i);if(g>0){let s=0;for(let r in u){s>0&&""!==o&&(o+="<br>");let l="dataField"+(r.length>0?r.substring(0,1).toUpperCase()+r.substring(1):""),g=n["displayText"+(r.length>0?r.substring(0,1).toUpperCase()+r.substring(1):"")]||n[l],f=u[r];void 0!==f&&(f=this._formatValue(f,h,d,e,t,i),o+=!0===a?f:g+": "+f,s++)}}else null!=u&&(o=this._formatValue(u,h,d,e,t,i));return o||""}_isNumberAsString(e){if("string"!=typeof e)return!1;e=e.trim();for(let t=0;t<e.length;t++){let i=e.charAt(t);if(!(i>="0"&&i<="9"||","===i||"."===i)&&(("-"!==i||0!==t)&&!("("===i&&0===t||")"===i&&t===e.length-1)))return!1}return!0}_castAsDate(e,t){if(e instanceof Date&&!isNaN(e))return e;if("string"==typeof e){let i=new Date(e);if(this._isDate(i))return-1===e.indexOf(":")&&i.setHours(0,0,0,0),i;try{if(t&&(i=Smart.Utilities.DateTime.parseDateString(e,void 0,t).toDate(),this._isDate(i)))return i;if(this._autoDateFormats)for(let t=0;t<this._autoDateFormats.length;t++)if(i=Smart.Utilities.DateTime.parseDateString(e,void 0,this._autoDateFormats[t]).toDate(),this._isDate(i))return i;let s=this._detectDateFormat(e);if(s&&(i=Smart.Utilities.DateTime.parseDateString(e,void 0,s).toDate(),this._isDate(i)))return this._autoDateFormats.push(s),i}catch(e){}}}_castAsNumber(e){if(e instanceof Date&&!isNaN(e))return e.valueOf();if("string"==typeof e)if(this._isNumber(e))e=parseFloat(e);else if(!/[a-zA-Z]/.test(e)){let t=new Date(e);null!=t&&(e=t.valueOf())}return isNaN(e)?void 0:e}_isNumber(e){return"string"==typeof e&&this._isNumberAsString(e)&&(e=parseFloat(e)),"number"==typeof e&&isFinite(e)}_isDate(e){return e instanceof Date&&!isNaN(e.getDate())}_isBoolean(e){return"boolean"==typeof e}_isObject(e){return e&&("object"==typeof e||"function"==typeof e)||!1}_formatDate(e,t){let i=e.toString();return t&&(t.dateFormat&&(i=new Smart.Utilities.DateTime(e).toString(t.dateFormat)),i=(t.prefix||"")+i+(t.sufix||"")),i}_formatNumber(e,t){if(!this._isNumber(e))return e;t=t||{};let i=this.localization.decimalSeparator,s=this.localization.thousandsSeparator;t.decimalSeparator&&(i=t.decimalSeparator),t.thousandsSeparator&&(s=t.thousandsSeparator);let r=t.prefix||"",a=t.sufix||"",l=t.decimalPlaces;isNaN(l)&&(l=this._getDecimalPlaces([e],void 0,3));let n=t.negativeWithBrackets||!1,o=e<0;o&&n&&(e*=-1);let h,d=e.toString(),u=Math.pow(10,l);if(d=(Math.round(e*u)/u).toString(),isNaN(d)&&(d=""),h=d.lastIndexOf("."),l>0)for(h<0?(d+=i,h=d.length-1):"."!==i&&(d=d.replace(".",i));d.length-1-h<l;)d+="0";h=d.lastIndexOf(i),h=h>-1?h:d.length;let g=d.substring(h),f=0;for(let e=h;e>0;e--,f++)f%3==0&&e!==h&&(!o||e>1||o&&n)&&(g=s+g),g=d.charAt(e-1)+g;return d=g,o&&n&&(d="("+d+")"),r+d+a}_calculateControlPoints(e,t){let i=e[t],s=e[t+1],r=e[t+2],a=e[t+3],l=e[t+4],n=e[t+5],o=Math.sqrt(Math.pow(r-i,2)+Math.pow(a-s,2)),h=o+Math.sqrt(Math.pow(l-r,2)+Math.pow(n-a,2));0===h&&(h=1);let d=.4*o/h,u=.4-d;return[r+d*(i-l),a+d*(s-n),r-u*(i-l),a-u*(s-n)]}_getBezierPoints(e){let t="",i=[],s=[],r=e.split(" ");for(let e=0;e<r.length;e++){let t=r[e].split(",");i.push(parseFloat(t[0])),i.push(parseFloat(t[1])),!isNaN(i[i.length-1])&&isNaN(i[i.length-2])}let a=i.length;if(a<=1)return"";if(2===a)return t="M"+this.renderer._ptrnd(i[0])+","+this.renderer._ptrnd(i[1])+" L"+this.renderer._ptrnd(i[0]+1)+","+this.renderer._ptrnd(i[1]+1)+" ",t;for(let e=0;e<a-4;e+=2)s=s.concat(this._calculateControlPoints(i,e));for(let e=2;e<a-5;e+=2)t+=" C"+this.renderer._ptrnd(s[2*e-2])+","+this.renderer._ptrnd(s[2*e-1])+" "+this.renderer._ptrnd(s[2*e])+","+this.renderer._ptrnd(s[2*e+1])+" "+this.renderer._ptrnd(i[e+2])+","+this.renderer._ptrnd(i[e+3])+" ";return t=a<=4||Math.abs(i[0]-i[2])<3||Math.abs(i[1]-i[3])<3?"M"+this.renderer._ptrnd(i[0])+","+this.renderer._ptrnd(i[1])+" L"+this.renderer._ptrnd(i[2])+","+this.renderer._ptrnd(i[3])+" "+t:"M"+this.renderer._ptrnd(i[0])+","+this.renderer._ptrnd(i[1])+" Q"+this.renderer._ptrnd(s[0])+","+this.renderer._ptrnd(s[1])+" "+this.renderer._ptrnd(i[2])+","+this.renderer._ptrnd(i[3])+" "+t,a>=4&&(Math.abs(i[a-2]-i[a-4])<3||Math.abs(i[a-1]-i[a-3])<3)?t+=" L"+this.renderer._ptrnd(i[a-2])+","+this.renderer._ptrnd(i[a-1])+" ":a>=5&&(t+=" Q"+this.renderer._ptrnd(s[2*a-10])+","+this.renderer._ptrnd(s[2*a-9])+" "+this.renderer._ptrnd(i[a-2])+","+this.renderer._ptrnd(i[a-1])+" "),t}_createAnimationGroup(e){this._animGroups||(this._animGroups={}),this._animGroups[e]={animations:[],startTick:NaN}}_startAnimation(e){let t=(new Date).getTime();this._animGroups[e].startTick=t,this._runAnimation(),this._enableAnimTimer()}_enqueueAnimation(e,t,i,s,r,a,l){s<0&&(s=0),void 0===l&&(l="easeInOutSine"),this._animGroups[e].animations.push({key:t,properties:i,duration:s,fn:r,context:a,easing:l})}_stopAnimations(){clearTimeout(this._animtimer),this._animtimer=void 0,this._animGroups=void 0}_enableAnimTimer(){if(!this._animtimer){let e=this;this._animtimer=setTimeout((function(){e._runAnimation()}),this._animTickInt)}}_runAnimation(){if(this._animGroups){let e=(new Date).getTime(),t={};for(let i in this._animGroups){let s=this._animGroups[i].animations,r=this._animGroups[i].startTick,a=0;for(let t=0;t<s.length;t++){let i=s[t],l=e-r;i.duration>a&&(a=i.duration);let n=i.duration>0?l/i.duration:1,o=n;if(i.easing&&0!==i.duration&&!1!==i.duration&&(o=Smart.Utilities.Animation.Easings[i.easing](l,0,1,i.duration)),n>1&&(n=1,o=1),i.fn){i.fn(i.key,i.context,o);continue}let h={};for(let e=0;e<i.properties.length;e++){let t=i.properties[e],s=0;s=1===n?t.to:o*(t.to-t.from)+t.from,h[t.key]=s}this.renderer.attr(i.key,h)}r+a>e&&(t[i]={startTick:r,animations:s})}this._animGroups=t,this.renderer instanceof Smart.Utilities.HTML5Renderer&&this.renderer.refresh()}this._animtimer=null,Object.values(this._animGroups).length>0&&this._enableAnimTimer()}_fixCoords(e,t){if(!("horizontal"===this.seriesGroups[t].orientation))return e;var i=e.x;e.x=e.y,e.y=i+this._plotRect.y-this._plotRect.x;i=e.width;return e.width=e.height,e.height=i,e}getItemCoord(e,t,i){if(this._isPieGroup(e)&&(!this._isSerieVisible(e,t,i)||!this._renderData||this._renderData.length<=e))return{x:NaN,y:NaN};if(!this._isSerieVisible(e,t)||!this._renderData||this._renderData.length<=e)return{x:NaN,y:NaN};var s=this.seriesGroups[e],r=s.series[t],a=this._getItemCoord(e,t,i);if(this._isPieGroup(e)){if(isNaN(a.x)||isNaN(a.y)||isNaN(a.fromAngle)||isNaN(a.toAngle))return{x:NaN,y:NaN};var l=this._plotRect,n=a.fromAngle*(Math.PI/180),o=a.toAngle*(Math.PI/180);const e=l.x+a.center.x+Math.cos(n)*a.outerRadius,t=l.x+a.center.x+Math.cos(o)*a.outerRadius,i=l.y+a.center.y-Math.sin(n)*a.outerRadius,s=l.y+a.center.y-Math.sin(o)*a.outerRadius;var h=Math.min(e,t),d=Math.abs(t-e);return a={x:h,y:Math.min(i,s),width:d,height:Math.abs(s-i),center:a.center,centerOffset:a.centerOffset,innerRadius:a.innerRadius,outerRadius:a.outerRadius,selectedRadiusChange:a.selectedRadiusChange,fromAngle:a.fromAngle,toAngle:a.toAngle}}if(-1!==s.type.indexOf("column")||-1!==s.type.indexOf("waterfall")){var u=this._getColumnSerieWidthAndOffset(e,t);a.height=Math.abs(a.y.to-a.y.from),a.y=Math.min(a.y.to,a.y.from),a.x+=u.offset,a.width=u.width}else if(-1!==s.type.indexOf("ohlc")||-1!==s.type.indexOf("candlestick")){u=this._getColumnSerieWidthAndOffset(e,t);let i=a.y;var g=Math.min(i.Open,i.Close,i.Low,i.High),f=Math.max(i.Open,i.Close,i.Low,i.High);a.height=Math.abs(f-g),a.y=g,a.x+=u.offset,a.width=u.width}else if(-1!==s.type.indexOf("line")||-1!==s.type.indexOf("area"))a.width=a.height=0,a.y=a.y.to;else if(-1!==s.type.indexOf("bubble")||-1!==s.type.indexOf("scatter")){a.center={x:a.x,y:a.y.to};var p=a.y.radius;"circle"!==r.symbolType&&void 0!==r.symbolType&&null!==r.symbolType&&(p/=2),a.y=a.y.to,a.radius=p,a.width=2*p,a.height=2*p}if(a=this._fixCoords(a,e),s.polar||s.spider){var c=this._toPolarCoord(this._renderData[e].polarCoords,this._plotRect,a.x,a.y);a.x=c.x,a.y=c.y,a.center&&(a.center=this._toPolarCoord(this._renderData[e].polarCoords,this._plotRect,a.center.x,a.center.y))}return-1===s.type.indexOf("bubble")&&-1===s.type.indexOf("scatter")||(a.x-=p,a.y-=p),a}_getItemCoord(e,t,i){let s,r,a=this.seriesGroups[e];if(!a||!this._renderData)return{x:NaN,y:NaN};if(!a.series[t])return{x:NaN,y:NaN};let l=this._plotRect;if(this._isPieGroup(e)){let a=this._renderData[e].offsets[t][i];if(!a)return{x:NaN,y:NaN};let n=(a.fromAngle+a.toAngle)/2*(Math.PI/180);return s=l.x+a.x+Math.cos(n)*a.outerRadius,r=l.y+a.y-Math.sin(n)*a.outerRadius,{x:s,y:r,center:{x:a.x,y:a.y},centerOffset:a.centerOffset,innerRadius:a.innerRadius,outerRadius:a.outerRadius,selectedRadiusChange:a.selectedRadiusChange,fromAngle:a.fromAngle,toAngle:a.toAngle}}if(s=l.x+this._renderData[e].xoffsets.data[i],r=this._renderData[e].offsets[t][i],isNaN(s)||!r)return{x:NaN,y:NaN};let n={};for(let e in r)n[e]=r[e];return{x:s,y:n}}getXAxisValue(e,t){var i=this.seriesGroups[t];if(i){var s=this._getXAxis(t),r=this._plotRect,a=0,l=NaN,n=this._renderData[0].xoffsets.axisStats,o=0,h=0;if(i.polar||i.spider){if(isNaN(e.x)||isNaN(e.y))return NaN;var d=this._getPolarAxisCoords(t,r);if(this.renderer._ptdist(e.x,e.y,d.x,d.y)>d.r)return NaN;var u=Math.atan2(d.y-e.y,e.x-d.x);(u=Math.PI/2-u)<0&&(u=2*Math.PI+u),l=u*d.r;var g=d.startAngle+Math.PI/2,f=d.endAngle+Math.PI/2;o=g*d.r,h=f*d.r,a=(f-g)*d.r;var p=this._getPaddingSize(n,s,s.valuesOnTicks,a,!0,d.isClosedCircle,this._hasColumnSeries());d.isClosedCircle?(a-=p.left+p.right,h-=p.left+p.right):s.valuesOnTicks||(o+=p.left,h-=p.right)}else{if("horizontal"!==i.orientation){if(e<r.x||e>r.x+r.width)return NaN;l=e-r.x,a=r.width}else{if(e<r.y||e>r.y+r.height)return NaN;l=e-r.y,a=r.height}if(this._renderData[t]&&this._renderData[t].xoffsets)a-=(p=this._renderData[t].xoffsets.padding).left+p.right,l-=p.left;h=a}return this._smartPlot.scale(l,{min:o,max:h},{min:n.min.valueOf(),max:n.max.valueOf(),type:n.logAxis.enabled?"logarithmic":"linear",base:n.logAxis.base,flip:s.flip})}}getValueAxisValue(e,t){let i=this.seriesGroups[t];if(!i)return;let s=this._getValueAxis(t),r=this._plotRect,a=0,l=NaN;if(i.polar||i.spider){if(isNaN(e.x)||isNaN(e.y))return NaN;let i=this._getPolarAxisCoords(t,r);l=this.renderer._ptdist(e.x,e.y,i.x,i.y),a=i.r,l=a-l}else if("horizontal"===i.orientation){if(e<r.x||e>r.x+r.width)return NaN;l=e-r.x,a=r.width}else{if(e<r.y||e>r.y+r.height)return NaN;l=e-r.y,a=r.height}let n=this._stats.seriesGroups[t];return this._smartPlot.scale(l,{min:0,max:a},{min:n.min.valueOf(),max:n.max.valueOf(),type:n.logarithmic?"logarithmic":"linear",base:n.logBase,flip:!s.flip})}_detectDateFormat(e,t){let i={en_US_d:"M/d/yyyy",en_US_D:"dddd, MMMM dd, yyyy",en_US_t:"h:mm tt",en_US_T:"h:mm:ss tt",en_US_f:"dddd, MMMM dd, yyyy h:mm tt",en_US_F:"dddd, MMMM dd, yyyy h:mm:ss tt",en_US_M:"MMMM dd",en_US_Y:"yyyy MMMM",en_US_S:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",en_CA_d:"dd/MM/yyyy",en_CA_D:"MMMM-dd-yy",en_CA_f:"MMMM-dd-yy h:mm tt",en_CA_F:"MMMM-dd-yy h:mm:ss tt",ISO:"yyyy-MM-dd hh:mm:ss",ISO2:"yyyy-MM-dd HH:mm:ss",d1:"dd.MM.yyyy",d2:"dd-MM-yyyy",zone1:"yyyy-MM-ddTHH:mm:ss-HH:mm",zone2:"yyyy-MM-ddTHH:mm:ss+HH:mm",custom:"yyyy-MM-ddTHH:mm:ss.fff",custom2:"yyyy-MM-dd HH:mm:ss.fff",de_DE_d:"dd.MM.yyyy",de_DE_D:"dddd, d. MMMM yyyy",de_DE_t:"HH:mm",de_DE_T:"HH:mm:ss",de_DE_f:"dddd, d. MMMM yyyy HH:mm",de_DE_F:"dddd, d. MMMM yyyy HH:mm:ss",de_DE_M:"dd MMMM",de_DE_Y:"MMMM yyyy",fr_FR_d:"dd/MM/yyyy",fr_FR_D:"dddd d MMMM yyyy",fr_FR_t:"HH:mm",fr_FR_T:"HH:mm:ss",fr_FR_f:"dddd d MMMM yyyy HH:mm",fr_FR_F:"dddd d MMMM yyyy HH:mm:ss",fr_FR_M:"d MMMM",fr_FR_Y:"MMMM yyyy",it_IT_d:"dd/MM/yyyy",it_IT_D:"dddd d MMMM yyyy",it_IT_t:"HH:mm",it_IT_T:"HH:mm:ss",it_IT_f:"dddd d MMMM yyyy HH:mm",it_IT_F:"dddd d MMMM yyyy HH:mm:ss",it_IT_M:"dd MMMM",it_IT_Y:"MMMM yyyy",ru_RU_d:"dd.MM.yyyy",ru_RU_D:"d MMMM yyyy '?.'",ru_RU_t:"H:mm",ru_RU_T:"H:mm:ss",ru_RU_f:"d MMMM yyyy '?.' H:mm",ru_RU_F:"d MMMM yyyy '?.' H:mm:ss",ru_RU_Y:"MMMM yyyy",cs_CZ_d:"d.M.yyyy",cs_CZ_D:"d. MMMM yyyy",cs_CZ_t:"H:mm",cs_CZ_T:"H:mm:ss",cs_CZ_f:"d. MMMM yyyy H:mm",cs_CZ_F:"d. MMMM yyyy H:mm:ss",cs_CZ_M:"dd MMMM",cs_CZ_Y:"MMMM yyyy",he_IL_d:"dd MMMM yyyy",he_IL_D:"dddd dd MMMM yyyy",he_IL_t:"HH:mm",he_IL_T:"HH:mm:ss",he_IL_f:"dddd dd MMMM yyyy HH:mm",he_IL_F:"dddd dd MMMM yyyy HH:mm:ss",he_IL_M:"dd MMMM",he_IL_Y:"MMMM yyyy",hr_HR_d:"d.M.yyyy.",hr_HR_D:"d. MMMM yyyy.",hr_HR_t:"H:mm",hr_HR_T:"H:mm:ss",hr_HR_f:"d. MMMM yyyy. H:mm",hr_HR_F:"d. MMMM yyyy. H:mm:ss",hr_HR_M:"d. MMMM",hu_HU_d:"yyyy.MM.dd.",hu_HU_D:"yyyy. MMMM d.",hu_HU_t:"H:mm",hu_HU_T:"H:mm:ss",hu_HU_f:"yyyy. MMMM d. H:mm",hu_HU_F:"yyyy. MMMM d. H:mm:ss",hu_HU_M:"MMMM d.",hu_HU_Y:"yyyy. MMMM",jp_JP_d:"gg y/M/d",jp_JP_D:"gg y'?'M'?'d'?'",jp_JP_t:"H:mm",jp_JP_T:"H:mm:ss",jp_JP_f:"gg y'?'M'?'d'?' H:mm",jp_JP_F:"gg y'?'M'?'d'?' H:mm:ss",jp_JP_M:"M'?'d'?'",jp_JP_Y:"gg y'?'M'?'",lt_LT_d:"yyyy.MM.dd",lt_LT_D:"yyyy 'm.' MMMM d 'd.'",lt_LT_t:"HH:mm",lt_LT_T:"HH:mm:ss",lt_LT_f:"yyyy 'm.' MMMM d 'd.' HH:mm",lt_LT_F:"yyyy 'm.' MMMM d 'd.' HH:mm:ss",lt_LT_M:"MMMM d 'd.'",lt_LT_Y:"yyyy 'm.' MMMM",sa_IN_d:"dd-MM-yyyy",sa_IN_D:"dd MMMM yyyy dddd",sa_IN_t:"HH:mm",sa_IN_T:"HH:mm:ss",sa_IN_f:"dd MMMM yyyy dddd HH:mm",sa_IN_F:"dd MMMM yyyy dddd HH:mm:ss",sa_IN_M:"dd MMMM",basic_y:"yyyy",basic_ym:"yyyy-MM",basic_d:"yyyy-MM-dd",basic_dhm:"yyyy-MM-dd hh:mm",basic_bhms:"yyyy-MM-dd hh:mm:ss",basic2_ym:"MM-yyyy",basic2_d:"MM-dd-yyyy",basic2_dhm:"MM-dd-yyyy hh:mm",basic2_dhms:"MM-dd-yyyy hh:mm:ss",basic3_ym:"yyyy/MM",basic3_d:"yyyy/MM/dd",basic3_dhm:"yyyy/MM/dd hh:mm",basic3_bhms:"yyyy/MM/dd hh:mm:ss",basic4_ym:"MM/yyyy",basic4_d:"MM/dd/yyyy",basic4_dhm:"MM/dd/yyyy hh:mm",basic4_dhms:"MM/dd/yyyy hh:mm:ss"};t&&(i=Object.assign({},i,t));let s=[];Array.isArray(e)?s=e:s.push(e);for(let e in i)i[e]={format:i[e],count:0};for(let e=0;e<s.length;e++){const t=s[e];if(null!=t)for(let e in i)try{(t instanceof Date||Smart.Utilities.DateTime.parseDateString(t,void 0,i[e].format))&&i[e].count++}catch(e){}}let r={key:void 0,count:0};for(let e in i)i[e].count>r.count&&(r.key=e,r.count=i[e].count);return r.key?i[r.key].format:""}_testXAxisDateFormat(e){let t=this,i=t._getXAxis(e),s=t._getDataLen(e),r={};if(t.localization.patterns)for(let e in t.localization.patterns)r["local_"+e]=t.localization.patterns[e];let a=[];for(let r=0;r<s&&r<10;r++){const s=t._getDataValue(r,i.dataField,e);null!=s&&a.push(s)}return t._detectDateFormat(a,r)}_getThemeColor(e){if("light"===this.theme)switch(e){case"background":return"#FFFFFF";case"line":return"#BCBCBC";case"band":return"#AAAAAA"}switch(e){case"background":return"#2E2E2E";case"line":return"#707070";case"band":return"#565656"}}})}});
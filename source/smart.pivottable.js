
/* Smart UI v7.7.0 (2020-June) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function a(n){if(t[n])return t[n].exports;var l=t[n]={i:n,l:!1,exports:{}};return e[n].call(l.exports,l,l.exports,a),l.l=!0,l.exports}a.m=e,a.c=t,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)a.d(n,l,function(t){return e[t]}.bind(null,l));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=85)}({85:function(e,t){Smart("smart-pivot-table",class extends Smart.Table{static get properties(){return{columns:{value:null,type:"any?",reflectToAttribute:!1},columnReorder:{value:!1,type:"boolean"},dataSource:{value:null,type:"any?",reflectToAttribute:!1},editing:{value:!1,type:"boolean"},editMode:{value:"cell",allowedValues:["cell","row"],type:"string"},filtering:{value:!1,type:"boolean"},filterRow:{value:!1,type:"boolean"},filterTemplate:{value:null,type:"string?"},footerRow:{value:null,type:"string?"},freezeFooter:{value:!1,type:"boolean"},freezeHeader:{value:!1,type:"boolean"},grouping:{value:!1,type:"boolean"},headerRow:{value:null,type:"string?"},keyboardNavigation:{value:!1,type:"boolean"},messages:{value:{en:{groupHeader:"Group"}},type:"object",extend:!0},onCellRender:{value:null,type:"function?"},onColumnRender:{value:null,type:"function?"},onInit:{value:null,type:"function?"},pageSize:{value:10,allowedValues:[10,25,50],type:"int"},pageIndex:{value:0,type:"int"},paging:{value:!1,type:"boolean"},rowDetailTemplate:{value:null,type:"string?"},selection:{value:!1,type:"boolean"},sortMode:{value:"none",type:"string",allowedValues:["none","one","many"]}}}static get listeners(){return{resize:"_overriddenTableHandler","filterInput.keyup":"_overriddenTableHandler","pager.change":"_overriddenTableHandler","pager.pageSizeChanged":"_overriddenTableHandler","tableContainer.change":"_overriddenTableHandler","tableContainer.keyup":"_overriddenTableHandler","document.down":"_overriddenTableHandler","document.move":"_overriddenTableHandler","document.up":"_overriddenTableHandler"}}template(){return'<div id="container" class="smart-container" role="presentation">\n                    <table id="tableContainer" class="smart-table-container"></table>\n                </div>'}clearFilters(){this._filterInfo.appliedFilters&&(delete this._filterInfo.appliedFilters,this._filterInfo.pivot=[],this.dataSource.clearFilter(),this.refresh(!0),this.$.fireEvent("filter",{action:"remove"}))}getDynamicColumns(){return this._dynamicColumns}sortBy(e,t){const a=this;let n;if(e){if(-1===a._dynamicColumns.indexOf(e)||0===a._rowGroupColumns.length)return;if(!1===e.dataFields[e.dataFields.length-1].originalColumn.allowSort)return;n=e.id}a._sortBy({column:e,columnDataField:n,sortOrder:t,dataFields:a._dynamicDataFields,columnByDataField:"_getDynamicColumnById"})}_sortCallback(e,t,a){const n=this.rows;n._sort(n.boundSource,e,t,a),n.refreshHierarchy(),this._createDataRows()}propertyChangedHandler(e,t,a){super.propertyChangedHandler(e,t,a)}_createElement(){const e=this;e._filterInfo={},e.$.header={offsetHeight:0},e.$.pager={offsetHeight:0},e.dataSource instanceof Smart.DataAdapter==!1&&(Array.isArray(e.dataSource)?e.dataSource=new Smart.DataAdapter({dataSource:e.dataSource}):e.dataSource=new Smart.DataAdapter({dataSource:[]})),e._initColumns(),e.refresh(!0)}_processPivotColumns(){const e=this,t=e.dataSource,a=[],n=[],l=[],r=[],o=[];for(let t=0;t<e._columns.length;t++){const i=e._columns[t];i.pivot&&i.allowPivot&&(a.push(i),r.push(i.dataField)),i.rowGroup&&i.allowRowGroup&&(n.push(i),o.push(i.dataField)),i.summary&&l.push(i)}t.groupBy=r,t.refreshHierarchy(),e._primaryHierarchy=t.boundHierarchy,e._groupByPrimary=r,e._groupBySecondary=o,e._pivotColumns=a,e._rowGroupColumns=n,e._aggregateColumns=l}refresh(e){const t=this,a=t.isRendered;a&&(t.$.tableContainer.innerHTML=""),t._processPivotColumns(),t._createHeader(),e&&t._createAggregatesSource(),t._createDataRows(!0);const n=t._sortColumns;a&&e&&n&&(delete t._sortColumns,n.forEach(e=>{const a=t._getDynamicColumnById[e.dataField];a&&t.sortBy(a,e.direction)}))}_createHeader(){const e=this,t=e.selection,a=e.onColumnRender,n=document.createElement("thead"),l=document.createDocumentFragment(),r=[],o=parseFloat(getComputedStyle(e.$.container).getPropertyValue("--smart-pivot-table-cell-width")),i=e._rowGroupColumns.length>0;function d(t,a){const n=e._aggregateColumns;return void 0===r[t]&&(r[t]=[]),n.forEach(e=>{r[t].push(`${a}立${e.summary}(${e.label})`)}),n.length}!function t(a,n,l){void 0===r[n]&&(r[n]=[]);let o=0;for(let i=0;i<a.length;i++){const s=a[i],c=l+"."+i;let u=0;e._filterInfo.appliedFilters&&e._filterInfo.pivot.length>0&&!1===s.data.$.filtered||(s.children&&s.children.length>0&&!0!==s.children[0].leaf?u+=t(s.children,n+1,c):u+=d(n+1,c),r[n].push(...Array(u).fill(c+"立"+s.label)),o+=u)}return o}(e._primaryHierarchy,0,"");const s=r[r.length-1].length;e._createDynamicColumnDefinitions(r,s);for(let n=0;n<r.length;n++){const d=document.createElement("tr"),c=r[n];if(t)if(n===r.length-1)d.innerHTML='<th class="smart-pivot-table-selection-header smart-table-select-all freeze-near"><div></div></th>';else{const t=document.createElement("th");0===n&&(t.style.width=getComputedStyle(e.$.container).getPropertyValue("--smart-table-row-height")),t.classList.add("smart-pivot-table-selection-header","freeze-near"),d.appendChild(t)}if(i){const t=document.createElement("th");if(t.classList.add("smart-pivot-table-grouping-header"),n===r.length-1){let n=e.localize("groupHeader"),l=e._dynamicColumns[0];if(a){const a={text:n,cell:t,column:l.dataFields[0],fullDefinition:l};e.onColumnRender(a),n=a.text}t.innerHTML=n,e._addSortingCapability(t,l)}d.appendChild(t)}const u={};for(let t=0;t<s;t++){let l=c[t],i=l.label,p=l.columnDefinition;if(void 0===i)break;const h=document.createElement("th");if(0===t||c[t-1].label!==i){if(u.cell&&(u.span>1&&(u.cell.colSpan=u.span),0===n&&(u.cell.style.width=o*u.span+"px")),u.cell=h,u.span=1,i=i.replace(/^.*立/,""),a){const t={text:i,cell:h,column:l.info,fullDefinition:p};e.onColumnRender(t),i=t.text}n===r.length-1&&e._addSortingCapability(h,p),h.innerHTML=i,d.appendChild(h)}else u.span++,t===s-1&&(u.cell.colSpan=u.span,0===n&&(u.cell.style.width=o*u.span+"px"))}l.appendChild(d)}n.appendChild(l),e.$.tableContainer.appendChild(n)}_createDynamicColumnDefinitions(e,t){const a=this,n=[],l=[],r={};for(let o=0;o<t;o++){const t={dataFields:[]},i=[];for(let n=0;n<e.length-1;n++){const l=e[n][o],r=e[n][o].replace(/^.*立/,""),d=a._pivotColumns[n],s={originalColumn:d,label:r,dataField:d.dataField};t.dataFields.push(s),i.push(r),e[n][o]={label:l,columnDefinition:t,info:s}}const d=a._aggregateColumns[o%a._aggregateColumns.length],s=e[e.length-1][o],c={originalColumn:d,label:s,dataField:d.dataField,summary:d.summary};t.dataFields.push(c),i.push(d.dataField),e[e.length-1][o]={label:s,columnDefinition:t,info:c},t.id=i.join(",").replace(/[ ,]/g,"_"),n.push(t),r[t.id]=t,l.push({name:t.id,dataType:d.dataType})}if(a._rowGroupColumns.length>0){const e=a.localize("groupHeader"),t={dataFields:a._rowGroupColumns.map(t=>({originalColumn:t,label:e})),id:"group",label:e,group:!0};let o;n.unshift(t),r.group=t;for(let e=0;e<t.dataFields.length&&(o=t.dataFields[e].originalColumn.dataType,"string"!==o);e++);l.push({name:"group",dataType:o})}a._dynamicColumns=n,a._getDynamicColumnById=r,a._dynamicDataFields=l,a.$.tableContainer.removeAttribute("aria-colcount")}_createAggregatesSource(){const e=this,t=e.dataSource,a=e._aggregateColumns,n=[],l=[],r={id:Math.random().toString(36).substr(2,7)};for(let e=0;e<a.length;e++){const t=a[e],n={};n[t.dataField]=[t.summary],l.push(n)}0===e._rowGroupColumns.length?(!function e(n,o){n.forEach(n=>{if(n.children&&n.children.length>0)if(!0!==n.children[0].leaf)e(n.children,o.concat([n.label]));else{const e=t.summarize(l,n.children);for(let t=0;t<a.length;t++){const l=a[t];r[o.concat([n.label,l.dataField]).join(",").replace(/[ ,]/g,"_")]=e[l.dataField][l.summary]}}})}(e._primaryHierarchy,[]),n.push(r)):function a(r,o,i){let d=e._getSecondaryHierarchy(r);if(o)for(let e=0;e<i.length;e++)d=d[i[e]].children;d.forEach((d,s)=>{let c=d.children.length;if(e._filterInfo.appliedFilters&&(c=e._areChildrenFiltered(void 0,d.children),!1===d.data.$.filtered&&!c))return;const u={},p=new window.Smart.DataAdapter({dataSource:d.children,dataFields:t.dataFields,groupBy:e._groupByPrimary});o&&(u.parentid=o.id),u.id=Math.random().toString(36).substr(2,7),u.level=r,u[e._dynamicColumns[0].id]=`${d.label} (${c})`,function a(n,r,o,i){n.forEach(n=>{if(n.children&&n.children.length>0&&!0!==n.children[0].leaf)a(n.children,r,o,i.concat([n.label]));else{const a=i.concat([n.label]),d=t.summarize(l,r.children);e._aggregateColumns.forEach(e=>{const t=e.dataField;o[a.concat([t]).join(",").replace(/[ ,]/g,"_")]=d[t][e.summary]})}})}(p.boundHierarchy,d,u,[]),n.push(u),r<e._groupBySecondary.length-1&&a(r+1,u,i.concat([s]))})}(0,void 0,[]),e.rows=new Smart.DataAdapter({dataSource:n,id:"id",keyDataField:"id",parentDataField:"parentid",dataFields:e._dynamicDataFields}),!e.isRendered&&e.onInit&&e.onInit()}_getSecondaryHierarchy(e){const t=this.dataSource;return t.groupBy=this._groupBySecondary.slice(0,e+1),t.refreshHierarchy(),t.boundHierarchy}_createDataRows(e){const t=this,a=t.selection,n=t._dynamicColumns,l=t.rows.boundHierarchy,r=document.createDocumentFragment();let o;l&&function e(l){for(let o=0;o<l.length;o++){const i=document.createElement("tr"),d=l[o],s=d.level;if(d.tr=i,i.data=d,a){const e=document.createElement("td"),a=-1!==t._selectedIds.indexOf(d.$.id);e.className=`smart-table-select-row freeze-near${a?" selected":""}`,e.innerHTML="<div></div>",i.appendChild(e),i.setAttribute("aria-selected",a)}for(let e=0;e<n.length;e++){const a=document.createElement("td"),l=n[e],r=d[l.id];let o,c,u=r||"";if(0===e&&l.group){const e=d.leaf;o=l.dataFields[s].originalColumn,c="group",u=t._formatCellValue(d,o,a,u),e||(a.classList.add("tree-cell"),u=`<div>\n                                        <div class="hierarchy-arrow smart-arrow smart-arrow-down"></div>\n                                        <div>${u}</div>\n                                    </div>`),s>0&&(a.classList.add("outline-level-"+s),e&&a.classList.add("tree-leaf"))}else o=l.dataFields[l.dataFields.length-1].originalColumn,c=o.dataField+e,u=t._formatCellValue(d,o,a,u);t.onCellRender&&t.onCellRender(d,l,r,a),a.setAttribute("data-field",c),a.innerHTML=u,i.appendChild(a)}d.expanded&&(i.setAttribute("aria-expanded",!0),i.classList.add("expanded")),s>0&&t._isCollapsed(d)&&(i.setAttribute("aria-hidden",!0),i.classList.add("collapsed")),i.setAttribute("row-id",d.$.id),r.appendChild(i),d.children&&e(d.children)}}(l),r.appendChild(t._createLastRow()),e?(o=document.createElement("tbody"),t.$.tableContainer.appendChild(o)):(o=t.$.tableContainer.querySelector("tbody"),o.innerHTML=""),o.appendChild(r)}_overriddenTableHandler(){}_hierarchyArrowClickHandler(e){const t="none"!==this.animation,a=e.data;let n=a.expanded,l=a.children;n?function e(t){t.forEach(t=>{const a=t.tr,n=t.children;a&&(a.setAttribute("aria-hidden",!0),a.classList.add("collapsed")),n&&e(n)})}(l):function e(a){a.forEach(a=>{const n=a.tr,l=a.children;n&&(t&&(n.classList.add("no-height"),n.ontransitionend=function(){n.classList.remove("no-height"),n.ontransitionend=null}),n.removeAttribute("aria-hidden"),n.classList.remove("collapsed")),l&&a.expanded&&e(l)})}(l),n=!n,a.expanded=n,e.setAttribute("aria-expanded",n),e.classList.toggle("expanded",n)}_addSortingCapability(e,t){const a=this;0!==a._rowGroupColumns.length&&(e.columnDefinition=t,t.headerCellElement=e,e.onclick=function(){const n=t.dataFields[t.dataFields.length-1].originalColumn;a.$.fireEvent("columnClick",{columnDefinition:t,dataField:n.dataField}),"none"!==a.sortMode&&!1!==n.allowSort&&(a._addSortIconContainer(t),e.sortIconContainerElement.classList.contains("asc")?a.sortBy(t,"desc"):e.sortIconContainerElement.classList.contains("desc")?a.sortBy(t,null):a.sortBy(t,"asc"))})}_selectAllCheckboxClickHandler(e){super._selectAllCheckboxClickHandler(e,this.rows)}_updateSelectAllState(){super._updateSelectAllState(this.rows.length)}_refreshFilters(){const e=this,t=[];e._filterInfo.pivot=[];for(let a in e._filterInfo.appliedFilters){let n=e._filterInfo.appliedFilters[a];t.push([a,n]),e._pivotColumns.find(e=>e.dataField===a)&&e._filterInfo.pivot.push(a)}0!==t.length?(e.dataSource._filter(t,"or"),e.refresh(!0),e.$.fireEvent("filter",{action:"add",filters:t})):e.clearFilters()}_areChildrenFiltered(e,t){if(1===arguments.length&&(t=e.children),!t||0===t.length)return;let a=0;for(let e=0;e<t.length;e++)!1!==t[e].$.filtered&&a++;return a}})}});

/* Smart HTML Elements v7.6.0 (2020-June) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=51)}({51:function(e,t){Smart.Utilities.Assign("Grid.Edit",class{_renderCommandBar(){const e=this,t=e.editing.commandBar.dataSource,n=n=>{for(let i in t){const o=t[i],d=document.createElement("div");d.classList.add("smart-grid-command-item"),d.label=e.localize(i),o.icon&&(d.innerHTML='<span class="smart-grid-icon '+o.icon+'"></span><span class="smart-grid-label">'+d.label+"</span>"),o.visible||d.classList.add("smart-hidden"),d.command=o.command,d.onclick=function(){const t=d.command;e._applyCommand(t,[])},n.appendChild(d)}};e.editing.enabled&&e.editing.commandBar.visible&&(e.$.headerCommandBar.innerHTML="",e.$.footerCommandBar.innerHTML="","far"!==e.editing.commandBar.position&&n(e.$.headerCommandBar),"near"!==e.editing.commandBar.position&&n(e.$.footerCommandBar))}commandKeyEditCommand(){const e=this;if(e._selection&&e._selection.focusedCell&&e._selection.focusedCell.row){const t=e._selection.focusedCell.row;e.beginEdit(t.id)}}commandKeyCancelCommand(){this.cancelEdit()}commandKeyUpdateCommand(){this.endEdit()}commandColumnMenuCommand(){this._openColumnChooserMenu(this._commandColumn)}commandColumnEditCommand(e){this.beginEdit(e.id)}commandColumnUpdateCommand(){this.endEdit()}commandColumnRowMenuCommand(){}commandColumnCancelCommand(e){const t=this;if(t.editing.batch){const n=t._rowsDeleted?t._rowsDeleted.indexOf(e):-1;n>=0&&t._rowsDeleted.splice(n,1);for(let n=0;n<t.columns.length;n++){const i=t.columns[n].dataField;t._cellsUpdatedValues&&t._cellsUpdatedValues[e.id+"_"+i]&&(delete t._cellsUpdatedValues[e.id+"_"+i],t._cellsUpdatedValues.length--)}t._recycle(!1)}t.cancelEdit()}commandColumnDeleteCommand(e){this.deleteRow(e.id)}_renderAddNewRow(){const e=this;e._frozenNearDefaultRows=[],e._frozenFarDefaultRows=[];const t=new Smart.Grid.Row({data:{},index:-1,grid:e,freeze:"near",visible:"far"!==e.editing.addNewRow.position,autoGenerated:!0,addNewRow:!0}),n=new Smart.Grid.Row({data:{},index:-2,grid:e,freeze:"far",visible:"near"!==e.editing.addNewRow.position,autoGenerated:!0,addNewRow:!0});if(e._newNearRow){const t=e._frozenNearRows.indexOf(e._newNearRow);if(t>=0&&(e._frozenNearRows.splice(t,1),e.$.rowNearContainer.children.length>0)){const t=e.$.rowNearContainer.children[0];t.parentNode.removeChild(t)}}if(e._newFarRow){const t=e._frozenFarRows.indexOf(e._newFarRow);if(t>=0&&(e._frozenFarRows.splice(t,1),e.$.rowFarContainer.children.length>0)){const t=e.$.rowFarContainer.children[e.$.rowFarContainer.children.length-1];t.parentNode.removeChild(t)}}if(e.editing.addNewRow.visible&&(e._frozenNearDefaultRows.push(t),e._frozenFarDefaultRows.push(n),e._frozenNearRows.splice(0,0,t),e._frozenFarRows.push(n)),e._scrollView.vScrollBar.$.farButton.addEventListener("click",(function(){e.editing.addNewRow.autoCreate&&e._scrollView.vScrollBar.value===e._scrollView.vScrollBar.max&&(e.addUnboundRow(1),e._scrollView.vScrollBar.value=e._scrollView.vScrollBar.max)})),e._newNearRow=t,e._newFarRow=n,e.editing.addNewRow.visible){if(!e._newNearRow.element){const t=e._newNearRow,n=t.createElement();t.visible="far"!==e.editing.addNewRow.position,t.element=n,e.$.rowNearContainer.children.length>0?e.$.rowNearContainer.insertBefore(n,e.$.rowNearContainer.children[0]):e.$.rowNearContainer.appendChild(n)}if(!e._newFarRow.element){const t=e._newFarRow,n=t.createElement();t.visible="near"!==e.editing.addNewRow.position,t.element=n,e.$.rowFarContainer.children.length>0?e.$.rowFarContainer.insertBefore(n,e.$.rowFarContainer.children[0]):e.$.rowFarContainer.appendChild(n)}}}_insertNewRowAfter(e){return this._insertNewRowBefore(e,!0)}_insertNewRowBefore(e,t){const n=this,i=new Smart.Grid.Row({index:t?0:-1,id:Smart.Utilities.Core.createGUID(),grid:n}),o=function(t,i){!0===n.editing.batch||n.editing.batch&&n.editing.batch.indexOf("add")>=0?n._batchAddRow(t,i?n.rows.length:0):(t.index=n.rows.length,n._add(t,i?n.rows.length:0)),n.scrollTop=i?n.scrollHeight:0,n.editing.addDialog.enabled||setTimeout((function(){n.editing.enabled&&n._beginEdit(t)}),100),e&&e(t)}.bind(this);return n.editing.addDialog.enabled?n._openAddRowDialog(i,o):o(i,t),!0}commandBarBatchSaveCommand(){this._saveBatchEdit()}commandBarAddRowCommand(){this._insertNewRowAfter()}commandBarAddTopRowCommand(){this._insertNewRowBefore()}commandBarDeleteRowCommand(){const e=this;let t=1,n=e.rows[e.rows.length-t];for(e._rowsDeleted||(e._rowsDeleted=[]);e._rowsDeleted.indexOf(e.rows[e.rows.length-t])>=0;)t++;n=e.rows[e.rows.length-t],n&&e.commandColumnDeleteCommand(n)}commandBarBatchRevertCommand(){this.revertBatchEdit()}_beginEdit(e,t){const n=this;t||(t=n.columns[0].dataField);const i=n.columnByDataField[t];if(n.editing.allowColumnHeaderEdit&&!e&&i)return void n._beginColumnEdit(i);if(!e||!i||i&&i.autoGenerated)return!1;const o=e.getCell(t);if(!o)return!1;"cell"===n.editing.mode?n._beginCellEdit(o):"row"===n.editing.mode&&n._beginRowEdit(e,o),n.$.fireEvent("beginEdit",{row:e,column:i,cell:o})}_saveUnboundRows(e){const t=this;if(t._unboundRows&&t._unboundRows.length>0&&t.editing.addNewRow.autoSave){const n=t.rowById[e];if(!n.unbound)return;const i=t._unboundRows.indexOf(n);if(i<0)return;const o=i+1;t.beginUpdate();for(let e=0;e<o;e++){const n=t._unboundRows[e];if(!n)continue;delete t.rowById[n.id],n.unbound=!1;let i=!1;t._selection.focusedCell&&t._selection.focusedCell.row.id===n.id&&(i=!0),t._nearRowsAdded&&t._nearRowsAdded.indexOf(n)>=0?(t._nearRowsAdded.splice(t._nearRowsAdded.indexOf(n),1),t._add(0,n.data),i&&(t._selection.focusedCell.row=t.rows[0])):t._farRowsAdded&&t._farRowsAdded.indexOf(n)>=0&&(t._farRowsAdded.splice(t._farRowsAdded.indexOf(n),1),t._add(n.data),i&&(t._selection.focusedCell.row=t.rows[t.rows.length-1]))}t._unboundRows.splice(0,o),t.endUpdate()}}_endCellEdit(e){const t=this,n=e||t.editing.editCell;if(!n||n&&!n.isEditing)return null;const i=t._getEditorValue(n);if("invalid value"===i)return n.setAttribute("error",""),!1;const o=function(){const e=t._getEditorId(n);t._cellEditors[e].detach(),n.row.element.removeAttribute("edit"),n.element.removeAttribute("editor"),n.element.removeAttribute("error"),n.isEditing=!1,n.element.content.innerHTML="";const o=function(){t.editing.editRow||t._recycle(!1)},d=t._cellsUpdatedValues?t._cellsUpdatedValues[n.row.id+"_"+n.column.dataField]:void 0,l=void 0!==d?d:n.value;if(function(e,t){return"date"===n.column.dataType?e.valueOf()===t.valueOf():e===t}(i,l))t.editing.editCell=null,t.editing.editRow||(t.editing.isEditing=!1,o());else{const e=function(){t.editing.editCell=null,t.editing.editRow||(t.editing.isEditing=!1)};if(!0===t.editing.batch||t.editing.batch&&t.editing.batch.indexOf("update")>=0)e(),t._batchUpdateCell(n.row,n.column,i,n.value),o();else{(function(){e(),n._updating=!0,n.value=i,n._updating=!1,o()})()}}return t.editing.commandColumn.visible&&!t.editing.commandColumn.width&&"cell"===t.editing.mode&&t.refresh(),t.focus(),!0};if(t.onCellUpdate){t.beginUpdate(),t.appearance.displayLoadingIndicator=!0,t._setLoadingIndicatorVisibility();const e=t._createOverlay();t.$.root.appendChild(e),t.onCellUpdate(n,t.oldValue,i,(function(n){n?o():t.cancelEdit(),t.appearance.displayLoadingIndicator=!1,t._setLoadingIndicatorVisibility(),e.parentNode.removeChild(e),t.endUpdate()}))}else o()}_endRowEdit(){const e=this,t=e.editing.editRow;if(!t)return!1;let n=!0;const i=t.cells;let o={},d={};for(let t=0;t<i.length;t++){const l=i[t],a=e._getEditorValue(l);o[l.column.dataField]=l.value,d[l.column.dataField]=a,"invalid value"===a&&(l.setAttribute("error",""),n=!1)}if(n){const n=function(){for(let t=0;t<i.length;t++){const n=i[t];e._endCellEdit(n)}e.editing.isEditing=!1,e.editing.editRow=null,e.editing.commandColumn.visible&&!e.editing.commandColumn.width?e.refresh():e._recycle(!1)};if(e.onRowUpdate){e.beginUpdate(),e.appearance.displayLoadingIndicator=!0,e._setLoadingIndicatorVisibility();const i=e._createOverlay();e.$.root.appendChild(i),e.onRowUpdate(t,o,d,(function(t){t?n():e.cancelEdit(),e.appearance.displayLoadingIndicator=!1,e._setLoadingIndicatorVisibility(),i.parentNode.removeChild(i),e.endUpdate()}))}else n();return!0}return e.focus(),!1}_batchDeleteRow(e){const t=this;t._rowsDeleted||(t._rowsDeleted=[]),t._rowsDeleted.push(e),t._recycle(!1)}_batchAddRow(e,t){const n=this;n._rowsAdded||(n._rowsAdded=[]),n._rowsAdded.push(e.id),n.rowById[e.id]=e,e.index=n.rows.length+(n._rowsAdded?n._rowsAdded.length:0),0===t?n._nearRowsAdded.splice(0,0,e):n._farRowsAdded.push(e),n.isInitialized&&n._rowElements&&n._rowElements.length<n.rows.length+n._rowsAdded.length&&n._initializeRowElements(),n.refresh()}_batchUpdateCell(e,t,n,i){const o=this;o._cellsUpdatedValues||(o._cellsUpdatedValues=[]);!function(e,n){return"date"===t.dataType?e.valueOf()===n.valueOf():e===n}(n,i)?o._cellsUpdatedValues[e.id+"_"+t.dataField]=n:delete o._cellsUpdatedValues[e.id+"_"+t.dataField],o._cellsUpdatedValues.length++}_saveBatchEdit(){const e=this;for(let t in e._cellsUpdatedValues){const n=e._cellsUpdatedValues[t],i=t.substring(0,t.indexOf("_")),o=t.substring(t.indexOf("_")+1),d=e.rowById[i].getCell(o);d._updating=!0,d.value=n,d._updating=!1}const t=e._rowsDeleted&&e._rowsDeleted.length>0||e._rowsAdded&&e._rowsAdded.length>0;if(t&&e.beginUpdate(),e._rowsAdded&&e._rowsAdded.length>0)for(let t in e._rowsAdded){const n=e._rowsAdded[t],i=e.rowById[n];i&&(e._nearRowsAdded.indexOf(i)>=0?e.rows.splice(0,0,i):e._farRowsAdded.indexOf(i)>=0&&e.rows.push(i))}if(e._rowsDeleted&&e._rowsDeleted.length>0)for(let t=0;t<e._rowsDeleted.length;t++){const n=e._rowsDeleted[t],i=e.rows.indexOf(n);i<0||e.rows.splice(i,1)}t&&e.endUpdate(),e._clearBatchEdit(!1)}_clearBatchEdit(){const e=this;let t=!1;e._rowsAdded&&e._rowsAdded.length>0&&(t=!0),e._cellsUpdatedValues=[],e._rowsAdded=[],e._rowsDeleted=[],e._nearRowsAdded=[],e._farRowsAdded=[],t?e.refresh():e._recycle(!1)}_getEditorId(e){return e.editor!==e.column.editor?e.editor.template+"_"+e.column.dataField+"_"+e.row.id:e.editor.template+"_"+e.column.dataField}_applyCommand(e,t){const n=this;t||(t=[]);const i=function(){"function"==typeof e?e.apply(n,t):n[e]?n[e].apply(n,t):Smart[e]?Smart[e].apply(n,t):window[e]&&window[e].apply(n,t)};if(n.onCommand){t||(t=[]),t[1]||(t[1]=null);const o={name:e,command:i,details:t[0],event:t[1],handled:!1};setTimeout(()=>{n.onCommand.apply(n,[o]),o.handled||i()},200)}else i()}_getCommandColumnCommandsTemplate(){const e=this,t=e.editing.commandColumn.dataSource,n="icon"!==e.editing.commandColumn.displayMode,i="label"!==e.editing.commandColumn.displayMode;let o="";for(let d in t){const l=t[d];let a="<div",r=!1;if("commandColumnMenu"===d)continue;r||(a+=' item="'+d+'" command="'+l.command+'" class="smart-grid-command-item">',r=!0);const s="{{messages}}"===l.label?e.localize(d):l.label;i&&n?(a+='<span class="smart-grid-icon '+l.icon+'"></span>',a+='<span class="smart-grid-label">'+s+"</span>"):i&&!n?a+='<span class="smart-grid-icon '+l.icon+'"></span>':n&&!i&&(a+='<span class="smart-grid-label">'+s+"</span>"),a+="</div>",o+=a}return o}_updateCommandColumnCommandsVisibility(e,t){const n=this,i=e.children,o=n.editing.commandColumn.dataSource;for(let e=0;e<i.length;e++){const d=i[e],l=d.getAttribute("item"),a=o[l].visible;!0===a?d.classList.remove("smart-hidden"):!1===a?d.classList.add("smart-hidden"):"auto"===a&&(!n.editing.dialog.enabled&&(n.editing.editRow===t||n.editing.editCell&&n.editing.editCell.row===t)?"commandColumnEdit"===l?d.classList.add("smart-hidden"):"commandColumnUpdate"!==l&&"commandColumnCancel"!==l||i[e].classList.remove("smart-hidden"):"commandColumnEdit"===l?d.classList.remove("smart-hidden"):"commandColumnUpdate"!==l&&"commandColumnCancel"!==l||i[e].classList.add("smart-hidden"))}}_handleEditKeyDown(e){const t=this,n=e.key,i=t.editing.commandKeys;if(!t.editing.dialog.enabled)for(let e in i){const o=i[e],d=o.key.replace(/ /gi,"").split("|");if(("Tab"!==n||!t.editing.editRow)&&d.indexOf(n)>=0){t._applyCommand(o.command);break}}}_getCustomCellEditor(e){const t=this;e.editor.selector=e.editor.template,e.editor.template="custom";const n=t._getEditorId(e);if(!t._cellEditors[n]){const i=document.createElement("div");t._applyCellEditorUserSettings(i,e),i.classList.add("smart-grid-cell-editor");const o=function(e){"keydown"!==e.type||t._handleEditKeyDown(e)},d=function(){const t=e.editor.instance.element.firstElementChild;e.editor.focus?setTimeout((function(){e.editor.focus.apply(e.editor.instance.element,[])}),50):setTimeout((function(){t.focus()}),50)},l=function(t){const n=e.editor.instance.element.firstElementChild;e.editor.blur?e.editor.blur.apply(e.editor.instance.element,[t]):n.blur()},a=function(t){const n=e.editor.instance.element.firstElementChild;if(e.editor.setValue)e.editor.setValue.apply(e.editor.instance.element,[t]);else{if(n.innerHTML.indexOf("{{")>=0){const i=n.innerHTML.replace(/{{value}}/gi,t).replace(/{{id}}/gi,e.row.id);n.innerHTML=i}n.value=t,t instanceof Date&&(n.value=t.toISOString().split("T")[0]),e.editor.instance.element.value=n.value}},r=function(){const t=e.editor.instance.element.firstElementChild;if(e.editor.getValue){const n=t.querySelector("input");return n&&n.blur(),e.editor.getValue.apply(e.editor.instance.element,[])}return t.value||""},s=function(){i.removeEventListener("keydown",o),e.editor.detach&&e.editor.detach.apply(i,[])},c=function(){i.addEventListener("keydown",o),e.editor.attach&&e.editor.attach.apply(i,[])};let u=null;if((e.editor.selector.startsWith("#")||e.editor.selector.startsWith("."))&&(u=document.querySelector(e.editor.selector)),u)i.appendChild(u.content.cloneNode(!0).firstElementChild);else{const t=function(e){const t=document.createElement("template");return e=e.trim(),t.innerHTML=e,t.content.firstChild}(e.editor.selector);t&&i.appendChild(t)}t._cellEditors[n]={element:i,focus:d,blur:l,getValue:r,setValue:a,attach:c,detach:s}}return t._cellEditors[n]}_getTextAreaCellEditor(e){const t=this,n=t._getEditorId(e),i=document.createElement("div"),o=document.createElement("textarea"),d=document.createElement("div");t._applyCellEditorUserSettings(i,e),o.style.direction="",t.rightToLeft&&(o.style.direction="rtl"),o.classList.add("smart-input"),i.classList.add("smart-grid-cell-editor"),i.classList.add("smart-grid-text-area-cell-editor"),d.classList.add("nav"),d.classList.add("smart-icon-resize-full","smart-grid-icon");const l=function(e){let n=e.key;if("keydown"===e.type)return t._handleEditKeyDown(e),void(e.shiftKey&&" "===n&&(d.click(),e.preventDefault()))};d.onclick=function(){const n=document.createElement("div"),i=document.createElement("span"),l=document.createElement("textarea"),a=e.editor.instance.element,r=document.createElement("div"),s=document.createElement("smart-scroll-bar");s.orientation="vertical",n.setAttribute("theme",t.theme),r.appendChild(l),r.classList.add("smart-grid-text-area-container"),r.appendChild(s),l.value=o.value,l.classList.add("smart-input"),d.textAreaEditorDialog=n,d.popupTextArea=l,i.classList.add("close-button"),i.classList.add("smart-grid-icon"),i.classList.add("smart-icon-cancel-circled");const c=function(){s.value=l.scrollTop,s.max=l.scrollHeight-l.offsetHeight,s.onChange=null,l.offsetHeight>=l.scrollHeight?s.classList.add("smart-hidden"):s.classList.remove("smart-hidden"),s.onChange=function(){l.scrollTop=s.value}};l.onscroll=function(){c()},l.onkeydown=function(e){"Escape"===e.key&&n.parentNode.removeChild(n),"Enter"===e.key&&e.shiftKey&&i.click()},i.onclick=function(){d.textAreaEditorDialog.parentNode.removeChild(d.textAreaEditorDialog),setTimeout((function(){o.value=l.value,o.select()}),50)},n.classList.add("smart-grid-text-area-dialog"),n.appendChild(r),n.appendChild(i),document.body.appendChild(n),setTimeout((function(){l.select(),c()}),50),c(),n.style.top=t._offsetTop(a)+"px",n.style.left=t._offsetLeft(a)+"px",n.style.width=a.offsetWidth+"px"},i.appendChild(o),i.appendChild(d);return t._cellEditors[n]={element:i,focus:function(){setTimeout((function(){o.select()}),50)},blur:function(){},setValue:function(e){o.value=e},getValue:function(){const e=o.value;return d.textAreaEditorDialog&&d.textAreaEditorDialog.parentNode?(o.value=d.popupTextArea.value,o.value):e},attach:function(){o.addEventListener("keydown",l)},detach:function(){o.removeEventListener("keydown",l),d.textAreaEditorDialog&&d.textAreaEditorDialog.parentNode&&(o.value=d.popupTextArea.value,d.textAreaEditorDialog.parentNode.removeChild(d.textAreaEditorDialog))}},t._cellEditors[n]}_getInputCellEditor(e){const t=this,n=t._getEditorId(e);if(!t._cellEditors[n]){const i=document.createElement("input");t._applyCellEditorUserSettings(i,e),i.classList.add("smart-input"),i.classList.add("smart-grid-cell-editor"),i.classList.add("smart-grid-input-cell-editor"),i.style.direction="",t.rightToLeft&&(i.style.direction="rtl");const o=function(n){if("keydown"===n.type)return"number"!==e.column.dataType&&"int"!==e.column.dataType&&"float"!==e.column.dataType||t.editing.editColumn||n.key.match(/[0-9]/)||"-"===n.key||1!==n.key.length?void t._handleEditKeyDown(n):(n.preventDefault(),void n.stopPropagation())},d=function(){setTimeout((function(){i.select()}),50)},l=function(){},a=function(t){if(!e.column.rowHeaderColumn||t){if("number"===e.column.dataType||"int"===e.column.dataType||"float"===e.column.dataType){if(""===t)return;if(t&&!t.toString().match(/[0-9]/)&&"-"!==t)return}i.value=t}else i.value=e.editor.row.visibleIndex+1},r=function(){return i.value},s=function(){i.removeEventListener("keydown",o)},c=function(){i.addEventListener("keydown",o)};t._cellEditors[n]={element:i,focus:d,blur:l,getValue:r,setValue:a,attach:c,detach:s}}return t._cellEditors[n]}_applyCellEditorUserSettings(e,t){for(let n in t.editor)"template"!==n&&("list"!==n?e[n]=t.editor[n]:e.setAttribute(n,t.editor[n]))}_getAutoCompleteCellEditor(e){const t=this,n=t._getEditorId(e);if(!t._cellEditors[n]){const i=document.createElement("smart-input");t._applyCellEditorUserSettings(i,e),i.readonly&&(i.dropDownButtonPosition="right");const o=function(e){i.opened||"keydown"!==e.type||t._handleEditKeyDown(e)};i.rightToLeft=t.rightToLeft,i.classList.add("smart-grid-cell-editor"),i.classList.add("smart-grid-auto-complete-cell-editor");const d=function(){setTimeout(()=>{i&&i.select&&i.select()},50)},l=function(e){i.value=e},a=function(){return i.value},r=function(){i&&i.close&&(i.value="",i.close(),i.removeEventListener("keydown",o))},s=function(){},c=function(){i.addEventListener("keydown",o)};t._cellEditors[n]={element:i,focus:d,blur:s,setValue:l,getValue:a,attach:c,detach:r}}const i=t.getVisibleRows(),o=[];for(let n=0;n<i.length;n++){let d=t.dataSource[i[n].index];d&&(d=d[e.column.dataField],-1===o.indexOf(d)&&o.push(d))}return t._cellEditors[n].element.dataSource=o,t._cellEditors[n]}_getDateTimePickerCellEditor(e){const t=this,n=t._getEditorId(e);if(!t._cellEditors[n]){const i=document.createElement("smart-date-time-picker");i.calendarButton=!0,i.dropDownAppendTo="body",i.autoClose=!0,i.dropDownDisplayMode="calendar",i.rightToLeft=t.rightToLeft,t._applyCellEditorUserSettings(i,e);const o=function(e){i.opened||"keydown"!==e.type||t._handleEditKeyDown(e)};i.classList.add("smart-grid-cell-editor"),i.classList.add("smart-grid-date-time-picker-cell-editor");const d=function(){setTimeout(()=>{i.select()},50)},l=function(e){i.value=e},a=function(){return i.value},r=function(){i.value="",i.close(),i.removeEventListener("keydown",o)},s=function(e){const n=i.getAttribute("aria-controls");if(n&&i.opened){const i=t.getBoundingRect(document.getElementById(n));e.pageX<i.left||e.pageX>i.right||e.pageY<i.top||e.pageY>i.bottom||e.preventDefault()}},c=function(){i.addEventListener("keydown",o)};t._cellEditors[n]={element:i,focus:d,blur:s,setValue:l,getValue:a,attach:c,detach:r}}return t._cellEditors[n]}_getNumberInputCellEditor(e){const t=this,n=t._getEditorId(e);if(!t._cellEditors[n]){const i=document.createElement("div"),o=document.createElement("input"),d=document.createElement("div"),l=document.createElement("div"),a=document.createElement("div");t._applyCellEditorUserSettings(i,e),l.tabIndex=a.tabIndex=-1,o.classList.add("smart-input"),i.classList.add("smart-grid-cell-editor"),i.classList.add("smart-grid-number-input-cell-editor"),d.classList.add("nav"),l.classList.add("up"),a.classList.add("down");const r=function(e){"keydown"!==e.type||t._handleEditKeyDown(e)};o.type="number",d.appendChild(l),d.appendChild(a),i.appendChild(o),i.appendChild(d);const s=function(){const e=parseFloat(o.value);return isNaN(e)||e===1/0||e===-1/0?0:e},c=function(e){o.value=e},u=function(){setTimeout((function(){o.select()}),50)},m=function(){},g=function(){o.addEventListener("keydown",r),l.onkeydown=r,a.onkeydown=r,l.onclick=function(){const e=parseFloat(o.value);isNaN(e)||(e<o.max||""===o.max)&&(o.value=e+1)},a.onclick=function(){const e=parseFloat(o.value);isNaN(e)||(e>o.min||""===o.min)&&(o.value=e-1)}},f=function(){o.removeEventListener("keydown",r),l.onclick=a.onclick=null,l.onkeydown=a.onkeydown=null};t._cellEditors[n]={element:i,focus:u,blur:m,setValue:c,getValue:s,attach:g,detach:f}}return t._cellEditors[n]}_getCheckBoxCellEditor(e){const t=this,n=t._getEditorId(e);if(!t._cellEditors[n]){const e=document.createElement("div");e.classList.add("smart-input"),e.classList.add("smart-grid-cell-editor"),e.classList.add("smart-grid-check-box-cell-editor"),e.tabIndex=0;const i=function(){!0!==e.value&&!1!==e.value&&null!==e.value&&(e.value=!1),null===e.value?e.value=!1:e.value=!e.value,!1===e.value?e.removeAttribute("checked"):e.setAttribute("checked",e.value?"":"indeterminate")},o=function(e){" "!==e.key?t._handleEditKeyDown(e):i()},d=function(t){e.value=t,!1===e.value?e.removeAttribute("checked"):e.setAttribute("checked",e.value?"":"indeterminate")},l=function(){e.focus(),setTimeout((function(){e.focus()}),25)},a=function(){return e.value},r=function(){e.value=!1,e.removeEventListener("click",i),e.removeEventListener("keydown",o)},s=function(){},c=function(){e.addEventListener("keydown",o),e.addEventListener("click",i)};t._cellEditors[n]={getValue:a,setValue:d,focus:l,blur:s,element:e,detach:r,attach:c}}return t._cellEditors[n]}_getEditorValue(e){const t=this._getEditorId(e);if(!this._cellEditors)return;const n=this._cellEditors[t];if(!n)return;const i=function(t){switch(e.column.dataType){case"float":case"int":case"number":t="int"===e.column.dataType?parseInt(t):parseFloat(t),isNaN(t)&&(t=0);break;case"bool":case"boolean":"true"!==t&&"1"!==t||(t=!0),"false"!==t&&"0"!==t||(t=!1);break;case"date":t=(t=new Smart.Utilities.DateTime(t)).toDate();break;case"dateTime":t=new Smart.Utilities.DateTime(t)}return t};let o=null;switch(e.editor.template){case"input":case"autoComplete":case"numberInput":case"deteTimePicker":case"checkBox":try{o=i(n.getValue())}catch(t){o=e.value}if(e.editor.getValue){const t=e.editor.getValue(e,o);void 0!==t&&(o=t)}break;default:o=i(n.getValue())}let d=!0;return e.column.validator&&(d=e.column.validator.evaluate(o)),d?o:"invalid value"}_beginRowEdit(e,t){const n=this;if(e===n.editing.editRow)return!1;if(n.editing.editRow){if(!n.endEdit())return!1}const i=e.cells;n.editing.editRow=e,n.editing.commandColumn.visible&&(n.editing.isEditing=!1,n.refresh(),n.editing.isEditing=!0),e.isEditing=!0;let o=!1;for(let e=0;e<i.length;e++){const d=i[e],l=n._beginCellEdit(d);t?d===t&&d.editor.instance.focus():l&&!o&&(o=!0,d.editor.instance.focus()),n.editing.commandColumn.visible&&d.column.commandColumn&&d.render()}return!0}_createOverlay(){const e=document.createElement("div");return e.onpointerdown=function(){return!1},e.onmousedown=function(){return!1},e.onclick=function(){},e.classList.add("smart-grid-dialog-overlay"),e}_createDialog(e){const t=this,n=document.createElement("div");e||(e=t.editing.dialog),n.setAttribute("animation","none"),n.classList.add("smart-window","smart-grid-dialog"),n.style.width="auto"===e.width?e.width:e.width+"px",n.style.height="auto"===e.height?e.height:e.height+"px",n.style.left="",n.style.top="",n.innerHTML='<div class="smart-container">\n                   <div class ="smart-content-container" smart-id="container">\n                        <div id="headerSection" class="smart-header-section">\n                            <div class="smart-header"></div>\n                            <div class="smart-buttons-container">\n                                <button class ="smart-button smart-element smart-close-button" aria-label="Close" smart-id="closeButton"></button>\n                            </div>\n                        </div>\n                        <div class="smart-content"><div></div></div>\n                        <div class ="smart-footer">\n                            <div class ="smart-stack-layout right spacing">\n                                <smart-button class ="smart-confirm-button item primary">Ok</smart-button>\n                                <smart-button class ="smart-cancel-button item">Cancel</smart-button>\n                            </div>\n                        </div>\n                    </div>\n              </div>\n            ',n.content=n.querySelector(".smart-content").firstChild,n.footer=n.querySelector(".smart-footer"),n.header=n.querySelector(".smart-header"),n.btnConfirm=n.querySelector(".smart-confirm-button"),n.btnCancel=n.querySelector(".smart-cancel-button"),n.btnClose=n.querySelector(".smart-close-button");const i=document.createElement("div");return i.classList.add("smart-grid-dialog-overlay"),i.onclick=function(){},n.overlay=i,n.remove=function(){n.parentNode&&n.parentNode.removeChild(n)},n.close=function(){n.classList.remove("open"),n.addEventListener("transitionend",n.remove),n.addEventListener("transitioncancel",n.remove),n.modal&&n.overlay.parentNode&&n.overlay.parentNode.removeChild(n.overlay),n.onClose&&n.onClose()},n.open=function(i,o){n.removeEventListener("transitionend",n.remove),n.removeEventListener("transitioncancel",n.remove),document.body.appendChild(n),i||(i=e.left),o||(o=e.top),requestAnimationFrame((function(){n.classList.add("open");const e=function(e,i){const o=t.offset(t);switch("center"===e&&"horizontal"===i&&(e="middle"),e){case"top":return o.top;case"bottom":return o.top+t.offsetHeight-n.offsetHeight;case"center":return o.top+t.offsetHeight/2-n.offsetHeight/2;case"left":return o.left;case"middle":return o.left+t.offsetWidth/2-n.offsetWidth/2;case"right":return o.left+t.offsetWidth-n.offsetWidth}return"horizontal"===i?parseInt(e)+o.left:"vertical"===i?parseInt(e)+o.top:"number"==typeof e?e:parseInt(e)};n.style.left=e(i,"horizontal")+"px",n.style.top=e(o,"vertical")+"px"})),n.modal&&t.appendChild(n.overlay),n.onOpen&&n.onOpen()},n}_openAddRowDialog(e,t){const n=this;if(!n.editing.addDialog.enabled)return!1;const i=n._dialogAddRow||n._createDialog(),o="{{message}}"===n.editing.dialog.header?n.localize("dialogAddHeader"):n.editing.dialog.header,d=i.content;i.header.innerHTML=o,e.grid=n,void 0===e.index&&(e.index=n.rows.length,n._rowsAdded&&(e.index+=n._rowsAdded.length));const l=e.cells;let a=null,r=0;if(n._cellEditors||(n._cellEditors=[]),!n._dialogAddRow){i.modal=!0,i.btnConfirm.innerHTML=n.localize("dialogAddButtonConfirm"),i.btnCancel.innerHTML=n.localize("dialogAddButtonCancel"),i.onOpen=function(){n.editing.dialog.visible=!0},i.onClose=function(){n.editing.dialog.visible=!1},i.btnCancel.onclick=function(){i.close()},i.btnClose.onclick=function(){i.close()},i.btnConfirm.onclick=function(){const e={};for(let t=0;t<l.length;t++){const i=l[t],o=n._getEditorValue(i),d=n._getEditorId(i),a=n._cellEditors[d];e[i.column.dataField]=o,a.detach()}const o=n._rowsAdded?n._rowsAdded.length:0,d=new Smart.Grid.Row({index:n.rows.length+o,grid:n,data:e});i.close(),t(d,0===i.index)},i.onkeydown=function(e){const t=e.key;"Enter"===t?i.btnConfirm.onclick():"Escape"===t&&i.close()},d.classList.add("smart-grid-layout");for(let e=0;e<n.columns.length;e++){const t=n.columns[e];if(!t.allowEdit)continue;r%2==0&&(a=document.createElement("div"),a.classList.add("row"),d.appendChild(a));const i=document.createElement("div");i.classList.add("col-sm-6");const o=document.createElement("div");o.classList.add("column");const l=document.createElement("label");l.innerHTML=n.columns[e].label;const s=document.createElement("div");s.classList.add("smart-grid-dialog-editor"),s.setAttribute("editor",t.dataField),s.setAttribute("template",t.editor.template),i.appendChild(o),a.appendChild(i),o.appendChild(l),o.appendChild(s),r++}}i.open(),i.index=e.index;for(let e=0;e<l.length;e++){const t=l[e],o=t.column,d=o.dataField,a=i.querySelector("[editor="+d+"]");a.innerHTML="";let r="";void 0!==t.value?r=t.value:("int64"!==o.dataType&&"number"!==o.dataType&&"int"!==o.dataType&&"float"!==o.dataType||(r=0),"date"===o.dataType&&(r=new Date),"bool"!==o.dataType&&"boolean"!==o.dataType||(r=!1));let s=null;switch(t.editor.template){default:case"custom":s=n._getCustomCellEditor(t);break;case"checkBox":s=n._getCheckBoxCellEditor(t);break;case"autoComplete":s=n._getAutoCompleteCellEditor(t);break;case"dateTimePicker":s=n._getDateTimePickerCellEditor(t);break;case"textArea":case"textarea":s=n._getTextAreaCellEditor(t);break;case"numberInput":case"input":s="numberInput"===t.editor.template?n._getNumberInputCellEditor(t):n._getInputCellEditor(t)}s.attach(),t.editor.instance=s,s.setValue(r),0===e&&s.focus(),t.editor.isInitialized||(t.editor.isInitialized=!0,t.editor.onInit&&t.editor.onInit(t.row.index,t.column.dataField,t.editor.instance.element)),t.editor.onRender&&t.editor.onRender(t.row.index,t.column.dataField,t.editor.instance.element),a.appendChild(s.element)}n._dialogAddRow=i}_openEditDialog(e,t){const n=this;if(!n.editing.dialog.enabled)return!1;const i=n._dialogEdit||n._createDialog(),o="{{message}}"===n.editing.dialog.header?n.localize("dialogEditHeader",{value:n.editing.editRow?e.row.visibleIndex+1:e.column.label}):n.editing.dialog.header,d=i.content;i.header.innerHTML=o;let l=null,a=0;if(!n._dialogEdit)if(i.modal=!0,i.btnConfirm.innerHTML=n.localize("dialogEditButtonConfirm"),i.btnCancel.innerHTML=n.localize("dialogEditButtonCancel"),i.onOpen=function(){n.editing.dialog.visible=!0},i.onClose=function(){n.editing.dialog.visible=!1},i.btnCancel.onclick=function(){n.cancelEdit()},i.btnClose.onclick=function(){n.cancelEdit()},i.btnConfirm.onclick=function(){n.endEdit()},i.onkeydown=function(e){const t=e.key,i=n.editing.commandKeys;for(let e in i){const o=i[e];if(t===o.key){n._applyCommand(o.command);break}}},n.editing.editRow){d.classList.add("smart-grid-layout");for(let e=0;e<n.columns.length;e++){const t=n.columns[e];if(!t.allowEdit)continue;a%2==0&&(l=document.createElement("div"),l.classList.add("row"),d.appendChild(l));const i=document.createElement("div");i.classList.add("col-sm-6");const o=document.createElement("div");o.classList.add("column");const r=document.createElement("label");r.innerHTML=n.columns[e].label;const s=document.createElement("div");s.classList.add("smart-grid-dialog-editor"),s.setAttribute("editor",t.dataField),s.setAttribute("template",t.editor.template),i.appendChild(o),l.appendChild(i),o.appendChild(r),o.appendChild(s),a++}}else{const t=e.column,n=document.createElement("div");n.classList.add("smart-grid-dialog-editor"),n.setAttribute("editor",""),n.setAttribute("template",t.editor.template),d.appendChild(n)}if(i.open(),n.editing.editRow){const n=i.querySelector("[editor="+e.column.dataField+"]");n.innerHTML="",n.appendChild(t.element)}else{const n=e.column,o=i.querySelector("[editor]");o.innerHTML="",o.setAttribute("template",n.editor.template),o.appendChild(t.element)}n._dialogEdit=i}_openDeleteRowDialog(e,t){const n=this;if(!n.editing.deleteDialog.enabled)return!1;const i=n._dialogDelete||n._createDialog(),o="{{message}}"===n.editing.dialog.header?n.localize("dialogDeleteHeader",{value:e.visibleIndex+1}):n.editing.dialog.header;i.header.innerHTML=o,i.content.innerHTML=n.localize("dialogDeleteContent"),i.row=e,n._dialogDelete||(i.modal=!0,i.btnConfirm.innerHTML=n.localize("dialogDeleteButtonConfirm"),i.btnCancel.innerHTML=n.localize("dialogDeleteButtonCancel"),i.onOpen=function(){n.editing.dialog.visible=!0},i.onClose=function(){n.editing.dialog.visible=!1},i.btnCancel.onclick=function(){i.close()},i.btnClose.onclick=function(){i.close()},i.btnConfirm.onclick=function(){t(i.row),i.close()},i.onkeydown=function(e){"Escape"===e.key&&i.close()},n._dialogDelete=i),i.open(),setTimeout((function(){i.btnConfirm.focus()}),100)}_beginCellEdit(e,t){const n=this;if(e.isEditing)return!1;if(n._isUpdating)return!1;let i=!1;if(e.column.autoGenerated&&e.column.rowHeaderColumn&&n.editing.allowRowHeaderEdit&&new Date-n._clickTime<n.behavior.doubleClickTimingDelay&&n._clickedCell===e.element&&(i=!0),(!e.column.allowEdit||e.column.autoGenerated||e.readonly)&&!i)return!1;if(n.editing.editCell&&!n.editing.editRow){if(!1===n._endCellEdit())return!1}n._cellEditors||(n._cellEditors=[]),n.editing.editRow||(n.editing.editCell=e),n.editing.commandColumn.visible&&!n.editing.editRow&&(n.editing.isEditing=!1,n.refresh(),n.editing.isEditing=!0),e.row.element.setAttribute("edit",""),n.editing.isEditing=!0,n._selection.selectionRect&&n._selection.selectionRect.classList.add("smart-visibility-hidden");const o=t=>{const i=t.element;n.editing.dialog.enabled?n._openEditDialog(e,t):(e.element||e.createElement(),e.element.setAttribute("editor","string"==typeof e.editor.template?e.editor.template:"template"),e.element.content.innerHTML="",e.element.content.appendChild(i),n.editing.editRow&&e.element.setAttribute("row-editor","")),t.attach(),e.editor.row=e.row,e.editor.column=e.column,e.editor.cell=e,e.editor.instance=t,e.isEditing=!0},d=n._cellsUpdatedValues?n._cellsUpdatedValues[e.row.id+"_"+e.column.dataField]:void 0;let l=void 0!==d?d:e.value;if(void 0===l){l="";const t=e.column;"number"===t.dataType||"int"===t.dataType||"float"===t.dataType?l=0:"date"===t.dataType&&(l=new Date,l.setTime(0,0,0))}switch(e.editor||(e.editor="input"),"string"==typeof e.editor&&(e.canNotify=!1,e.editor={template:e.editor,autoFocus:!0},e.canNotify=!0),e.editor.template){default:case"custom":{const t=n._getCustomCellEditor(e);o(t),t.setValue(l);break}case"checkBox":{const i=n._getCheckBoxCellEditor(e);o(i);const d=!0===l||1===l;if("checkBox"===e.template&&t){(n.enableShadowDOM?n.shadowRoot:n.getRootNode()).elementsFromPoint(t.clientX,t.clientY)[0].classList.contains("smart-input")?i.setValue(!d):i.setValue(d)}else i.setValue(d);break}case"autoComplete":{const t=n._getAutoCompleteCellEditor(e);o(t),t.setValue(l),e.editor.autoOpen&&t.element.open();break}case"dateTimePicker":{const t=n._getDateTimePickerCellEditor(e);o(t),t.setValue(l),e.editor.autoOpen&&t.element.open();break}case"textArea":{const t=n._getTextAreaCellEditor(e);o(t),t.setValue(l);break}case"numberInput":case"input":{const t="numberInput"===e.editor.template?n._getNumberInputCellEditor(e):n._getInputCellEditor(e);o(t),t.setValue(l);break}}return e.editor.isInitialized||(e.editor.isInitialized=!0,e.editor.onInit&&e.editor.onInit(e.row.index,e.column.dataField,e.editor.instance.element)),e.editor.onRender&&e.editor.onRender(e.row.index,e.column.dataField,e.editor.instance.element),n.editing.editCell&&e.editor.instance.focus(),!0}_onColumnDoubleClick(e){this._beginColumnEdit(e)}_beginColumnEdit(e){const t=this;if(t.editing.enabled&&t.editing.allowColumnHeaderEdit&&e.allowHeaderEdit){t.editing.isEditing&&t.endEdit(),t.editing.editColumn=e,t._cellEditors||(t._cellEditors=[]);const n=t._getInputCellEditor({column:e,row:t.rows[0],editor:{template:"input"}});n.element.value=e.label,n.focus(),e.headerEditor=n,e.element.setAttribute("edit",""),e.element.label.appendChild(n.element),n.attach(),t.editing.isEditing=!0,t.$.fireEvent("beginEdit",{row:null,column:e,cell:null})}}_endColumnEdit(e){if(!1===this.editing.isEditing||this.editing.isEditing&&null===this.editing.editColumn)return!1;const t=this.editing.editColumn;return t.canNotify=!1,t.headerEditor.detach(),t.headerEditor.element.parentNode.removeChild(t.headerEditor.element),!0!==e&&(t.label=t.headerEditor.getValue()),t.headerEditor=null,this.editing.isEditing=!1,t.element.removeAttribute("edit"),t.element.scrollLeft=0,this.editing.editColumn=null,t.canNotify=!0,t.refresh(),this._recycle(),!0}_cancelColumnEdit(){this._endColumnEdit(!0)}_onCellClick(e,t){const n=this;if(e.row.addNewRow)"far"===e.row.freeze?n._insertNewRowAfter():n._insertNewRowBefore();else if(n.editing.enabled)if(n.editing.editColumn)n.endEdit();else{if(n.editing.commandColumn.visible)if(e.column.commandColumn){const i=(n.enableShadowDOM?n.shadowRoot:n.getRootNode()).elementsFromPoint(t.clientX,t.clientY);let o=null;for(let e=0;e<i.length;e++)if(i[e].classList.contains("smart-grid-command-item")){o=i[e];break}if(o||(o=e.element.querySelector(".smart-grid-command-item")),o&&!o.classList.contains("smart-hidden")){const i=o.getAttribute("command");return void n._applyCommand(i,[e.row,t])}}else if(n.editing.commandColumn.inline){const e=(n.enableShadowDOM?n.shadowRoot:n.getRootNode()).elementsFromPoint(t.pageX,t.pageY);for(let t=0;t<e.length;t++)if(e[t].classList.contains("smart-grid-command-item"))return}if("none"===n.editing.action&&n.editing.isEditing){let t=!1;n.editing.editCell&&n.editing.editCell.row!==e.row&&(t=!0),n.editing.editRow&&n.editing.editRow!==e.row&&(t=!0),n.editing.editColumn&&(t=!0),t&&n.endEdit()}if(e.column.autoGenerated)n.editing.allowRowHeaderEdit&&e.column.rowHeaderColumn&&(n.editing.isEditing&&n.endEdit(),n._beginCellEdit(e,t));else if("click"===n.editing.action&&(!n.selection.enabled||e.selected||"extended"!==n.selection.mode))if("cell"===n.editing.mode){const i=e.parent();n.ensureVisible(e.row.id,e.column.dataField),setTimeout((function(){i?n._beginCellEdit(i,t):n._beginCellEdit(e,t)}),25)}else"row"===n.editing.mode&&n._beginRowEdit(e.row,e,t)}}_onCellDoubleClick(e,t){const n=this;n.editing.enabled&&("doubleClick"!==n.editing.action||n.editing.isEditing||e.column.autoGenerated||("cell"===n.editing.mode?n._beginCellEdit(e,t):"row"===n.editing.mode&&n._beginRowEdit(e.row,e,t)))}_onRowClick(){}_onRowDoubleClick(){}beginEdit(e,t){const n=this,i=n.rowById[e];i&&n._beginEdit(i,t)}cancelEdit(){const e=this;if(e.editing.editRow){const t=e.editing.editRow.cells;for(let e=0;e<t.length;e++){const n=t[e],i=n.element;0===e&&n.row.element.removeAttribute("edit"),i&&(i.removeAttribute("editor"),i.removeAttribute("error"),i.content.innerHTML=""),n.isEditing=!1}e.editing.editRow=null}else e.editing.editCell?(e.editing.editCell.row.element.removeAttribute("edit"),e.editing.editCell.element.removeAttribute("editor"),e.editing.editCell.element.removeAttribute("error"),e.editing.editCell.element.content.innerHTML="",e.editing.editCell.isEditing=!1,e.editing.editCell=null):e.editing.editColumn&&e._cancelColumnEdit();e.editing.dialog.visible&&e.editing.dialog.enabled&&e._dialogEdit.close(),e.editing.isEditing=!1,e._recycle(!1),e.editing.commandColumn.visible&&e.refresh(),e.focus()}deleteRow(e,t){const n=this,i=n.rowById[e];if(!i)return!1;const o=function(e){if(!0===n.editing.batch||n.editing.batch&&n.editing.batch.indexOf("delete")>=0)n._batchDeleteRow(e);else{const t=n.rows.indexOf(e);n.rows.splice(t,1)}t&&t(e)};return n.editing.deleteDialog.enabled?n._openDeleteRowDialog(i,o):o(i),!0}addUnboundRow(e,t){const n=this;void 0===e&&(e=1),void 0===t&&(t="far"),n._nearRowsAdded||(n._nearRowsAdded=[],n._farRowsAdded=[]),n._unboundRows||(n._unboundRows=[]),n.beginUpdate();for(let i=0;i<e;i++){const e=Smart.Utilities.Core.createGUID().replace(/-/gi,""),i=new Smart.Grid.Row({index:-1,unbound:!0,id:e,grid:n});n.rowById[i.id]=i,"far"===t?n._farRowsAdded.push(i):n._nearRowsAdded.push(i),n._unboundRows.push(i)}n.endUpdate()}addNewRow(e){const t=this;"near"===e?t._insertNewRowBefore():t._insertNewRowAfter()}endEdit(){const e=this;let t=!1,n=null;e.editing.dialog.enabled&&e.editing.dialog.visible&&e._dialogEdit&&e._dialogEdit.close();let i=null,o=null,d=null;return e.editing.editRow?(o=e.editing.editRow,n=e.editing.editRow.id,t=e._endRowEdit()):e.editing.editCell?(o=e.editing.editCell.row,d=e.editing.editCell.column,i=e.editing.editCell,n=e.editing.editCell.row.id,t=e._endCellEdit()):e.editing.editColumn&&(n=null,d=e.editing.editColumn,t=e._endColumnEdit()),e._saveUnboundRows(n),e._selection.selectionRect&&e._selection.selectionRect.classList.remove("smart-visibility-hidden"),e.$.scrollView.scrollTop=0,e.$.fireEvent("endEdit",{row:o,column:d,cell:i}),t}getBatchEditChanges(){const e=this,t=[],n=[],i=[];for(let n in e._cellsUpdatedValues){const i=e._cellsUpdatedValues[n],o=n.substring(0,n.indexOf("_")),d=n.substring(n.indexOf("_")+1),l=e.rowById[o].getCell(d);t.push({id:o,dataField:d,oldValue:l.value,newValue:i})}if(e._rowsDeleted&&e._rowsDeleted.length>0)for(let t=0;t<e._rowsDeleted.length;t++){const i=e._rowsDeleted[t];n.push({id:i.id,data:i})}if(e._rowsAdded&&e._rowsAdded.length>0)for(let t=0;t<e._rowsAdded.length;t++){const n=e._rowsAdded[t];i.push({id:n.id,data:n})}return{updated:t,deleted:n,added:i}}saveBatchEdit(){this._saveBatchEdit()}revertBatchEdit(){this._clearBatchEdit(!0)}})}});

/* Smart UI v8.0.0 (2020-Aug) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=70)}({70:function(t,e){class i extends HTMLElement{constructor(){super(),this._properties={min:50,label:"Item",modifiers:["resize","drag","close"],size:null}}_setProperty(t,e){const i=this;if(i._properties[t]===e)return;if(i._properties[t]=e,i._updating=!0,"disabled"===t||"modifiers"===t?e?i.setAttribute(t,e):i.removeAttribute(t):null===e?i.removeAttribute(t):i.setAttribute(t,e),!i.isCompleted)return;const r=i.closest("smart-layout");r&&(r._resizeDetails||r._updating||r.refresh()),i._updating=!1}get label(){return this._properties.label}set label(t){this._setProperty("label",t)}get modifiers(){return this._properties.modifiers}set modifiers(t){this._setProperty("modifiers",t)}get min(){return this._properties.min}set min(t){this._setProperty("min",t)}get size(){return this._properties.size}set size(t){null!==t?this._setProperty("size",Math.max(this.min,t)):this._setProperty("size",t)}static get observedAttributes(){return["min","size","label","modifiers"]}attributeChangedCallback(t,e,i){const r=this;if(e!==i&&r.isCompleted)if("size"===t){if(!r._updating){if(null===i)return void(this[t]=null);r[t]=Math.max(r.min,parseInt(i))}}else r[t]=i}connectedCallback(){this.isCompleted||this.render()}render(){const t=this;t.hasAttribute("data-id")||t.setAttribute("data-id","id"+Math.random().toString(16).slice(2)),t.hasAttribute("label")||t.setAttribute("label",t.label),t.hasAttribute("min")||t.setAttribute("min",t.min),t.hasAttribute("label")||t.setAttribute("label",t.label),t.hasAttribute("modifiers")||t.setAttribute("modifiers",t.modifiers);for(let e=0;e<t.attributes.length;e++){const i=t.attributes[e],r=i.name,n=i.value;isNaN(n)||"min"!==r&&"size"!==r?t._properties[r]=n:t._properties[r]=parseInt(n)}t.classList.add("smart-layout-item"),t.isCompleted=!0}}class r extends i{constructor(){super(),this._properties.label="Group",this._properties.orientation="vertical"}get orientation(){return this._properties.orientation}set orientation(t){this._setProperty("orientation",t)}static get observedAttributes(){return["min","size","modifiers","orientation","position"]}render(){const t=this;super.render(),t.className="smart-layout-group",t.hasAttribute("orientation")?t._properties.orientation=t.getAttribute("orientation"):t.setAttribute("orientation",t._properties.orientation)}}class n extends r{constructor(){super(),this._properties.position="top",this._properties.label="TabGroup"}get position(){return this._properties.position}set position(t){this._setProperty("position",t)}render(){const t=this;super.render(),!t.hasAttribute("position")&&t.position&&t.setAttribute("position","top")}static get observedAttributes(){return["min","size","modifiers","orientation","position"]}}class o extends r{constructor(){super(),this._properties.label="TabItem"}}customElements.define("smart-layout-group",r),customElements.define("smart-layout-item",i),customElements.define("smart-tab-layout-group",n),customElements.define("smart-tab-layout-item",o),Smart("smart-layout",class extends Smart.ContentElement{static get properties(){return{allowLiveSplit:{value:!1,type:"boolean"},allowContextMenu:{value:!1,type:"boolean"},contextMenuDataSource:{value:["select","delete"],type:"any"},dataSource:{reflectToAttribute:!1,value:null,type:"any"},messages:{value:{en:{select:"Select Parent",delete:"Delete"}},type:"object",extend:!0},orientation:{value:"vertical",type:"string"},selectedIndex:{value:null,type:"any"}}}static get listeners(){return{contextmenu:"_contextMenuHandler","document.down":"_documentDownHandler","document.move":"_documentMoveHandler","document.up":"_documentUpHandler","document.selectstart":"_documentSelectStartHandler",mouseleave:"_leaveHandler",mouseenter:"_enterHandler",dragStart:"_dragStart","document.keyup":"_keyUpHandler"}}_dragStart(t){t.stopPropagation(),t.preventDefault()}_leaveHandler(){const t=this;t._handleButtonsVisibility(null),t._hideSplitter(),requestAnimationFrame(()=>{t.classList.remove("outline")})}_enterHandler(){const t=this;t._handleButtonsVisibility(t._selectedItem),t._updateSplitter(),requestAnimationFrame(()=>{t.classList.add("outline")})}template(){return'<div id="container" role="presentation"><smart-layout-group data-id="root" id="itemsContainer"><content></content></smart-layout-group><div root-splitter id="splitter" class="smart-layout-splitter"></div>'}propertyChangedHandler(t,e,i){const r=this;switch(t){case"contextMenuDataSource":r._contextMenu&&(r._closeContextMenu(),r._contextMenu.innerHTML="");break;case"orientation":r.$.itemsContainer.orientation=r.orientation;break;case"dataSource":r.dataBind();break;case"selectedIndex":r._handleItemClick(r.getItem(i+""),!0);break;default:super.propertyChangedHandler(t,e,i)}}dataBind(){this.$.itemsContainer.innerHTML="";let t="";const e=(i,r)=>{for(let n=0;n<i.length;n++){const o=i[n],s=o.size,a=o.min,l=o.modifiers,d=o.type,c=o.position,u=o.orientation?o.orientation:"vertical";let p="";if(void 0!==s&&(p+=`size="${s}" `),void 0!==a&&(p+=`min="${a}" `),void 0!==l&&(p+=`modifiers="${l}" `),void 0!==c&&(p+=`position="${c}" `),o.items)p+=`orientation=${u} `,"tabs"===d?(t+=`<smart-tab-layout-group ${p}>`,e(o.items,!0),t+="</smart-tab-layout-group>"):(t+=`<smart-layout-group ${p}>`,e(o.items),t+="</smart-layout-group>");else{const e=o.content||"";t+=r?`<smart-tab-layout-item ${p}>`+e+"</smart-tab-layout-item>":`<smart-layout-item ${p}>`+e+"</smart-layout-item>"}}};e(this.dataSource),this.$.itemsContainer.innerHTML=t,this.refresh()}render(){const t=this;t.setAttribute("role","group"),t.selectedIndex&&t._handleItemClick(t.getItem(t.selectedIndex+""),!0),t.checkLicense(),t.dataSource?t.dataBind():t.dataSource=t._getDataSource(t._getLayout()),t.$.itemsContainer.orientation=t.orientation,super.render(),t.refresh(),t._updateSplitter()}getItem(t){if(null==t)return;t=(t+"").split(".");let e,i=this._getDataSource(this._getLayout());for(let r=0;r<t.length&&(e=i[t[r]],e);r++)i=e.items;return e}_contextMenuHandler(t){const e=this;let i=t.target;if(e.allowContextMenu&&i.closest){if(i.closest(".smart-layout-context-menu"))return void t.preventDefault();let n=e.querySelector("[selected][data-id]");if(n||(n=i.closest(".smart-layout-item")||i.closest(".smart-layout-group")),!n)return;t.preventDefault(),e._createContextMenu();const o=e._contextMenu.children;for(let t=0;t<o.length;t++){const e=o[t];"delete"===e.getAttribute("value")?n.hasAttribute("index")&&"0"===n.getAttribute("index")?e.setAttribute("disabled",""):e.removeAttribute("disabled"):"select"===e.getAttribute("value")&&(n.hasAttribute("index")&&"0"===n.getAttribute("index")||!(n.parentElement instanceof r)?e.setAttribute("disabled",""):e.removeAttribute("disabled"))}e._openContextMenu(n,t.pageX,t.pageY)}}_createContextMenu(){const t=this;let e=t._contextMenu;if(e||(e=document.createElement("div"),e.classList.add("smart-layout-context-menu","smart-visibility-hidden"),t._contextMenu=e),!e.innerHTML){const i=t.contextMenuDataSource;for(let r=0;r<i.length;r++){const n=i[r];let o,s;"object"==typeof n?(o=n.label,s=n.value):s=o=n+"",e.innerHTML+=`<div class="smart-layout-context-menu-item" value="${s}">${t.localize(o)||o}</div>`}}}_openContextMenu(t,e,i){const r=this._contextMenu;r&&r.classList.contains("smart-visibility-hidden")&&(this.$.fireEvent("opening").defaultPrevented||t.parentElement&&(r._target=t,this._opening=!0,this.$.container.appendChild(r),this._positionContextMenu(e,i),r.classList.remove("smart-visibility-hidden"),this.$.fireEvent("open")))}_closeContextMenu(){const t=this,e=t._contextMenu;e&&!e.classList.contains("smart-visibility-hidden")&&(t.$.fireEvent("closing").defaultPrevented||(delete t._opening,t.hasAnimation&&e.addEventListener("transitionend",t._contextMenuTransitionEndHandler.bind(t),{once:!0}),e.classList.add("smart-visibility-hidden"),t.$.fireEvent("close")))}_contextMenuTransitionEndHandler(){const t=this._contextMenu;t&&!this._opening&&t.parentElement&&this.$.container.removeChild(t)}_positionContextMenu(t,e){const i=this._contextMenu;if(!i)return;const r=this.$.container.getBoundingClientRect();t-=r.left+window.pageXOffset,e-=r.top+window.pageYOffset,t+i.offsetWidth>r.width&&(t-=t+i.offsetWidth-r.width),e+i.offsetHeight>r.height&&(e-=e+i.offsetHeight-r.height),i.style.left=t+"px",i.style.top=e+"px"}_documentDownHandler(t){const e=this,i=t.originalEvent.target;e.contains(i)&&i.closest&&(e._target=i,e._updateSplitter())}_documentMoveHandler(t){const e=this,i=t.originalEvent.target,r=e._contextMenu;if(r&&!Smart.Utilities.Core.isMobile){if(r.querySelector(".smart-layout-context-menu-item[hover]")){const t=r.children;for(let e=0;e<t.length;e++)t[e].removeAttribute("hover")}r.contains(i)&&i.closest&&i.closest(".smart-layout-context-menu-item")&&i.setAttribute("hover","")}if(e._dragDetails){const i=Math.abs(e._dragDetails.pageX-t.pageX);if(Math.abs(e._dragDetails.pageY-t.pageY)<=5&&i<=5)return;e._dragDetails.feedback.parentElement||(document.body.appendChild(e._dragDetails.feedback),document.body.appendChild(e._dragDetails.overlay),setTimeout(()=>{e._dragDetails.feedback.classList.add("dragging")},100)),e._dragDetails.dragging=!0,e._dragDetails.feedback.style.left=t.pageX-e._dragDetails.feedback.offsetWidth/2-5+"px",e._dragDetails.feedback.style.top=t.pageY-e._dragDetails.feedback.offsetHeight/2-5+"px";const r=document.elementsFromPoint(t.pageX,t.pageY);let s=null,a=!1;for(let t=0;t<r.length;t++){const i=r[t];if(!e._dragDetails.feedback.contains(i)){if(i.classList.contains("smart-layout-tab-strip")){if(e._dragDetails.element.contains(i))continue;s=i.parentElement,a=!0;break}if((i.parentElement!==e._dragDetails.parent&&i!==e._dragDetails.parent||1!==e._dragDetails.layoutGroup.items.length)&&!e._dragDetails.element.contains(i)){if(i instanceof o){s=i.parentElement;break}if(i instanceof n){s=i;break}}}}const l=(i,r)=>{const n=e.offset(i);let o=null,s=50,a=r,l=r;r?s=0:(l=i.offsetWidth/3,a=i.offsetHeight/3);const d=[{left:n.left,top:n.top,right:n.left+s,bottom:n.top+s,position:"top"},{left:n.left+s,top:n.top,right:n.left+i.offsetWidth-s,bottom:n.top+a-s,position:"top"},{left:n.left+i.offsetWidth-s,top:n.top,right:n.left+i.offsetWidth,bottom:n.top+s,position:"top"},{left:n.left,top:n.top+s,right:n.left+l,bottom:n.top+i.offsetHeight-s,position:"left"},{left:n.left+i.offsetWidth-l,top:n.top+s,right:n.left+i.offsetWidth,bottom:n.top+i.offsetHeight-s,position:"right"},{left:n.left,top:n.top+i.offsetHeight-s,right:n.left+s,bottom:n.top+i.offsetHeight,position:"bottom"},{left:n.left+s,top:n.top+i.offsetHeight-a+s,right:n.left+i.offsetWidth-s,bottom:n.top+i.offsetHeight,position:"bottom"},{left:n.left+i.offsetWidth-s,top:n.top+i.offsetHeight-s,right:n.left+i.offsetWidth,bottom:n.top+i.offsetHeight,position:"bottom"}];for(let e=0;e<d.length;e++){const i=d[e];if(i.left<=t.pageX&&t.pageX<=i.right&&i.top<=t.pageY&&t.pageY<=i.bottom){o=i.position;break}}return o},d=e.querySelector("smart-layout-group");let c=l(d,10),u=null;c?u=d:s?a?s!==e._dragDetails.parent&&(c="center",u=s):(c=l(s)||"center",u=s):e._handleDropArea(null),u&&(e._dragDetails.current=u,e._dragDetails.position=c,e._handleDropArea(u,c))}if(e._resizeDetails){const i=Math.abs(e._resizeDetails.clientX-t.clientX),r=Math.abs(e._resizeDetails.clientY-t.clientY),n=e._resizeDetails.splitter,o=e._resizeDetails.item,s=e._resizeDetails.itemRect,a=e._resizeDetails.previousItemRect,l=e._resizeDetails.previousItem,d=e._resizeDetails.nextItemRect,c=e._resizeDetails.nextItem,u=parseInt(o.getAttribute("min")),p=t=>{t.style.right="",t.style.top="",t.style.left="",t.style.bottom=""};if(p(n),p(e.$.splitter),n.classList.remove("error"),n.classList.add("active"),!e._resizeDetails.dragging){if(n.classList.contains("horizontal")&&r<=5)return;if(n.classList.contains("vertical")&&i<=5)return;e._resizeDetails.dragging=!0}let m={clientPos:"clientX",pos:"x",size:"width",near:"left",far:"right",offsetSize:"offsetWidth"};n.classList.contains("horizontal")&&(m={clientPos:"clientY",pos:"y",size:"height",near:"top",far:"bottom",offsetSize:"offsetHeight"});const f=t=>{const i=e.offset(t),r=e.offset(e);e.$.splitter.style.width=t.offsetWidth+"px",e.$.splitter.style.height=t.offsetHeight+"px",e.$.splitter.className=t.className,e.$.splitter.style.left=i.left-r.left+"px",e.$.splitter.style.top=i.top-r.top+"px",t.setAttribute("drag",""),e.$.splitter.setAttribute("drag","")};if(n.classList.contains("last")){let i=t[m.clientPos]-e._resizeDetails.splitterRect[m.pos],r=s[m.size]-u;if(i>r&&(i=r,n.classList.add("error")),a){const t=parseInt(l.getAttribute("min"));let e=a[m.size]-t;i<-e&&(i=-e,n.classList.add("error"))}n.style[m.near]=i+"px";const d=o[m.offsetSize]-i;if(o.setAttribute("size",d),l){const t=o[m.offsetSize]+l[m.offsetSize]-d;l.setAttribute("size",t)}}else{let i=-t[m.clientPos]+e._resizeDetails.splitterRect[m.pos],r=s[m.size]-u;if(i>r&&(i=r,n.classList.add("error")),d){const t=parseInt(c.getAttribute("min"));let e=-d[m.size]+t;i<e&&(i=e,n.classList.add("error"))}n.style[m.far]=i+"px";const a=o[m.offsetSize]-i;if(o.setAttribute("size",a),c){const t=c[m.offsetSize]+o[m.offsetSize]-a;c.setAttribute("size",t)}}f(n)}}_offsetTop(t){return t?t.offsetTop+this._offsetTop(t.offsetParent):0}_offsetLeft(t){return t?t.offsetLeft+this._offsetLeft(t.offsetParent):0}offset(t){return{left:this._offsetLeft(t),top:this._offsetTop(t)}}_keyUpHandler(t){const e=this;if("Escape"===t.key){if(e._dragDetails&&(e._dragDetails.feedback.remove(),e._dragDetails.overlay.remove(),e._dragDetails=null,e._handleDropArea(null)),e._resizeDetails){const t=e._resizeDetails;return t.splitter.classList.contains("last")?t.previousItem.size=t.previousItemSize:t.nextItem.size=t.nextItem.previousItemSize,t.item.size=t.itemSize,e.refresh(),e._handleItemClick(t.item),void(e._resizeDetails=null)}}else"Delete"===t.key&&e._selectedItem&&e._removeLayoutItem(e._selectedItem)}_endDrag(){const t=this;if(t._handleDropArea(null),!t._dragDetails.dragging)return void(t._dragDetails=null);const e=t._dragDetails.current,i=t._dragDetails.element,r=t._dragDetails.position;if(t._handleDropArea(null),e){if(t._addTabLayoutItem(e,r,i),t._removeLayoutItem(i),e.parentElement&&1===Array.from(e.parentElement.parentElement.children).filter(t=>!!t.classList.contains("smart-layout-group")).length){const i=e.parentElement,r=i.parentElement,n=r.parentElement;if("root"!==r.getAttribute("data-id")&&"root"!==n.getAttribute("data-id")&&n!==t){const t=Array.from(n.children).indexOf(i.parentElement);t>=0?n.insertBefore(i,n.children[t]):n.appendChild(i),r.remove()}}t.refresh(),t._updateSplitter(),requestAnimationFrame(()=>{t.classList.add("outline"),t.querySelectorAll(".smart-element").forEach(t=>{t.$.fireEvent("resize")})})}t.$.fireEvent("stateChange",{type:"insert",item:i}),t._dragDetails.feedback.remove(),t._dragDetails.overlay.remove(),t._dragDetails=null}_documentUpHandler(t){const e=this,i=Smart.Utilities.Core.isMobile,r=i?document.elementFromPoint(t.pageX-window.pageXOffset,t.pageY-window.pageYOffset):t.originalEvent.target;if(2!==t.button){if(e._dragDetails&&e._endDrag(t),e._resizeDetails){const t=e._resizeDetails;return t.item&&(t.item.style.overflow=""),t.previousItem&&(t.previousItem.style.overflow=""),t.nextItem&&(t.nextItem.style.overflow=""),e.refresh(),e._handleItemClick(t.item),e._resizeDetails=null,void e.querySelectorAll(".smart-element").forEach(t=>{t.$.fireEvent("resize")})}if(e.contains(r)&&(e.classList.add("outline"),e._target&&!r.item&&(r instanceof o?e._handleItemClick(r):e._handleItemClick(r.closest(".smart-layout-item"))),e._target)){if(e._target!==r)return void delete e._target;if(!t.button&&r.closest(".smart-layout-buttons-container")){const i=t.originalEvent.target;e._handleButtonClick(i.item,i.position)}else r.closest(".smart-layout-context-menu")&&(!i&&!t.button||i)&&e._handleMenuItemClick(r.closest(".smart-layout-context-menu-item"));delete e._target}}}_documentSelectStartHandler(t){this._target&&t.preventDefault()}_getDataSource(t,e,n){const o=this;let s=[];n||(n=0),e||(e="");for(let a=0;a<t.length;a++){const l=t[a],d={label:l.label,id:l.getAttribute("data-id"),orientation:l.orientation,size:l.size,min:l.min,type:l.type,modifiers:l.modifiers,position:l.position};if(l.removeAttribute("index"),l instanceof r){if(s.push(d),d.index=""!==e?e+"."+n:n.toString(),l.setAttribute("index",d.index),l.items){const t=o._getDataSource(l.items,d.index,0);d.items=t}}else if(l instanceof i)if(l.items){const t=o._getDataSource(l.items,e,n);s=s.concat(t)}else d.index=""!==e?e+"."+n:n.toString(),l.setAttribute("index",d.index),s.push(d);n++}return s}_getLayout(){const t=this,e=arguments.length?arguments[0]:t.$.itemsContainer;t._buttons&&t._buttons.remove(),t._dropArea&&t._dropArea.remove();const i=t.querySelectorAll(".smart-layout-splitter");for(let e=0;e<i.length;e++){const r=i[e];r!==t.$.splitter&&r.remove()}e.items=Array.from(e.children),e.items=e.items.filter(t=>t!==e.tabs&&t.hasAttribute("data-id"));const n=e.items.map((function(e){if(e.classList.contains("smart-layout-tab-strip"))return null;const i=e,n=e instanceof r?e:null;return n&&(i.items=t._getLayout(n)),i}));if(e!==t.$.itemsContainer)return n.filter(t=>null!==t&&t!==e.tabs);const o=[],s=e;return s.items=n.filter(t=>null!==t&&t!==e.tabs),o.push(s),o}_updateSplitter(){const t=this;t._buttons&&t._dragDetails&&t._buttons.remove(),t._removeSplitter();const e=t.querySelectorAll("[data-id]");for(let i=0;i<e.length;i++){const r=e[i];if("root"!==r.getAttribute("data-id")){if(r.hasAttribute("role")){const t=r.getAttribute("role");if("gridcell"===t||"row"===t||"columnheader"===t||"rowheader"===t)continue}r.setAttribute("hover",""),t._handleSplitter(r)}}}_hideSplitter(){const t=this.querySelectorAll("[data-id]");for(let e=0;e<t.length;e++){t[e].removeAttribute("hover")}}_removeSplitter(){const t=this,e=t.querySelectorAll(".smart-layout-splitter");for(let i=0;i<e.length;i++){const r=e[i];r!==t.$.splitter&&r.remove()}t._hideSplitter()}_handleItemClick(t){const e=this,i=e.selectedIndex;let r=null;return t?(r=t instanceof HTMLElement?t:e.querySelector("[data-id="+t.id+"]"),r&&r.readonly?(e._closeContextMenu(),void(e.selectedIndex=null)):(e.querySelectorAll("[data-id]").forEach(t=>t.removeAttribute("selected")),e._closeContextMenu(),void(r?(e.selectedIndex=r.getAttribute("index"),r.setAttribute("selected",""),r.setAttribute("hover",""),e._selectedItem=r,r.classList.contains("smart-hidden")&&e.refresh(),e._handleButtonsVisibility(r),i!==e.selectedIndex&&e.$.fireEvent("change",{selectedIndex:e.selectedIndex,oldSelectedIndex:i}),e._updateSplitter()):e.refresh()))):(e._closeContextMenu(),e.selectedIndex=null,e.querySelectorAll("[data-id]").forEach(t=>t.removeAttribute("selected")),void(e._selectedItem=null))}_handleButtonClick(t,e){const i=this._addLayoutItem(t,e);this.$.fireEvent("stateChange",{type:"insert",item:i}),this._handleItemClick(i,!0)}_handleMenuItemClick(t){const e=this;if(!t||t.hasAttribute("disabled"))return;const i=t.getAttribute("value"),r=e._contextMenu;e.$.fireEvent("menuItemClick",{target:r?r._target:null,item:t,label:t.textContent,value:i});const n=r._target;n&&("select"===i&&e._handleItemClick(n.parentElement?n.parentElement:n),"delete"===i&&e._removeLayoutItem(n))}_removeLayoutItem(t){const e=this;if("root"!==t.getAttribute("data-id")){if(t instanceof i&&1===t.parentElement.items.length){let i=t.parentElement,r=i;for(;i&&i.items&&1===i.items.length&&"root"!==i.getAttribute("data-id");)r=i,i=i.parentElement;"root"!==r.getAttribute("data-id")?r.remove():e.allowLiveSplit&&r.appendChild(document.createElement("smart-layout-item"))}else t.remove();e.refresh(),e.$.fireEvent("stateChange",{type:"delete",item:t})}}refresh(){const t=this;if(t._isUpdating)return;t.dataSource=t._getDataSource(t._getLayout()),t.$.splitter.className="smart-visibility-hidden smart-layout-splitter";const e=e=>{const i=t.getItem(e.getAttribute("index"));if(!i)return;e.style.gridTemplateColumns="",e.style.gridTemplateRows="";let r="",s=0,a=0;if(e instanceof n){e.tabs&&e.tabs.remove();const r=document.createElement("div");r.classList.add("smart-layout-tab-strip"),t._selectedItem&&e.contains(t._selectedItem)&&t._selectedItem instanceof o&&(e.selectedIndex=Math.max(0,e.items.indexOf(t._selectedItem))),e.selectedIndex>=e.children.length&&(e.selectedIndex=0);for(let n=0;n<e.children.length;n++){const o=e.children[n],s=t.getItem(o.getAttribute("index"));if(!s)continue;const a=document.createElement("div");a.classList.add("smart-layout-tab"),a.innerHTML="<label>"+s.label+'</label><span class="smart-close-button"></span>',r.appendChild(a),o.setAttribute("tab",""),o.classList.add("smart-hidden"),a.content=o,a.item=s,a.group=i,o.modifiers?-1===o.modifiers.indexOf("close")&&a.querySelector(".smart-close-button").classList.add("smart-hidden"):a.querySelector(".smart-close-button").classList.add("smart-hidden"),void 0!==e.selectedIndex&&n!==e.selectedIndex||(a.classList.add("selected"),o.classList.remove("smart-hidden"),e.selectedIndex=n),a.onpointerup=function(i){i.target.classList.contains("smart-close-button")&&a.close&&(e.selectedIndex=0,t._removeLayoutItem(t._selectedItem),t._handleItemClick(parent))},a.onpointerdown=function(e){const i=this.closest(".smart-layout-group");t._handleItemClick(this.content),a.close=!1,e.target.classList.contains("smart-close-button")?a.close=!0:s.modifiers&&s.modifiers.indexOf("drag")>=0&&t._beginDrag(i,this,e)}}e.tabs=r,"top"===i.position||"left"===i.position?e.insertBefore(r,e.firstChild):e.appendChild(r)}else{for(let t=0;t<e.children.length;t++){const i=e.children[t];if(i.hasAttribute("size")){const t=i.getAttribute("size"),n=parseInt(t),o="vertical"===e.orientation?e.offsetWidth:e.offsetHeight,l=t.indexOf("%")>=0?parseInt(t):parseInt(n/o*100);if(s+=l,a++,a===e.children.length){if(s<100){r+="1fr ",s=100;continue}}else if(s>100||0===l){a=e.children.length,s=0;break}r+=l+"% "}else r+="1fr "}if(a===e.children.length&&(s<99||s>100)){r="";for(let t=0;t<e.children.length;t++){e.children[t].removeAttribute("size"),r+="1fr "}}"vertical"===e.orientation?e.style.gridTemplateColumns=r:e.style.gridTemplateRows=r}e.items=Array.from(e.children),e.items=e.items.filter(t=>t!==e.tabs)},i=t.querySelectorAll(".smart-layout-group");for(let t=0;t<i.length;t++)e(i[t])}_beginDrag(t,e,i){const r=this;r._dragDetails&&r._dragDetails.feedback.remove();const n=document.createElement("div"),o=document.createElement("div"),s=t.querySelector(".smart-layout-tab-strip");let a="";if(s)for(let e=0;e<Array.from(s.children).length;e++)e===t.selectedIndex&&(a=s.children[e].innerText);n.innerHTML=`<smart-layout><smart-tab-layout-group><smart-tab-layout-item label="${a}"></smart-tab-layout-item></smart-tab-layout-group></smart-layout>`,r._feedback=n,r._feedback.classList.add("smart-layout-feedback","smart-layout"),o.classList.add("smart-layout-overlay"),r._dragDetails={element:e.content,item:e.item,layoutGroup:e.group,parent:t,overlay:o,feedback:n,pageX:i.pageX,pageY:i.pageY}}moveChildren(t,e){e.innerHTML="";let i=t;for(;i.firstChild;){const t=i.firstChild;e.appendChild(t)}}createLayoutItem(t,e){return"layoutItem"!==t&&t?"tabLayoutItem"!==t&&t?"tabLayoutGroup"===t?(t=>{const e=document.createElement("smart-tab-layout-group"),i="top"===t||"bottom"===t?"horizontal":"vertical";return e.setAttribute("orientation",i),e.orientation=i,e})(e):(t=>{const e=document.createElement("smart-layout-group"),i="top"===t||"bottom"===t?"horizontal":"vertical";return e.setAttribute("orientation",i),e.orientation=i,e})(e):(()=>{const t=document.createElement("smart-tab-layout-item");return t.innerHTML="",t})():(()=>{const t=document.createElement("smart-layout-item");return t.innerHTML="",t})()}_addTabLayoutItem(t,e,s){const a=this,l=a.createLayoutItem("tabLayoutItem"),d=t.closest("smart-tab-layout-group");let c;s&&(l.label=s.label,l.modifiers=s.modifiers,a.moveChildren(s,l));const u=t=>{for(let e=0;e<t.children.length;e++){t.children[e].removeAttribute("size")}t.removeAttribute("size")},p=e=>{if(t.removeAttribute("size"),t.querySelector("smart-layout-group"))a._addLayoutItem(t.querySelector("smart-layout-group"),e);else{c=a.createLayoutItem("layoutGroup",e);const i=a.createLayoutItem();a.moveChildren(t,i),"top"===e||"left"===e?(c.appendChild(a.createLayoutItem()),c.appendChild(i)):(c.appendChild(i),c.appendChild(a.createLayoutItem())),t.appendChild(c)}},m=(e,i)=>{const r=t.parentElement,n=t,o=a.createLayoutItem("layoutGroup",i);r.insertBefore(o,n),"top"===i||"left"===i?(o.append(e),o.appendChild(n)):(o.appendChild(n),o.append(e)),"root"===n.getAttribute("data-id")&&(n.setAttribute("data-id",o.getAttribute("data-id")),o.setAttribute("data-id","root"),a.$.itemsContainer=o),u(n),u(r)};if(s)switch(e){case"center":if(t instanceof n||t instanceof o)d.appendChild(l);else{const e=a.createLayoutItem("tabLayoutGroup","top");e.appendChild(l),t instanceof r&&!(t instanceof o)?(t.appendChild(e),u(t)):t instanceof i&&(c=a.createLayoutItem("layoutGroup"),t.parentElement.insertBefore(c,t),c.appendChild(t),c.appendChild(e),u(c))}break;case"left":case"right":{const i=a.createLayoutItem("tabLayoutGroup","top");i.appendChild(l),"root"===t.getAttribute("data-id")?(i.position=e,m(i,e)):m(i,e)}break;case"top":case"bottom":{const i=a.createLayoutItem("tabLayoutGroup","top");i.appendChild(l),"root"===t.getAttribute("data-id")?(i.position=e,m(i,e)):m(i,e);break}}else{switch(e){case"center":t instanceof n||t instanceof o?d.appendChild(l):p();break;case"left":case"right":if(t instanceof n){const i=t.querySelector("smart-tab-layout-item");i&&"left"===e?t.insertBefore(l,i):t.appendChild(l)}else if(t instanceof o){const i=a.createLayoutItem("tabLayoutGroup","top"),r=t.parentElement;i.appendChild(l),c=a.createLayoutItem("layoutGroup"),r.parentElement.insertBefore(c,r),"right"===e?(c.appendChild(r),c.appendChild(i)):"left"===e&&(c.appendChild(i),c.appendChild(r))}else if(s){const e=a.createLayoutItem("tabLayoutGroup","top");e.appendChild(l),t instanceof r?t.insertBefore(t.firstChild,e):t instanceof i&&(c=a.createLayoutItem("layoutGroup"),c.orientation=d.orientation,c.setAttribute("orientation",d.orientation),t.removeAttribute("size"),t.parentElement.insertBefore(c,t),c.appendChild(t),c.appendChild(e))}else p(e);break;case"top":case"bottom":t instanceof n?(c=a.createLayoutItem("layoutGroup","top"),t.removeAttribute("size"),t.parentElement.insertBefore(c,t),"top"===e?(c.appendChild(a.createLayoutItem()),c.appendChild(t)):(c.appendChild(t),c.appendChild(a.createLayoutItem()))):p(e)}a.refresh()}}_addLayoutItem(t,e,s){const a=this;if(!t)return;const l=t=>{for(let e=0;e<t.children.length;e++){t.children[e].removeAttribute("size")}t.removeAttribute("size")};if(t instanceof o||t instanceof n||s&&s instanceof o)return a._addTabLayoutItem(t,e,s);const d=a.createLayoutItem(),c=t.closest(".smart-layout-group");let u;if(s&&a.moveChildren(s,d),"center"===e){if(t instanceof r)return u=c,u.appendChild(d),l(u),a.refresh(),d;if(t instanceof i)return u=a.createLayoutItem("layoutGroup"),u.orientation=c.orientation,u.setAttribute("orientation",c.orientation),t.removeAttribute("size"),t.parentElement.insertBefore(u,t),u.appendChild(t),u.appendChild(d),a.refresh(),u}if("vertical"===c.orientation&&("left"===e||"right"===e)||"horizontal"===c.orientation&&("top"===e||"bottom"===e))if(u=c,t instanceof r)"left"===e||"top"===e?u.insertBefore(d,u.children[0]):u.appendChild(d),l(t);else{const i=u.items,r=Math.max(0,i.indexOf(t)+("top"===e||"left"===e?0:1));u.insertBefore(d,i[r]),l(u)}else if(t instanceof r){const i=t.parentElement,r=t,n=a.createLayoutItem("layoutGroup",e);i.insertBefore(n,r),"top"===e||"left"===e?(n.append(d),n.appendChild(r)):(n.appendChild(r),n.append(d)),"root"===r.getAttribute("data-id")&&(r.setAttribute("data-id",n.getAttribute("data-id")),n.setAttribute("data-id","root"),a.$.itemsContainer=n),l(i)}else u=a.createLayoutItem("layoutGroup",e),c.insertBefore(u,t),"top"===e||"left"===e?(u.appendChild(d),u.appendChild(t)):(u.appendChild(t),u.appendChild(d)),l(u);return a.refresh(),d}_handleButtonsVisibility(t){const e=this;if(e._buttons||(e._buttons=document.createElement("div"),e._buttons.classList.add("smart-layout-buttons-container"),e._buttons.innerHTML='<div role="button" position="top"></div>\n                                       <div role="button" position="bottom"></div>\n                                       <div role="button" position="center"></div>\n                                       <div role="button" position="left"></div>\n                                       <div role="button" position="right"></div>'),t||!e._buttons.parentElement){if(t){const i=t._buttonPosition||[],r=e._buttons.children;for(let e=0;e<r.length;e++){const n=r[e];n.position=n.getAttribute("position"),n.item=t,i.length&&i.indexOf(n.getAttribute("position"))<0?n.classList.add("smart-hidden"):n.classList.remove("smart-hidden"),n.onmouseenter=()=>{n.setAttribute("hover","")},n.onmouseleave=()=>{n.removeAttribute("hover")}}e.allowLiveSplit&&e._buttons.parentElement!==t&&t.appendChild(e._buttons)}}else e._buttons.parentElement.removeChild(e._buttons)}_handleDropArea(t,e="center"){const i=this,r=t=>{switch(t){case"left":i._dropArea.style.top="0px",i._dropArea.style.left="0px",i._dropArea.style.width="50%",i._dropArea.style.height="100%";break;case"right":i._dropArea.style.top="0px",i._dropArea.style.left="calc(100% - 50%)",i._dropArea.style.width="50%",i._dropArea.style.height="100%";break;case"top":i._dropArea.style.top="0px",i._dropArea.style.left="0px",i._dropArea.style.width="100%",i._dropArea.style.height="50%";break;case"bottom":i._dropArea.style.top="calc(100% - 50%)",i._dropArea.style.left="0px",i._dropArea.style.width="100%",i._dropArea.style.height="50%";break;case"center":i._dropArea.style.top="0px",i._dropArea.style.left="0px",i._dropArea.style.width="100%",i._dropArea.style.height="100%"}};i._dropArea&&i._dropArea.parentElement===t?r(e):(i._dropArea&&i._dropArea.remove(),i._dragDetails&&t&&(i._dropArea=document.createElement("div"),i._dropArea.classList.add("smart-layout-drop-area"),t.appendChild(i._dropArea),i._dropArea.style.opacity=1,r(e)))}_handleSplitter(t){const e=this;if(!t)return;if(t.hasAttribute("tab")&&(t=t.parentElement),t._splitter&&t._splitter.remove(),t._splitter||(t._splitter=document.createElement("div")),e._dragDetails&&e._dragDetails.dragging)return void t._splitter.remove();if(-1===t.modifiers.indexOf("resize"))return;t.appendChild(t._splitter);const i=t.parentElement;if(i){t._splitter.className="smart-layout-splitter",t._splitter.item=t,t._splitter.removeAttribute("drag");const r=i.orientation;t.nextElementSibling&&t.nextElementSibling.hasAttribute("data-id")?t._splitter.classList.add(r):t.previousElementSibling&&t.previousElementSibling.hasAttribute("data-id")&&(t._splitter.classList.add(r),t._splitter.classList.add("last")),(t=>{t.style.top="",t.style.left="",t.style.bottom="",t.style.right="",t.onpointerdown=t=>{const i=t.target.item;i.style.overflow="hidden",e._resizeDetails={splitter:t.target,splitterRect:t.target.getBoundingClientRect(),itemRect:i.getBoundingClientRect(),item:i,itemSize:i.size,group:i.parentElement,clientX:t.clientX,clientY:t.clientY},e._selectedItem!==i&&(e.querySelectorAll("[data-id]").forEach(t=>t.removeAttribute("selected")),e.selectedIndex=i.getAttribute("index"),i.setAttribute("selected",""),e._selectedItem=i,e._handleButtonsVisibility(i)),i.previousElementSibling&&i.previousElementSibling.hasAttribute("data-id")?(e._resizeDetails.previousItemRect=i.previousElementSibling.getBoundingClientRect(),e._resizeDetails.previousItem=i.previousElementSibling,e._resizeDetails.previousItemSize=i.previousElementSibling.size,e._resizeDetails.previousItem.style.overflow="hidden"):(e._resizeDetails.previousItemRect=null,e._resizeDetails.previousItem=null),i.nextElementSibling&&i.nextElementSibling.hasAttribute("data-id")?(e._resizeDetails.nextItemRect=i.nextElementSibling.getBoundingClientRect(),e._resizeDetails.nextItem=i.nextElementSibling,e._resizeDetails.nextItemSize=i.nextElementSibling.size,e._resizeDetails.nextItem.style.overflow="hidden"):(e._resizeDetails.nextItemRect=null,e._resizeDetails.nextItem=null)}})(t._splitter)}}})}});
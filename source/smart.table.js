
/* Smart UI v7.7.0 (2020-June) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function l(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,l),r.l=!0,r.exports}l.m=e,l.c=t,l.d=function(e,t,a){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)l.d(a,r,function(t){return e[t]}.bind(null,r));return a},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l(l.s=97)}({97:function(e,t){Smart("smart-table",class extends Smart.ContentElement{static get properties(){return{columns:{value:[],type:"any?",reflectToAttribute:!1},columnReorder:{value:!1,type:"boolean"},dataSource:{value:null,type:"any?",reflectToAttribute:!1},editing:{value:!1,type:"boolean"},editMode:{value:"cell",allowedValues:["cell","row"],type:"string"},filtering:{value:!1,type:"boolean"},filterRow:{value:!1,type:"boolean"},filterTemplate:{value:null,type:"string?"},footerRow:{value:null,type:"string?"},freezeFooter:{value:!1,type:"boolean"},freezeHeader:{value:!1,type:"boolean"},grouping:{value:!1,type:"boolean"},headerRow:{value:null,type:"string?"},keyboardNavigation:{value:!1,type:"boolean"},messages:{value:{en:{clearFilter:"Clear filter",CONTAINS:"contains",CONTAINS_CASE_SENSITIVE:"contains (case sensitive)",DOES_NOT_CONTAIN:"does not contain",DOES_NOT_CONTAIN_CASE_SENSITIVE:"does not contain (case sensitive)",EMPTY:"empty",ENDS_WITH:"ends with",ENDS_WITH_CASE_SENSITIVE:"ends with (case sensitive)",EQUAL:"equal",EQUAL_CASE_SENSITIVE:"equal (case sensitive)",filterPlaceholder:"Filter",filterCondition:"Filter condition",firstButton:"First",GREATER_THAN:"greater than",GREATER_THAN_OR_EQUAL:"greater than or equal",invalidValue:"Invalid value",itemsPerPage:"Items per page:",lastButton:"Last",LESS_THAN:"less than",LESS_THAN_OR_EQUAL:"less than or equal",nextButton:"Next",NOT_EMPTY:"not empty",NOT_EQUAL:"not equal",NOT_NULL:"not null",NULL:"null",previousButton:"Previous",STARTS_WITH:"starts with",STARTS_WITH_CASE_SENSITIVE:"starts with (case sensitive)",summaryPrefix:"of"}},type:"object",extend:!0},onCellRender:{value:null,type:"function?"},onColumnRender:{value:null,type:"function?"},onInit:{value:null,type:"function?"},pageSize:{value:10,allowedValues:[10,25,50],type:"int"},pageIndex:{value:0,type:"int"},paging:{value:!1,type:"boolean"},rowDetailTemplate:{value:null,type:"string?"},selection:{value:!1,type:"boolean"},sortMode:{value:"none",type:"string",allowedValues:["none","one","many"]}}}static get listeners(){return{resize:"_resizeHandler","filterInput.keyup":"_filterInputKeyupHandler","pager.change":"_pagerChangeHandler","pager.pageSizeChanged":"_pagerPageSizeChanged","tableContainer.change":"_tableContainerChangeHandler","tableContainer.click":"_tableContainerClickHandler","tableContainer.down":"_tableContainerDownHandler","tableContainer.focus":"_tableContainerFocusHandler","tableContainer.keydown":"_tableContainerKeydownHandler","tableContainer.keyup":"_tableContainerKeyupHandler","document.down":"_documentDownHandler","document.move":"_documentMoveHandler","document.up":"_documentUpHandler"}}template(){return'<div id="container" class="smart-container" role="presentation">\n                    <div id="header" class="smart-table-header">\n                        <smart-input id="filterInput" class="underlined" animation="[[animation]]" locale="[[locale]]" right-to-left="[[rightToLeft]]"></smart-input>\n                        <div id="filterTemplateContainer" class="smart-table-filter-template-container smart-hidden"></div>\n                    </div>\n                    <table id="tableContainer" inner-h-t-m-l=\'[[innerHTML]]\' class="smart-table-container">\n                        <content></content>\n                    </table>\n                    <smart-pager id="pager" animation="[[animation]]" locale="[[locale]]" page-index="[[pageIndex]]" page-size="[[pageSize]]" show-first-last-navigation-buttons show-page-size-selector show-prev-next-navigation-buttons show-summary right-to-left="[[rightToLeft]]"></smart-pager>\n                    <div id="loadingIndicatorContainer" class="smart-loader-container smart-hidden" aria-label="Loading">\n                        <span id="loadingIndicator" class="smart-loader" role="presentation"></span>\n                    </div>\n                </div>'}render(){const e=this;e.setAttribute("role","presentation"),e._isMobile=Smart.Utilities.Core.isMobile,e._autoScrollCoefficient=Smart.Utilities.Core.Browser.Firefox?8:Smart.Utilities.Core.Browser.Edge?16:4,e._selectedIds=[],e._disabledSelection=[],e._setFocusable(),e.selection&&e.$.tableContainer.setAttribute("aria-multiselectable",!0),e._createElement(),super.render()}addFilter(e,t){const l=this,a=l._columns.find(t=>t.dataField===e);a&&!1!==a.allowFilter&&t instanceof Smart.Utilities.FilterGroup!=!1&&(l._filterInfo.appliedFilters||(l._filterInfo.appliedFilters={}),l._filterInfo.appliedFilters[e]=t,l._refreshFilters())}addGroup(e){if(!this.grouping)return;const t=this._columns.find(t=>t.dataField===e);if(!t||!1===t.allowGroup)return;const l=this.dataSource,a=l.groupBy;-1===a.indexOf(e)&&(a.push(e),l.refreshHierarchy(),this._fullRefresh(),this.$.fireEvent("group",{action:"add",dataField:e}))}beginEdit(e,t){const l=this;if(!l.editing)return;const a=l._columns.find(e=>e.dataField===t);if(a||(t=void 0),"cell"===l.editMode&&!t||a&&!1===a.allowEdit)return;const r=l.rowById[e];if(!r)return;const i=r.data.$.id;l._editing&&l.endEdit(),l._beginEdit({rowId:i,rowObject:r,dataField:t})}cancelEdit(){const e=this,t=e._editing;if(t){for(let l=0;l<t.cells.length;l++){const a=t.cells[l];a.editor.contains((e.shadowRoot||e.getRootNode()).activeElement)&&e._focusCell(a.element),a.editor.remove(),a.element.innerHTML=e._formatCellValue(t.row,e._columns.find(e=>e.dataField===a.dataField),a.element),a.element.classList.remove("editing")}delete e._editing}}clearFilters(){const e=this;e._clearFilterInput(),e._clearRowFilters(),delete e._filterInfo.appliedFilters,e.dataSource.virtualDataSource||e.dataSource.clearFilter(),e._fullRefresh("filter"),e.$.fireEvent("filter",{action:"remove"})}clearGrouping(){const e=this.dataSource;0!==e.groupBy.length&&(e.groupBy=[],e.refreshHierarchy(),this._fullRefresh(),this.$.fireEvent("group",{action:"remove"}))}clearSelection(){0!==this._selectedIds.length&&(Array.from(this.$.tableContainer.querySelectorAll(".smart-table-select-row")).forEach(e=>{e.parentElement.setAttribute("aria-selected",!1),e.classList.remove("selected")}),this.$.tableContainer.querySelector(".smart-table-select-all").classList.remove("indeterminate","selected"),this._selectedIds=[])}collapseAllRows(){const e=this;e.hasAttribute("hierarchy")&&!e.grouping&&function t(l){for(let a=0;a<l.length;a++){const r=l[a];r.leaf||(r.children&&t(r.children),r.expanded&&e.collapseRow(r.$.id))}}(e.dataSource.boundHierarchy)}collapseGroup(e){if(!this.grouping||0===this.dataSource.groupBy.length)return;const t=this._getGroupByIndex(e);if(!t||!t.expanded)return;const l=this.$.tableContainer.querySelector(`tr[row-id="${t.$.id}"]`);if(this.$.fireEvent("group",{action:"collapse",dataField:t.groupDataField,label:t.label}),l)return this._isCollapsed(t)?(l.setAttribute("aria-expanded",!1),l.classList.remove("expanded"),void(t.expanded=!1)):void this._hierarchyArrowClickHandler(l);t.expanded=!1}collapseRow(e){if(!this.hasAttribute("hierarchy")||this.grouping)return;const t=this.rowById[e],l=t.data;if(!t||l.leaf||!l.expanded)return;const a=this.$.tableContainer.querySelector(`tr[row-id="${e}"]`);if(a)return this._isCollapsed(l)?(a.setAttribute("aria-expanded",!1),a.classList.remove("expanded"),void(l.expanded=!1)):void this._hierarchyArrowClickHandler(a);l.expanded=!1}endEdit(){const e=this,t=e._editing;if(!t)return;const l=t.row,a=l.data,r=[];let i=!0;for(let l=0;l<t.cells.length;l++){const a=t.cells[l],n=e._columns.find(e=>e.dataField===a.dataField),o=a.element,s=a.editor;let d;if(n.editor&&n.editor.template?n.editor.getValue&&(d=n.editor.getValue(s)):(d=s.value,s instanceof HTMLInputElement&&("number"===s.type?d=parseFloat(d):"date"===s.type&&(d=new Date(d),isNaN(d.getTime())&&(d=null)))),n.validation){const t=n.validation(d),l=void 0!==t&&!0!==t;if(l){let l;l="object"==typeof t&&t.message?t.message:e.localize("invalidValue"),o.setAttribute("validation-message",l)}else o.removeAttribute("validation-message");o.classList.toggle("invalid",l),i=i&&!l}r.push({column:n,newValue:d})}if(i){for(let i=0;i<t.cells.length;i++){const n=t.cells[i],o=r[i],s=o.column,d=n.editor;d.contains((e.shadowRoot||e.getRootNode()).activeElement)&&e._focusCell(n.element),d.remove(),a[n.dataField]=o.newValue,n.element.innerHTML=e._formatCellValue(l,s,n.element),n.element.classList.remove("editing"),e.$.fireEvent("cellEndEdit",{row:a,dataField:n.dataField})}delete e._editing}}expandAllRows(){const e=this;e.hasAttribute("hierarchy")&&!e.grouping&&function t(l){for(let a=0;a<l.length;a++){const r=l[a];r.leaf||(r.children&&t(r.children),r.expanded||e.expandRow(r.$.id))}}(e.dataSource.boundHierarchy)}expandGroup(e){const t=this,l=t.dataSource;if(!t.grouping||0===l.groupBy.length)return;const a=t._getGroupByIndex(e);if(!a)return;const r=t.$.tableContainer.querySelector(`tr[row-id="${a.$.id}"]`);if(a.expanded||t.$.fireEvent("group",{action:"expand",dataField:a.groupDataField,label:a.label}),r){if(t._isCollapsed(a)){let e=a.parent;e&&!e.expanded&&t.expandGroup(a.parent.$.id.replace("Item","").replace(/_/g,"."))}a.expanded||t._hierarchyArrowClickHandler(r)}else a.expanded=!0}expandRow(e){const t=this;if(!t.hasAttribute("hierarchy")||t.grouping)return;const l=t.rowById[e],a=l.data;if(!l||a.leaf)return;const r=t.$.tableContainer.querySelector(`tr[row-id="${e}"]`);if(r){if(t._isCollapsed(a)){let e=a.parent;e&&!e.expanded&&t.expandRow(e.$.id)}a.expanded||t._hierarchyArrowClickHandler(r)}else a.expanded=!0}exportData(e,t,l,a){const r=this,i=r.dataSource,n=getComputedStyle(r),o=n.borderRightColor,s=new Smart.Utilities.DataExporter(void 0,i.groupBy.toArray()),d={},c=r.$.tableContainer.firstElementChild.querySelectorAll("th");let u;if(i.virtualDataSource){u=[];for(let e=0;e<r.rows.length;e++)u.push(r.rows[e].data)}else i.boundHierarchy&&!r.grouping?(s.hierarchical=!0,u=function e(t){const a=[];return t.forEach(t=>{l&&!1===t.$.filtered||(a.push(t),t.leaf||(t._expanded=t.expanded,t.children&&(t.children=e(t.children),0===t.children.length&&(t._expanded=void 0,t.children=void 0,t.leaf=!0))))}),a}(JSON.parse(JSON.stringify(i.boundHierarchy,(e,t)=>{if("parent"!==e)return t})))):(u=Array.from(i.toArray()),l&&(u=u.filter(e=>!1!==e.$.filtered)));s.style={border:"1px solid "+o,borderCollapse:"collapse",backgroundColor:n.backgroundColor,color:n.color,fontFamily:"Helvetica",header:{border:"1px solid "+o,fontWeight:"bold"},columns:{border:"1px solid "+o}};for(let e=0;e<r._columns.length;e++){const t=r._columns[e],l={},a={};let i=c[e].offsetWidth+"px";d[t.dataField]=t.label,"date"===t.dataType&&(a.format="d"),l.width=i,s.style.header[t.dataField]=l,s.style.columns[t.dataField]=a}return u.unshift(d),s.exportData(u,e,t,a)}getSelection(){return this._selectedIds}getValue(e,t){if(!this._columns.find(e=>e.dataField===t))return;const l=this.rowById[e];return l?l.data[t]:void 0}navigateTo(e){const t=this;if(isNaN(e)||null===e)return;const l=t.pageIndex;t.pageIndex=Math.max(Math.min(Math.round(e),t.$.pager.pagesCount-1),0),t.paging&&t.pageIndex!==l&&(t._fullRefresh("pageIndexChange"),t.$.fireEvent("page",{action:"pageIndexChange"}))}removeFilter(e){this._filterInfo.appliedFilters&&this._columns.find(t=>t.dataField===e)&&(delete this._filterInfo.appliedFilters[e],this._refreshFilters())}removeGroup(e){if(!this.grouping||!this._columns.find(t=>t.dataField===e))return;const t=this.dataSource,l=t.groupBy,a=l.indexOf(e);-1!==a&&(l.splice(a,1),t.refreshHierarchy(),this._fullRefresh(),this.$.fireEvent("group",{action:"remove",dataField:e}))}select(e){if(!this.selection)return;const t=this.rowById?this.rowById[e]:this.rows.find(t=>t.$.id===e);if(!t)return;const l=t.data?t.data.$.id:t.$.id;if(-1!==this._selectedIds.indexOf(l)||-1!==this._disabledSelection.indexOf(l))return;const a=this.$.tableContainer.querySelector(`tr[row-id="${l}"`);this._selectedIds.push(l),a&&(a.firstElementChild.classList.add("selected"),a.setAttribute("aria-selected",!0)),this._updateSelectAllState()}setValue(e,t,l){const a=this._columns.find(e=>e.dataField===t);if(!a)return;const r=this.rowById[e];if(!r)return;const i=this.$.tableContainer.querySelector(`tr[row-id="${e}"] td[data-field="${t}"]`);this.dataSource._updating=!0,r.data[t]=l,i.innerHTML=this._formatCellValue(r,a,i),delete this.dataSource._updating}unselect(e){if(!this.selection)return;const t=this.rowById?this.rowById[e]:this.rows.find(t=>t.$.id===e);if(!t)return;const l=t.data?t.data.$.id:t.$.id,a=this._selectedIds.indexOf(l);if(-1===a)return;const r=this.$.tableContainer.querySelector(`tr[row-id="${l}"`);this._selectedIds.splice(a,1),r&&(r.firstElementChild.classList.remove("selected"),r.setAttribute("aria-selected",!1)),this._updateSelectAllState()}propertyChangedHandler(e,t,l){super.propertyChangedHandler(e,t,l);const a=this;switch(e){case"animation":if(a.filterRow){const e=a.$.tableContainer.querySelector(".smart-table-filter-row");Array.from(e.querySelectorAll("smart-input, smart-button")).forEach(e=>e.animation=l)}break;case"columns":a._initColumns(),a.refresh();break;case"dataSource":a._dataBind();break;case"disabled":case"unfocusable":case"keyboardNavigation":a._setFocusable();break;case"editing":l?a.$.tableContainer.removeAttribute("aria-readonly"):a.$.tableContainer.setAttribute("aria-readonly",!0);break;case"filtering":l&&a.filterRow?a._createFilterRow():!1===l&&(a.filterRow&&a.$.tableContainer.querySelector(".smart-table-filter-row").remove(),(a._filterInfo.query||a._filterInfo.rowFilters||a._filterInfo.appliedFilters)&&a.clearFilters());break;case"filterRow":if(a.$.header.classList.toggle("smart-hidden",l&&!a.filterTemplate),!a.filtering)return;l?a._createFilterRow():(a.$.tableContainer.querySelector(".smart-table-filter-row").remove(),a._filterInfo.rowFilters&&a.clearFilters());break;case"filterTemplate":a._applyFilterTemplate(),a.$.header.classList.toggle("smart-hidden",a.filterRow&&!a.filterTemplate);break;case"footerRow":{const e=a.$.tableContainer.querySelector("tfoot");e&&e.remove(),l&&a._createFooterRow();break}case"grouping":l||a.clearGrouping();break;case"headerRow":{const e=Array.from(a.$.tableContainer.firstElementChild.children);for(let t=1;t<e.length;t++)e[t].remove();l&&a._createCustomHeaderRow();break}case"locale":case"messages":if(a._localize(),a.filterRow){const e=a.$.tableContainer.querySelector(".smart-table-filter-row"),t=Array.from(e.querySelectorAll("smart-input.string-filter")),l=Array.from(e.querySelectorAll("smart-input.num-date-filter")),r=Array.from(e.querySelectorAll("smart-button"));t.concat(l).forEach(e=>e.title=a.localize("filterCondition")),t.forEach(e=>{e.dataSource=a._filterInfo.stringConditions,void 0===e.$.input.dataValue?e.value=a.localize("CONTAINS"):e.value=a._filterInfo.stringConditions.find(t=>t.value===e.$.input.dataValue).label}),l.forEach(e=>{e.dataSource=a._filterInfo.numberAndDateConditions,void 0===e.$.input.dataValue?e.value=a.localize("EQUAL"):e.value=a._filterInfo.numberAndDateConditions.find(t=>t.value===e.$.input.dataValue).label}),r.forEach(e=>e.title=a.localize("clearFilter"))}break;case"pageIndex":a.pageIndex=Math.max(Math.min(Math.round(l),a.$.pager.pagesCount-1),0),a.paging&&a.pageIndex!==t&&(a._fullRefresh("pageIndexChange"),a.$.fireEvent("page",{action:"pageIndexChange"}));break;case"pageSize":a.paging&&(a._fullRefresh("pageSizeChange"),a.$.fireEvent("page",{action:"pageSizeChange"}));break;case"paging":if(!1===l){if(a.dataSource.virtualDataSource)return void(a.paging=!0);if(1===a.$.pager.pagesCount)return}a._fullRefresh();break;case"rightToLeft":Array.from(a.$.tableContainer.querySelectorAll(".freeze-near, .freeze-far")).forEach(e=>{e.style.left=null,e.style.right=null,e.style.zIndex=null}),a._handleFrozenColumnPositions();break;case"selection":if(a.filterRow){const e=a.$.tableContainer.querySelector(".smart-table-filter-row");l?e.insertBefore(document.createElement("td"),e.firstElementChild):e.firstElementChild.remove()}a.refresh(),l?(a.$.tableContainer.setAttribute("aria-multiselectable",!0),a._updateSelectAllState()):a.$.tableContainer.removeAttribute("aria-multiselectable");break;case"sortMode":l||a.clearSort()}}_createElement(){const e=this;e._expandedIds=[],e._dblclickObject={numberOfClicks:0},e._editors={},e._setupPagingAndFiltering(),e._localize(),e._dataBind(),e.editing||e.$.tableContainer.setAttribute("aria-readonly",!0)}_initColumns(){const e=this,t=e.columns;!e.isRendered&&e.dataSource.length>0&&(!t||Array.isArray(t)&&0===t.length)&&(e.columns=e.dataSource.dataFields.map(e=>({label:e.name,dataField:e.name,dataType:e.dataType}))),e._filterInfo.stringDataFields=[],e._columns=[],e.columnByDataField={};for(let t=0;t<e.columns.length;t++){let l=e.columns[t];if("string"==typeof l&&e.dataSource.dataFields){const t=e.dataSource.dataFields.find(e=>{if(e.name===l)return e});l={label:l,dataField:l,dataType:t&&t.dataType||"string"}}void 0===l.label&&void 0===l.dataField||(void 0===l.label&&(l.label=l.dataField),void 0===l.dataField&&(l.dataField=l.label),l.dataType||(l.dataType="string"),"string"!==l.dataType&&"number"!==l.dataType||!1===l.allowFilter||e._filterInfo.stringDataFields.push(l.dataField),e._columns.push(l),e.columnByDataField[l.dataField]=l)}e.columns=new Smart.ObservableArray(e._columns),e.columns.notify((function(t){if(e.columns.canNotify&&"length"!==t.action&&("update"!==t.action||-1===["allowGroup","allowSort","sortOrder"].indexOf(t.propertyName))){if("update"===t.action){const l=t.target.dataField;if("allowEdit"===t.propertyName)return void Array.from(e.$.tableContainer.querySelectorAll(`td[data-field="${l}"]`)).forEach(e=>{e.classList.toggle("no-edit",!1===t.newValue),!1===t.newValue?e.setAttribute("aria-readonly",!0):e.removeAttribute("aria-readonly")});if("allowFilter"===t.propertyName)return"string"!==t.target.dataType&&"number"!==t.target.dataType||(!1===t.newValue?e._filterInfo.stringDataFields=e._filterInfo.stringDataFields.filter(e=>e!==l):!1===t.oldValue&&e._filterInfo.stringDataFields.push(l)),void(e.filterRow&&e.$.tableContainer.querySelector(`.smart-table-filter-row td[filter-for="${l}"]`).classList.toggle("no-filter",!1===t.newValue))}e._columns=e.columns._array,e.columnByDataField=[],e._columns.forEach(t=>e.columnByDataField[t.dataField]=t),e.refresh()}})),e.$.tableContainer.setAttribute("aria-colcount",e._columns.length+ +e.selection)}_initRows(){const e=this,t=e.dataSource,l=e.context;if(e.context=e,e.rows=[],e.rowById=[],t.boundHierarchy)return e.$.tableContainer.setAttribute("role","treegrid"),e.setAttribute("hierarchy",""),void e._initHierarchicalRows();e.$.tableContainer.setAttribute("role","grid");let a=0,r=t.length,i=!1;if(e.removeAttribute("hierarchy"),e.paging){const l=e.pageSize;if(e._filterInfo.query||e._filterInfo.rowFilters||e._filterInfo.appliedFilters){let e=0;for(let l=0;l<r;l++)!1!==t[l].$.filtered&&e++;r=e,i=!0}const n=Math.max(Math.ceil(r/l),1),o=e.$.pager.pagesCount;if(e.$.pager.pagesCount=n,e.$.pager.totalRecords=r,e.pageIndex=Math.max(Math.min(e.pageIndex,n-1),0),e.dataSource.virtualDataSource&&o!==n)return void e._fullRefresh();a=e.pageIndex*l,r=a+l}if(i){let l=-1;for(let i=0;i<t.length;i++){const n=t[i];if(n&&!1!==n.$.filtered){if(l++,l<a)continue;if(l>=r)break;e._addNewRow(n,i)}}}else for(let l=a;l<r;l++){const a=t[l];a&&!1!==a.$.filtered&&e._addNewRow(a,l)}e._observeRows(),e.context=l}_initHierarchicalRows(){const e=this,t=e.dataSource.boundHierarchy;let l=0,a=t.length,r=!1;if(e.paging){const i=e.pageSize;if(e._filterInfo.query||e._filterInfo.rowFilters||e._filterInfo.appliedFilters){let e=0;for(let l=0;l<a;l++)!1!==t[l].$.filtered&&e++;a=e,r=!0}const n=Math.max(Math.ceil(a/i),1);e.$.pager.pagesCount=n,e.$.pager.totalRecords=a,e.pageIndex=Math.max(Math.min(e.pageIndex,n-1),0),l=e.pageIndex*i,a=l+i}function i(t,l,a){for(let r=l;r<a;r++){const l=t[r];if(!l)break;l.leaf?l&&!1!==l.$.filtered&&e._addNewRow(l,r):(void 0===l.expanded&&(l.expanded=!1),l.children.length&&!1!==l.$.filtered&&(e._addNewRow(l,r),i(l.children,0,l.children.length)))}}if(r){let e=-1;for(let r=0;r<t.length;r++){const n=t[r];if(n&&!1!==n.$.filtered){if(e++,e<l)continue;if(e>=a)break;i(t,r,r+1)}}}else i(t,l,a);e._observeRows()}_observeRows(){const e=this;e.rows=new Smart.ObservableArray(e.rows),e.rows.notify((function(t){if(!e.rows.canNotify||t.path||!e.dataSource)return;e.rows.canNotify=!1;const l=t.action;switch(e.dataSource.canNotify=!1,l){case"add":e.dataSource.add(e.rows[t.index]);break;case"update":e.dataSource.update(t.index,e.rows[t.index]);break;case"remove":e.dataSource.removeAt(t.index)}e.dataSource.canNotify=!0,e.rows.canNotify=!0,e._fullRefresh()}))}_addNewRow(e,t){const l=this,a=e.$.id,r=new Smart.Observable({data:e,boundIndex:t});-1!==l._disabledSelection.indexOf(a)&&(r.allowSelect=!1),r.canNotify=!0,r.notify((function(e){if(!l._editing&&"allowSelect"===e.propertyName){const t=l.$.tableContainer.querySelector(`[row-id="${a}"]`),r=l._disabledSelection.indexOf(a);e.newValue||-1!==r?e.newValue&&-1!==r&&(t.setAttribute("aria-selected",!1),t.classList.remove("disable-select"),l._disabledSelection.splice(r,1)):(l.unselect(a),t.removeAttribute("aria-selected"),t.classList.add("disable-select"),l._disabledSelection.push(a))}})),l.rowById[a]=r,l.rows.push(r)}refresh(){const e=this,t=e.selection,l=e.$.tableContainer,a=l.querySelector(".smart-table-filter-row"),r=l.querySelector("tfoot"),i=document.createElement("tbody"),n=document.createElement("thead"),o=document.createElement("tr"),s=document.createDocumentFragment();e.columns.canNotify=!1,l.innerHTML="",t&&(o.innerHTML='<th class="smart-table-select-all freeze-near" scope="col" aria-colindex="1"><div></div></th>');for(let l=0;l<e._columns.length;l++){const a=document.createElement("th"),r=e._columns[l];a.setAttribute("aria-colindex",l+1+ +t),r.width&&!isNaN(parseFloat(r.width))&&("number"==typeof r.width&&(r.width+="px"),a.style.width=r.width),r.freeze&&a.classList.add("freeze-"+("far"===r.freeze?"far":"near")),r.responsivePriority&&("number"!=typeof r.responsivePriority&&(r.responsivePriority=1),r.responsivePriority=Math.max(Math.min(Math.round(r.responsivePriority),5),1),a.classList.add("priority-"+r.responsivePriority)),a.setAttribute("data-field",r.dataField),a.innerHTML=r.label,e.onColumnRender&&e.onColumnRender(r.dataField,a),s.appendChild(a)}o.appendChild(s),n.appendChild(o),l.appendChild(n),!e.isRendered&&e.onInit&&e.onInit(),e._createDataRows(i),l.appendChild(i),e._createCustomHeaderRow(),e._createFilterRow(a),e._createFooterRow(r);const d=l.querySelectorAll("th[data-field]");for(let t=0;t<e._columns.length;t++){const l=e._columns[t];l.headerCellElement=d[t],l.headerCellElement.onclick=function(){const t=this.dataField;e.$.fireEvent("columnClick",{dataField:t}),"none"!==e.sortMode&&!1!==l.allowSort&&(e._addSortIconContainer(this),this.headerCellElement.sortIconContainerElement.classList.contains("asc")?e.sortBy(t,"desc"):this.headerCellElement.sortIconContainerElement.classList.contains("desc")?e.sortBy(t,null):e.sortBy(t,"asc"))}.bind(l)}if(e._sortColumns&&e._sortColumns.length>0)for(let t=0;t<e._sortColumns.length;t++){const l=e._sortColumns[t],a=e.columnByDataField[l.dataField];a.headerCellElement.sortIconContainerElement||(a.headerCellElement.innerHTML+='<span class="sort-by '+l.direction+'"></span>',a.headerCellElement.sortIconContainerElement=a.headerCellElement.lastChild)}e._handleFrozenColumnPositions(),e.columns.canNotify=!0}_refreshDataRows(){const e=this.$.tableContainer.children[1],t=Array.from(e.querySelectorAll("tr:not(.smart-table-filter-row)"));for(let e=0;e<t.length;e++)t[e].remove();this._createDataRows(e),this._handleFrozenColumnPositions()}_createDataRows(e){const t=this,l=t.rowDetailTemplate,a=t.selection,r=document.createDocumentFragment(),i=t.hasAttribute("hierarchy");for(let e=0;e<t.rows.length;e++){const n=t.rows[e],o=n.data;if(o.groupDataField){t._createGroupHeader(o,a,r);continue}const s=o.$.id,d=document.createElement("tr");let c=0;if(d.setAttribute("aria-rowindex",o.$.index+1),a){const e=document.createElement("td"),l=-1!==t._selectedIds.indexOf(s);e.className=`smart-table-select-row freeze-near${l?" selected":""}`,e.innerHTML="<div></div>",e.setAttribute("aria-colindex",1),d.appendChild(e),d.setAttribute("aria-selected",l),c++}for(let e=0;e<t._columns.length;e++){const l=document.createElement("td"),r=t._columns[e];l.setAttribute("data-field",r.dataField),l.setAttribute("aria-colindex",e+1+ +a);let s=t._formatCellValue(n,r,l);if(r.freeze&&l.classList.add("freeze-"+("far"===r.freeze?"far":"near")),r.responsivePriority&&l.classList.add("priority-"+r.responsivePriority),!1===r.allowEdit&&(l.classList.add("no-edit"),l.setAttribute("aria-readonly",!0)),0===e&&i){const e=t._areChildrenFiltered(o);o.leaf||(l.classList.add("tree-cell"),e&&(s=`<div>\n                                        <div class="hierarchy-arrow smart-arrow smart-arrow-down"></div>\n                                        <div>${s}</div>\n                                    </div>`)),o.level&&(l.classList.add("outline-level-"+Math.min(o.level,10)),!o.leaf&&e||l.classList.add("tree-leaf"))}l.innerHTML=s,t.onCellRender&&t.onCellRender(o,r.dataField,o[r.dataField],l),d.appendChild(l),c++}if(d.data=o,d.setAttribute("row-id",s),-1!==t._disabledSelection.indexOf(s)&&(d.removeAttribute("aria-selected"),d.classList.add("disable-select")),o.expanded&&(d.setAttribute("aria-expanded",!0),d.classList.add("expanded")),o.level&&t._isCollapsed(o)&&(d.setAttribute("aria-hidden",!0),d.classList.add("collapsed")),r.appendChild(d),l){const e=document.createElement("tr");e.className="smart-table-row-detail",-1===t._expandedIds.indexOf(s)&&(e.setAttribute("aria-hidden",!0),e.classList.add("collapsed")),e.innerHTML=`<td colspan="${c}"><div class="smart-table-detail-container">${t._applyRowDetailTemplate(n)}</div></td>`,r.appendChild(e)}}r.appendChild(t._createLastRow()),e.appendChild(r)}_createLastRow(){const e=document.createElement("tr");return e.setAttribute("aria-hidden",!0),e.classList.add("last-visible"),e}_createGroupHeader(e,t,l){const a=this,r=a._columns.find(t=>t.dataField===e.groupDataField).label,i=document.createElement("tr"),n=document.createElement("td"),o=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div");i.data=e,s.classList.add("hierarchy-arrow","smart-arrow","smart-arrow-down"),d.classList.add("group-label"),d.innerHTML=`${r}: <span class="group-label-value">${e.label}</span>`,n.colSpan=a._columns.length,n.classList.add("group-header"),e.level&&(n.classList.add("outline-level-"+Math.min(e.level,10)),a._isCollapsed(e)&&(i.setAttribute("aria-hidden",!0),i.classList.add("collapsed"))),i.setAttribute("row-id",e.$.id),o.appendChild(s),o.appendChild(d),n.appendChild(o),t&&i.appendChild(document.createElement("td")),i.appendChild(n),l.appendChild(i)}_isCollapsed(e){let t=e.parent;for(;t;){if(!t.expanded)return!0;t=t.parent}return!1}_areChildrenFiltered(e){if(!e.leaf){for(let t=0;t<e.children.length;t++)if(!1!==e.children[t].$.filtered)return!0;return!1}}_applyRowDetailTemplate(e){const t=this,l=t.dataSource.dataFields;let a=t.rowDetailTemplate;for(let r=0;r<l.length;r++){const i=l[r].name,n=new RegExp(`{{${i}}}`,"g");let o=t._columns.find(e=>e.dataField===i)||{dataField:i};if(n.test(a)){const l=t._formatCellValue(e,o,document.createElement("td"));a=a.replace(n,l)}}return a}_handleFrozenColumnPositions(){const e=this,t=e.rightToLeft,l=e._columns;let a=[],r=[],i=0;function n(t,l,a,r,i){Array.from(e.$.tableContainer.querySelectorAll(`th:nth-child(${l+1}), td:nth-child(${l+1})`)).forEach(e=>{e.style[t]=a+"px",i&&(e.style.zIndex=2+r)})}e.selection&&(t?r.push(0):a.push(0),i=1);for(let e=0+i;e<l.length+i;e++){const n=l[e-i];n.freeze&&(!t&&"far"===n.freeze||t&&"far"!==n.freeze?r.push(e):a.push(e))}if(a.length<2&&r.length<2)return;const o=e.$.tableContainer.firstElementChild.querySelectorAll("th"),s=[];for(let e=0;e<o.length;e++)s.push(o[e].offsetWidth);if(t){for(let e=0;e<a.length-1;e++){const t=a[e];let l=0;for(let e=t+1;e<s.length;e++)-1!==a.indexOf(e)&&(l+=s[e]);n("left",t,l,e,!0)}for(let e=1;e<r.length;e++){const t=r[e];let l=0;for(let e=0;e<t;e++)-1!==r.indexOf(e)&&(l+=s[e]);n("right",t,l,e,!1)}}else{for(let e=1;e<a.length;e++){const t=a[e];let l=0;for(let e=0;e<t;e++)-1!==a.indexOf(e)&&(l+=s[e]);n("left",t,l,e,!1)}for(let e=0;e<r.length-1;e++){const t=r[e];let l=0;for(let e=t+1;e<s.length;e++)-1!==r.indexOf(e)&&(l+=s[e]);n("right",t,l,e,!0)}}}_formatCellValue(e,t,l,a){if(void 0===a&&(a=e.data[t.dataField]),t.formatFunction){const r={value:a,row:e&&e.data?e.data.$.id:e,column:t.dataField,cell:l,template:null};if(t.formatFunction(r),a=r.value,null===r.template||"string"!=typeof r.template)return a;const i=r.template;let n="";if(i.startsWith("#")){const e=document.querySelector(i);if(e&&e instanceof HTMLTemplateElement){const t=e.content.cloneNode(!0),l=document.createElement("div");return l.appendChild(t),a=(a=(a=a.toString()).replace(/'/gi,"\\'")).replace(/"/gi,'\\"'),n=l.innerHTML.replace(/{{value}}/gi,a),n.indexOf("{{value=")>=0&&(a?(n=n.substring(0,n.indexOf("{{value="))+a+n.substring(n.indexOf("}")),n=n.replace(/}/gi,""),n=n.replace(/{/gi,"")):(n=n.replace(/{{value=/gi,""),n=n.replace(/}}/gi,""))),n}}return n=i.replace(/{{value}}/gi,a),n}return"date"===t.dataType&&a instanceof Date?a.toLocaleDateString():a}_dataBind(){const e=this;if(e.dataSource)e.dataSource instanceof Smart.DataAdapter==!1&&(Array.isArray(e.dataSource)?e.dataSource=new Smart.DataAdapter({dataSource:e.dataSource}):e.dataSource=new Smart.DataAdapter({dataSource:[]}));else{if(e.dataFields=[],!e.columns||Array.isArray(e.columns)&&0===e.columns.length){e.columns=[];const t=e.querySelectorAll("th");for(let l=0;l<t.length;l++){const a=t[l].innerHTML.trim();let r={label:a,dataField:a,dataType:"string"};e.columns.push(r),e.dataFields.push(a)}}else for(let t=0;t<e.columns.length;t++){const l=e.columns[t];"string"==typeof l?e.dataFields.push(l):"object"==typeof l&&e.dataFields.push(l.dataField+(l.dataType?": "+l.dataType:""))}let t=[];if(!e.rows){const l=e.querySelectorAll("tr");for(let a=0;a<l.length;a++){const r={},i=l[a].querySelectorAll("td");if(i.length>0){for(let t=0;t<e.columns.length;t++){r[e.columns[t].dataField]=i[t].innerHTML.trim()}t.push(r)}}e.dataSource=new Smart.DataAdapter({dataSource:t,dataFields:e.dataFields})}const l=e.$.container.querySelectorAll("table");l.length>1&&l[l.length-1].parentNode.removeChild(l[l.length-1])}e._initColumns(),e._initRows(),e.dataSource.notify((function(t){if(e.dataSource._updating||e._editing)return;const l=t.data;switch(e.rows.canNotify=!1,t.action){case"add":if(l.length)for(let t=0;t<l.length;t++)e._addNewRow(l[t],e.dataSource.length-l.length+t);else e._addNewRow(l,e.dataSource.length-1);break;case"update":if(l.length)for(let a=0;a<l.length;a++){const r=t.index[a];e.rows[r].data=l[a]}break;case"insert":e._addNewRow(l,t.index);for(let t=0;t<e.rows.length;t++){e.rows[t].dataIndex=t}break;case"remove":!function(t){const l=e.rows[e.rows.length-1];delete e.rowById[l.uid],e.rows.splice(t,1)}(t.index);break;case"removeLast":!function(){const t=e.rows[e.rows.length-1];delete e.rowById[t.uid],e.rows.pop()}()}e.rows.canNotify=!0,e._fullRefresh()})),e.refresh(),e.dataSource.virtualDataSource&&(e.paging=!0,e._requestVirtualDataSource("dataBind")),e.$.tableContainer.setAttribute("aria-rowcount",e.dataSource.length)}_requestVirtualDataSource(e){const t=this,l=t.pageSize,a=Math.max(t.pageIndex*l,0),r=Math.min(a+l,t.dataSource.length),i=[],n=[];let o=null;if(t._sortColumns&&(t._sortColumns.forEach((e,t)=>i[e.dataField]={sortOrder:e.direction,sortIndex:t}),i.length=t._sortColumns.length),t._filterInfo.appliedFilters){for(let e in t._filterInfo.appliedFilters)n[e]=t._filterInfo.appliedFilters[e];n.length=Object.keys(t._filterInfo.appliedFilters).length,o="and"}else{const e=t._filterInfo.inputFilters||t._filterInfo.rowFilters;e&&(e.forEach(e=>n[e[0]]=e[1]),n.length=e.length),o=t._filterInfo.inputFilters?"or":"and"}t.$.loadingIndicatorContainer.classList.remove("smart-hidden"),t.setAttribute("loading",""),t.dataSource.onVirtualDataSourceRequested(t._virtualDataSourceRequestedCallback.bind(t),{first:a,last:r,sorting:i,filtering:n,filterOperator:o,grouping:[],action:e})}_virtualDataSourceRequestedCallback(){delete this.dataSource._updating,this.$.loadingIndicatorContainer.classList.add("smart-hidden"),this.removeAttribute("loading"),this._initRows(),this._refreshDataRows()}sortBy(e,t){const l=this.columnByDataField[e];!1!==l.allowSort&&this._sortBy({column:l,columnDataField:e,sortOrder:t,dataFields:this.dataSource.dataFields,columnByDataField:"columnByDataField"})}_sortBy(e){const t=this,l=e.column,a=e.columnDataField,r=e.sortOrder,i=e.dataFields,n=e.columnByDataField,o=[],s=[],d=[],c=function(e){t._addSortIconContainer(e),e.headerCellElement.sortIconContainerElement.classList.remove("desc"),e.headerCellElement.sortIconContainerElement.classList.remove("asc"),e.sortOrder=null},u=function(){if(t._sortColumns&&t._sortColumns.length>0)for(let e=0;e<t._sortColumns.length;e++){const l=t._sortColumns[e],a=t[n][l.dataField];c(a)}t._sortColumns=[]};if(null==l)return void(t._sortColumns&&t._sortColumns.length>0&&(u(),t._sortCallback(o,s,d)));if("none"===t.sortMode||!t.dataSource)return;if(r&&l.sortOrder===r)return;let f=r||"asc";c(l),t._sortColumns||(t._sortColumns=[]);let h="string";for(let e=0;e<i.length;e++){const t=i[e];if(t.name===a){h=t.dataType;break}}let p=!0;for(let e=0;e<t._sortColumns.length;e++){const r=t._sortColumns[e];if(r.dataField===a)if(p=!1,"asc"===r.direction)r.direction="desc",f="desc";else if("desc"===r.direction){t._sortColumns.splice(e,1),c(l),f=null;break}}p&&("one"===t.sortMode&&u(),t._sortColumns.push({dataField:a,direction:f,dataType:h})),t._addSortIconContainer(l),null!==f?(l.headerCellElement.sortIconContainerElement.classList.remove("asc"),l.headerCellElement.sortIconContainerElement.classList.remove("desc"),l.sortOrder=f,"desc"===f?(l.headerCellElement.sortIconContainerElement.classList.add("desc"),l.headerCellElement.setAttribute("aria-sort","descending")):(l.headerCellElement.sortIconContainerElement.classList.add("asc"),l.headerCellElement.setAttribute("aria-sort","ascending"))):(l.headerCellElement.sortIconContainerElement.classList.remove("asc"),l.headerCellElement.sortIconContainerElement.classList.remove("desc"),l.headerCellElement.removeAttribute("aria-sort"));for(let e=0;e<t._sortColumns.length;e++){const l=t._sortColumns[e];o.push(l.dataField),s.push(l.direction),d.push(l.dataType)}t._sortCallback(o,s,d),t.$.fireEvent("sort",{columns:t._sortColumns})}_addSortIconContainer(e){const t=e.headerCellElement;t.sortIconContainerElement||(t.innerHTML+='<span class="sort-by"></span>',t.sortIconContainerElement=e.headerCellElement.lastChild)}_sortCallback(e,t,l){const a=this,r=a.dataSource;r.virtualDataSource||(r._sort(a.dataSource.boundSource,e,t,l),r.refreshHierarchy()),a._fullRefresh("sort")}clearSort(){this.sortBy(null)}_fullRefresh(e){const t=this;if(t.dataSource.virtualDataSource)return t.dataSource._updating=!0,void t._requestVirtualDataSource(e);t._initRows(),t._refreshDataRows()}_pagerChangeHandler(e){(this.isInShadowDOM||this.shadowRoot?e.composedPath()[0]:e.target)===this.$.pager&&(this.pageIndex=e.detail.index,this._fullRefresh("pageIndexChange"),this.$.fireEvent("page",{action:"pageIndexChange"}))}_pagerPageSizeChanged(e){this.pageSize=e.detail.value,this._fullRefresh("pageSizeChange"),this.$.fireEvent("page",{action:"pageSizeChange"})}_filterInputKeyupHandler(){const e=this;clearTimeout(e._filterInputTimeout),e._filterInputTimeout=setTimeout((function(){if(e._filterInfo&&e.$.filterInput.value!==e._filterInfo.query){const t=e.context;e.context=e,e._filterByAll(e.$.filterInput.value),e.context=t}}),500)}_filterByAll(e){const t=this;if(t._filterInfo.query=e,""===e)return void t.clearFilters();const l=[];t._clearRowFilters(),delete t._filterInfo.appliedFilters,t._filterInfo.stringDataFields.forEach(t=>{const a=new Smart.Utilities.FilterGroup,r=a.createFilter("string",e,"CONTAINS");a.addFilter("or",r),l.push([t,a])}),t.dataSource.virtualDataSource||t.dataSource._filter(l,"or"),t._filterInfo.inputFilters=l,t._fullRefresh("filter"),t.$.fireEvent("filter",{action:"add",filters:l})}_setupPagingAndFiltering(){this.$.pager.$.pageSizeSelector.classList.add("underlined"),this.$.pager.$.pageSizeSelector.dropDownAppendTo="body",this._filterInfo={query:""},this._applyFilterTemplate(),this.$.header.classList.toggle("smart-hidden",this.filterRow&&!this.filterTemplate)}_applyFilterTemplate(){const e=this,t=e.filterTemplate;if(e.$.filterTemplateContainer.innerHTML="",!t)return e.$.filterInput.classList.remove("smart-hidden"),e.$.filterTemplateContainer.classList.add("smart-hidden"),void(e.filterTemplate=null);const l=document.getElementById(t);if(l&&l instanceof HTMLTemplateElement){const t=document.importNode(l.content,!0);e.$.filterInput.classList.add("smart-hidden"),e.$.filterTemplateContainer.classList.remove("smart-hidden"),e.$.filterTemplateContainer.appendChild(t)}else e.filterTemplate=null,e.$.filterInput.classList.remove("smart-hidden"),e.$.filterTemplateContainer.classList.add("smart-hidden")}_refreshFilters(){const e=this,t=[];for(let l in e._filterInfo.appliedFilters){let a=e._filterInfo.appliedFilters[l];t.push([l,a])}0!==t.length?(e._clearFilterInput(),e._clearRowFilters(),e.dataSource.virtualDataSource||e.dataSource._filter(t,"or"),e._fullRefresh("filter"),e.$.fireEvent("filter",{action:"add",filters:t})):e.clearFilters()}_localize(){const e=this,t=e.$.pager;t.messages[e.locale]||(t.messages[e.locale]={}),t.messages[e.locale].pageSizeLabel=e.localize("itemsPerPage"),t.messages[e.locale].summaryPrefix=e.localize("summaryPrefix"),t.messages[e.locale].summarySuffix="",t.$.firstButton.setAttribute("tooltip",e.localize("firstButton")),t.$.previousButton.setAttribute("tooltip",e.localize("previousButton")),t.$.nextButton.setAttribute("tooltip",e.localize("nextButton")),t.$.lastButton.setAttribute("tooltip",e.localize("lastButton")),e.$.filterInput.placeholder=e.localize("filterPlaceholder"),e._filterInfo.stringConditions=[{value:"EMPTY",label:e.localize("EMPTY")},{value:"NOT_EMPTY",label:e.localize("NOT_EMPTY")},{value:"CONTAINS",label:e.localize("CONTAINS")},{value:"CONTAINS_CASE_SENSITIVE",label:e.localize("CONTAINS_CASE_SENSITIVE")},{value:"DOES_NOT_CONTAIN",label:e.localize("DOES_NOT_CONTAIN")},{value:"DOES_NOT_CONTAIN_CASE_SENSITIVE",label:e.localize("DOES_NOT_CONTAIN_CASE_SENSITIVE")},{value:"STARTS_WITH",label:e.localize("STARTS_WITH")},{value:"STARTS_WITH_CASE_SENSITIVE",label:e.localize("STARTS_WITH_CASE_SENSITIVE")},{value:"ENDS_WITH",label:e.localize("ENDS_WITH")},{value:"ENDS_WITH_CASE_SENSITIVE",label:e.localize("ENDS_WITH_CASE_SENSITIVE")},{value:"EQUAL",label:e.localize("EQUAL")},{value:"EQUAL_CASE_SENSITIVE",label:e.localize("EQUAL_CASE_SENSITIVE")},{value:"NULL",label:e.localize("NULL")},{value:"NOT_NULL",label:e.localize("NOT_NULL")}],e._filterInfo.numberAndDateConditions=[{value:"EQUAL",label:e.localize("EQUAL")},{value:"NOT_EQUAL",label:e.localize("NOT_EQUAL")},{value:"LESS_THAN",label:e.localize("LESS_THAN")},{value:"LESS_THAN_OR_EQUAL",label:e.localize("LESS_THAN_OR_EQUAL")},{value:"GREATER_THAN",label:e.localize("GREATER_THAN")},{value:"GREATER_THAN_OR_EQUAL",label:e.localize("GREATER_THAN_OR_EQUAL")},{value:"NULL",label:e.localize("NULL")},{value:"NOT_NULL",label:e.localize("NOT_NULL")}]}_createFilterRow(e){const t=this;if(!t.filtering||!t.filterRow)return;if(e)return void t.$.tableContainer.children[1].insertBefore(e,t.$.tableContainer.children[1].firstElementChild);const l=document.createElement("tr"),a=` animation="${t.animation}" `,r=t.rightToLeft?" right-to-left":"";let i="";l.className="smart-table-filter-row",t.selection&&(i+="<td></td>");for(let e=0;e<t._columns.length;e++){const l=t._columns[e],n=[];let o,s,d,c;"string"===l.dataType?(o=t._filterInfo.stringConditions,s="string",d="string-filter",c=t.localize("CONTAINS")):(o=t._filterInfo.numberAndDateConditions,s=l.dataType,d="num-date-filter",c=t.localize("EQUAL")),l.freeze&&n.push("freeze-"+("far"===l.freeze?"far":"near")),l.responsivePriority&&n.push("priority-"+l.responsivePriority),!1===l.allowFilter&&n.push("no-filter"),i+=`<td${n.length?' class="'+n.join(" ")+'"':""} filter-for="${l.dataField}">\n                            <div>\n                                <input type="${s}" class="filter-value" aria-label="Filter value" />\n                                <smart-input class="${d}${a}data-source='${JSON.stringify(o)}' drop-down-button-position="right" drop-down-width="auto" readonly${r} value="${c}" title="${t.localize("filterCondition")}" aria-label="Filter condition"></smart-input>\n                                <smart-button class="smart-hidden" title="${t.localize("clearFilter")}"${a}${r} aria-label="Clear filter"></smart-button>\n                            </div>\n                        </td>`}l.innerHTML=i,t.$.tableContainer.children[1].insertBefore(l,t.$.tableContainer.children[1].firstElementChild)}_tableContainerChangeHandler(e){const t=this,l=t.isInShadowDOM||t.shadowRoot?e.composedPath()[0]:e.target;(l.classList.contains("filter-value")&&"date"===l.type||l instanceof Smart.Input&&(""!==l.previousElementSibling.value||-1!==["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(e.detail.value)))&&t._applyRowFilters()}_tableContainerClickHandler(e){const t=this;if(t._editing)return;const l=t.isInShadowDOM||t.shadowRoot?e.composedPath()[0]:e.target,a=l.closest("tbody tr[row-id]");if(a){if(l.classList.contains("hierarchy-arrow"))return void t._hierarchyArrowClickHandler(a);const e=a.getAttribute("row-id"),r=t.rowById?t.rowById[e].data:t.rows.find(t=>t.$.id===e),i=r.$.id,n=l.closest("td"),o=n?n.getAttribute("data-field"):void 0;if(void 0!==o&&t.$.fireEvent("cellClick",{row:r,dataField:o}),t._toggleSelection(a,i),t.editing){if(!o||n.classList.contains("no-edit"))return;clearTimeout(t._dblclickObject.timeout),t._dblclickObject.numberOfClicks++,2===t._dblclickObject.numberOfClicks?(t._dblclickObject.numberOfClicks=0,t._beginEdit({rowElement:a,cell:n,dataField:o})):t._dblclickObject.timeout=setTimeout((function(){t._dblclickObject.numberOfClicks=0}),300)}return void(t.rowDetailTemplate&&t._toggleRowDetail(a,i))}if(l.parentElement.classList.contains("smart-table-select-all"))return void t._selectAllCheckboxClickHandler(l.parentElement);const r=l.closest(".smart-table-filter-row smart-button");if(r){const e=r.parentElement.firstElementChild,l=r.parentElement.children[1];return e.value="",-1!==["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(l.$.input.dataValue)&&(l.value=t.localize("text"===e.type?"CONTAINS":"EQUAL"),delete l.$.input.dataValue),void t._applyRowFilters()}}_toggleSelection(e,t){const l=this;l.selection&&!e.classList.contains("disable-select")&&(-1===l._selectedIds.indexOf(t)?l.select(t):l.unselect(t))}_selectAllCheckboxClickHandler(e,t){const l=this;void 0===t&&(t=l.dataSource);const a=t.length,r=l._selectedIds.length===a-l._disabledSelection.length;if(l._selectedIds=[],r)e.classList.remove("indeterminate","selected"),Array.from(l.$.tableContainer.querySelectorAll(".smart-table-select-row")).forEach(e=>{e.parentElement.classList.contains("disable-select")||e.parentElement.setAttribute("aria-selected",!1),e.classList.remove("selected")});else{let r=0;for(let e=0;e<a;e++){const a=t[e].$.id;-1===l._disabledSelection.indexOf(a)&&(l._selectedIds.push(a),r++)}r===a?(e.classList.remove("indeterminate"),e.classList.add("selected")):0===r?e.classList.remove("indeterminate","selected"):(e.classList.remove("selected"),e.classList.add("indeterminate")),Array.from(l.$.tableContainer.querySelectorAll(".smart-table-select-row")).forEach(e=>{e.parentElement.classList.contains("disable-select")||(e.parentElement.setAttribute("aria-selected",!0),e.classList.add("selected"))})}}_beginEdit(e){const t=this,l=e.dataField;let a=e.rowId,r=e.rowElement,i=e.rowObject,n=e.cell,o=[],s=[];if(t.editing){r||(r=t.$.tableContainer.querySelector(`tr[row-id="${a}"]`)),i||(a=r.getAttribute("row-id"),i=t.rowById[a],a=i.data.$.id),"row"===t.editMode?(o=r.querySelectorAll("td[data-field]"),s=t._columns.map(e=>e.dataField),n||(n=l?r.querySelector(`td[data-field="${l}"`):o[0])):(n||(n=r.querySelector(`td[data-field="${l}"`)),o=[n],s=[l]),t._editing={row:i,cells:[]};for(let e=0;e<s.length;e++){const l=o[e],r=s[e],d=t._columns.find(e=>e.dataField===r);if(!1===d.allowEdit)continue;const c=i.data[r],u=t._initEditor(d,a,r,c);let f=u instanceof HTMLInputElement&&"date"===u.type;if(d.editor&&d.editor.template)d.editor.onRender&&d.editor.onRender(a,r,u,c);else if(f)if(c instanceof Date&&!isNaN(c.getTime())){const e=(c.getMonth()+1).toString(),t=c.getDate().toString();u.value=`${c.getFullYear()}-${"0".repeat(2-e.length)}${e}-${"0".repeat(2-t.length)}${t}`}else u.value="";else u.value=c;l.classList.add("editing"),l.innerHTML="",l.appendChild(u),l===n&&u.focus&&(u.focus(),d.editor&&d.editor.template||f||!u.select||u.select()),t._editing.cells.push({dataField:r,editor:u,element:l}),t.$.fireEvent("cellBeginEdit",{row:i.data,dataField:r})}}}_initEditor(e,t,l,a){let r=this._editors[l];if(r)return r;if(e.editor&&e.editor.template){const i=document.createElement("div");return i.innerHTML=e.editor.template,r=i.firstElementChild,r.className="smart-table-editor",e.editor.onInit&&e.editor.onInit(t,l,r,a),r}return r=document.createElement("input"),r.className="smart-table-editor standard","number"===e.dataType?r.type="number":"date"===e.dataType?r.type="date":r.type="text",this._editors[l]=r,r}_toggleRowDetail(e,t){const l=this,a=e.nextElementSibling;if("none"===l.animation)return a.classList.toggle("collapsed"),void(a.classList.contains("collapsed")?(a.setAttribute("aria-hidden",!0),l._expandedIds=l._expandedIds.filter(e=>e!==t)):(a.removeAttribute("aria-hidden"),l._expandedIds.push(t)));const r=a.firstElementChild.firstElementChild;if(a.classList.contains("collapsed")){const e=`calc(${a.firstElementChild.scrollHeight}px + 2 * var(--smart-table-cell-padding))`;return a.ontransitionend=function(){a.style.height=null,r.style.height=null,a.removeAttribute("aria-hidden"),a.classList.remove("collapsed"),r.style.paddingTop=null,r.style.paddingBottom=null,a.ontransitionend=null},a.style.height=e,r.style.height=e,r.style.paddingTop="var(--smart-table-cell-padding)",r.style.paddingBottom="var(--smart-table-cell-padding)",void l._expandedIds.push(t)}const i=a.firstElementChild.scrollHeight+"px";r.style.height=i,r.style.paddingTop="var(--smart-table-cell-padding)",r.style.paddingBottom="var(--smart-table-cell-padding)",a.style.height=i,l._expandedIds=l._expandedIds.filter(e=>e!==t),requestAnimationFrame(()=>{a.ontransitionend=function(){a.setAttribute("aria-hidden",!0),a.classList.add("collapsed"),r.style.paddingTop=null,r.style.paddingBottom=null,r.style.height=null,a.style.height=null,a.ontransitionend=null},r.style.paddingTop=0,r.style.paddingBottom=0,r.style.height=0,a.style.height=0})}_setFocusable(){const e=this;if(!e.keyboardNavigation||e.disabled||e.unfocusable)return void e.$.tableContainer.removeAttribute("tabindex");const t=e.$.tableContainer.getAttribute("tabindex");(null===t||t<0)&&e.$.tableContainer.setAttribute("tabindex",0)}_tableContainerFocusHandler(){const e=this;e._focusedCell||e._focusCell(e.$.tableContainer.children[1].querySelector("td[data-field], td.group-header"))}_tableContainerDownHandler(e){const t=this.isInShadowDOM||this.shadowRoot?e.originalEvent.composedPath()[0]:e.originalEvent.target;this._focusCell(t.closest("td[data-field], td.group-header"))}_focusCell(e,t){const l=this;if(!e||!e.hasAttribute("data-field")&&!e.classList.contains("group-header"))return;if(l._focusedCell){if(l._focusedCell===e)return;l._focusedCell.removeAttribute("focus")}if(l._focusedCell=e,e.setAttribute("focus",""),!t)return;const a=l.$.container,r=l.freezeHeader?l.$.tableContainer.firstElementChild.offsetHeight:0,i=a.scrollTop;let n=e.offsetTop-r;if(n<i)a.scrollTop=n;else{const t=l.$.header.offsetHeight,o=l.footerRow&&l.freezeFooter?l.$.tableContainer.lastElementChild.offsetHeight:0,s=l.$.pager.offsetHeight,d=a.clientHeight-(t+r+o+s);n+=e.offsetHeight,n>i+d&&(l.$.container.scrollTop=n-d)}if(e.classList.contains("freeze-near")||e.classList.contains("freeze-far"))return;const o=a.scrollLeft,s=l.$.tableContainer.querySelector("tr[row-id]");let d=e.offsetLeft,c=0;if(Array.from(s.children).forEach(e=>{e.classList.contains("freeze-near")&&(c+=e.offsetWidth)}),d-=c,d<o)a.scrollLeft=d;else{const t=a.clientWidth;d+=e.offsetWidth+c,d>o+t&&(l.$.container.scrollLeft=d-t)}}_tableContainerKeydownHandler(e){const t=this,l=e.key,a=t._focusedCell;if(!a)return;const r=a.classList.contains("group-header");if(r&&-1!==["ArrowRight","ArrowLeft","Home","End"," ","Escape","F2"].indexOf(l))return void e.preventDefault();if(t._editing){switch(l){case"Enter":t.endEdit();break;case"Escape":t.cancelEdit();break;default:return}return t.$.tableContainer.focus(),void e.preventDefault()}const i=a.parentElement;let n="ArrowRight",o="ArrowLeft";switch(t.rightToLeft&&(n="ArrowLeft",o="ArrowRight"),l){case n:t._focusCell(a.nextElementSibling,!0);break;case o:t._focusCell(a.previousElementSibling,!0);break;case"ArrowUp":{let e=i.previousElementSibling;for(;e&&(e.classList.contains("smart-table-row-detail")||e.classList.contains("collapsed"));)e=e.previousElementSibling;e&&(r?t._focusCell(e.querySelector("td[data-field], .group-header"),!0):t._focusCell(e.querySelector(`td[data-field="${a.getAttribute("data-field")}"], .group-header`),!0));break}case"ArrowDown":{let e=i.nextElementSibling;for(;e&&(e.classList.contains("smart-table-row-detail")||e.classList.contains("collapsed"));)e=e.nextElementSibling;e&&(r?t._focusCell(e.querySelector("td[data-field], .group-header"),!0):t._focusCell(e.querySelector(`td[data-field="${a.getAttribute("data-field")}"], .group-header`),!0));break}case"Home":t._focusCell(i.querySelector("td[data-field]"),!0);break;case"End":{const e=i.querySelectorAll("td[data-field]");t._focusCell(e[e.length-1],!0);break}case"PageDown":t._pageDownHandler(a);break;case"PageUp":t._pageUpHandler(a);break;case"Enter":{const e=i.data;t.dataSource.boundHierarchy&&t._areChildrenFiltered(e)?t._hierarchyArrowClickHandler(i):t.rowDetailTemplate&&t._toggleRowDetail(i,e.$.id);break}case" ":t._toggleSelection(i,i.data.$.id);break;case"F2":t.beginEdit(i.data.$.id,a.getAttribute("data-field"));break;default:return}e.preventDefault()}_pageDownHandler(e){const t=this,l=t.paging;if(!l&&e.parentElement===e.parentElement.parentElement.lastElementChild)return;const a=t.$.container;let r=e.getAttribute("data-field");function i(){const e=t.$.tableContainer.querySelectorAll("tr[row-id]");let l=t.$.header.offsetHeight+t.$.pager.offsetHeight;t.footerRow&&t.freezeFooter&&(l+=t.$.tableContainer.lastElementChild.offsetHeight);for(let t=e.length-1;t>=0;t--){const i=e[t];if(!i.classList.contains("collapsed")&&i.offsetTop+i.offsetHeight<=a.scrollTop+a.clientHeight-l)return i.querySelector(`td[data-field${r}], .group-header`)}}r=r?`="${r}"`:"";let n=i();if(n)if(e===n)if(a.scrollTop+=a.clientHeight,n=i(),l&&e===n){const e=t.pageIndex;t.navigateTo(t.pageIndex+1),t.pageIndex!==e&&t._focusCell(t.$.tableContainer.querySelector(`td[data-field${r}], .group-header`),!0)}else t._focusCell(n);else t._focusCell(n)}_pageUpHandler(e){const t=this,l=t.$.container;let a=e.getAttribute("data-field");function r(){const e=t.$.tableContainer.querySelectorAll("tr[row-id]");let r=0;t.freezeHeader&&(r=t.$.tableContainer.firstElementChild.offsetHeight);for(let t=0;t<e.length;t++){const i=e[t];if(!i.classList.contains("collapsed")&&i.offsetTop>=l.scrollTop+r)return i.querySelector(`td[data-field${a}], .group-header`)}}a=a?`="${a}"`:"";let i=r();if(i)if(e===i)if(l.scrollTop-=l.clientHeight,i=r(),t.paging&&e===i){const e=t.pageIndex;if(t.navigateTo(t.pageIndex-1),t.pageIndex!==e){const e=t.$.tableContainer.querySelectorAll(`td[data-field${a}], .group-header`);t._focusCell(e[e.length-1],!0)}}else t._focusCell(i);else t._focusCell(i)}_tableContainerKeyupHandler(e){const t=this,l=t.isInShadowDOM||t.shadowRoot?e.composedPath()[0]:e.target;l.classList.contains("filter-value")&&"date"!==l.type&&(clearTimeout(t._filterRowTimeout),t._filterRowTimeout=setTimeout((function(){const e=t.context;t.context=t,t._applyRowFilters(),t.context=e}),500))}_documentDownHandler(e){const t=this,l=t.isInShadowDOM||t.shadowRoot?e.originalEvent.composedPath()[0]:e.originalEvent.target;if(!t._editing||l.closest(".smart-table-editor")){if(t.columnReorder){const a=l.closest("th[data-field]");a&&t.$.tableContainer.contains(a)&&(t._dragDetails={FeedbackShown:!1,Item:a,StartPosition:{left:e.pageX,top:e.pageY},StartTime:new Date})}}else{const e=l.closest(".smart-drop-down");if(!e)return void t.endEdit();const a=e.ownerElement;if(!a)return void t.endEdit();if(t.$.container.contains(a)&&a.classList.contains("smart-table-editor"))return;t.endEdit()}}_documentMoveHandler(e){const t=this,l=t._dragDetails;if(!l)return;if(!l.FeedbackShown){const a=(new Date).getTime()-l.StartTime.getTime()>500,r=Math.abs(l.StartPosition.left-e.pageX)>5||Math.abs(l.StartPosition.top-e.pageY)>5;if(!r||!(!t._isMobile||t._isMobile&&a))return void(t._isMobile&&r&&!a&&delete t._dragDetails);t._hideBodyOverflow(),l.Feedback=t._addDragFeedback(),l.FeedbackShown=!0,l.Item.classList.add("dragged"),t.classList.add("smart-unselectable")}const a=t.$.container;l.Feedback.style.left=e.pageX+10+"px",l.Feedback.style.top=e.pageY+10+"px",l.HoveredItem&&(l.HoveredItem.classList.remove("drop-target","left","right"),delete l.HoveredItem),a.offsetWidth<a.scrollWidth&&(clearInterval(t._dragInterval),t._dragInterval=setInterval((function(){const l=a.getBoundingClientRect();l.left<=e.clientX&&l.left+l.width>=e.clientX?e.clientX>=l.left&&e.clientX<=l.left+20?a.scrollLeft-=t._autoScrollCoefficient:e.clientX>=l.left+l.width-20&&e.clientX<=l.left+l.width?a.scrollLeft+=t._autoScrollCoefficient:clearInterval(t._dragInterval):clearInterval(t._dragInterval)}),10));const r=t._getClosestThToHover(e);r&&(r.classList.add("drop-target"),l.HoveredItem=r)}_hideBodyOverflow(){const e=(document.scrollingElement||document.documentElement).scrollHeight>document.documentElement.clientHeight,t=(document.scrollingElement||document.documentElement).scrollWidth>document.documentElement.clientWidth;this._originalBodyOverflow={overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY,overflow:document.body.style.overflow},document.body.classList.add("smart-dragging"),document.body.style.overflow=document.body.style.overflowX=document.body.style.overflowY="",e&&!t?document.body.style.overflowX="hidden":t&&!e?document.body.style.overflowY="hidden":t||e||(document.body.style.overflow="hidden")}_addDragFeedback(){const e=this,t=e._dragDetails.Item,l=document.createElement("div");return l.className="smart-table-feedback",l.setAttribute("parent-table-id",e.id),l.innerHTML=e._columns.find(e=>e.dataField===t.getAttribute("data-field")).label,e.theme&&l.setAttribute("theme",e.theme),document.body.appendChild(l),l}_getClosestThToHover(e){const t=e.clientX;let l,a,r;return Array.from(this.$.tableContainer.querySelectorAll("th[data-field]")).forEach(e=>{if(!e||this._dragDetails.Item===e)return;const i=e.getBoundingClientRect(),n=Math.abs(t-i.left),o=Math.abs(t-i.right),s=Math.min(n,o);(void 0===a||s<a)&&(l=e,a=s,r=n<o?"left":"right")}),l&&l.classList.add(r),l}_documentUpHandler(){const e=this._dragDetails;if(!e)return;if(delete this._dragDetails,!e.FeedbackShown)return;const t=e.HoveredItem;if(document.body.classList.remove("smart-dragging"),document.body.style.overflow=this._originalBodyOverflow.overflow,document.body.style.eoverflowX=this._originalBodyOverflow.overflowX,document.body.style.overflowY=this._originalBodyOverflow.overflowY,delete this._originalBodyOverflow,this.classList.remove("smart-unselectable"),e.Item.classList.remove("dragged"),document.body.removeChild(e.Feedback),clearInterval(this._dragInterval),delete this._dragInterval,!t)return;const l=this.rightToLeft,a=this._columns,r=e.Item.getAttribute("data-field"),i=a.find(e=>e.dataField===r),n=t.getAttribute("data-field"),o=t.classList.contains("right");let s=this._columns.filter(e=>e.dataField!==r);const d=s.findIndex(e=>e.dataField===n);t.classList.remove("drop-target","left","right"),d===s.length-1?s.push(i):o&&!l||!o&&l?s.splice(d+1,0,i):s.splice(d,0,i),a.map(e=>e.dataField).join(",")!==s.map(e=>e.dataField).join(",")&&(this.columns=s,this._initColumns(),this.refresh())}_applyRowFilters(){const e=this;if(!e.filtering||!e.filterRow)return;const t=e.$.tableContainer.querySelector(".smart-table-filter-row"),l=e.selection?1:0,a=[];for(let r=0;r<e._columns.length;r++){const i=e._columns[r].dataField,n=e._columns[r].dataType,o=t.children[r+l].firstElementChild,s=o.children[2];let d=o.firstElementChild.value,c=o.children[1].value;"string"===n?c=e._filterInfo.stringConditions.find(e=>e.label===c).value:(c=e._filterInfo.numberAndDateConditions.find(e=>e.label===c).value,""!==d&&("number"===n?(d=parseFloat(d),isNaN(d)&&(o.firstElementChild.value="",d="")):"date"===n&&(d=new Date(d),d.setHours(0,0,0))));const u=-1!==["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(c);if(""!==d||u){const e=new Smart.Utilities.FilterGroup,t=e.createFilter(n,d,c);e.addFilter("or",t),a.push([i,e]),s.classList.remove("smart-hidden")}else s.classList.add("smart-hidden");u?o.firstElementChild.setAttribute("disabled",!0):o.firstElementChild.removeAttribute("disabled")}a.length>0?(e.dataSource.virtualDataSource||e.dataSource._filter(a,"and"),e._filterInfo.rowFilters=a,delete e._filterInfo.appliedFilters,e._fullRefresh("filter"),e.$.fireEvent("filter",{action:"add",filters:a})):e._filterInfo.rowFilters&&e.clearFilters()}_clearFilterInput(){this._filterInfo.query="",delete this._filterInfo.inputFilters,this.$.filterInput.value=""}_clearRowFilters(){const e=this;if(!e._filterInfo.rowFilters)return;const t=e.$.tableContainer.querySelector(".smart-table-filter-row"),l=e.selection?1:0;for(let a=0;a<e._columns.length;a++){const e=t.children[a+l].firstElementChild;e.firstElementChild.value="",e.children[2].classList.add("smart-hidden")}delete e._filterInfo.rowFilters}_createFooterRow(e){const t=this,l=t.footerRow;if(!l)return;if(e)return void t.$.tableContainer.appendChild(e);const a=document.getElementById(l);if(a&&a instanceof HTMLTemplateElement){const e=document.createElement("tfoot"),l=document.importNode(a.content,!0);e.appendChild(l),t.$.tableContainer.appendChild(e)}else t.footerRow=null}_createCustomHeaderRow(){const e=this,t=e.headerRow;if(!t)return;const l=document.getElementById(t);if(l&&l instanceof HTMLTemplateElement){const t=document.importNode(l.content,!0);e.$.tableContainer.firstElementChild.appendChild(t)}else e.headerRow=null}_updateSelectAllState(e){const t=this,l=t._selectedIds.length,a=t.$.tableContainer.querySelector(".smart-table-select-all");void 0===e&&(e=t.dataSource.length),0===l?a.classList.remove("selected","indeterminate"):l===e?(a.classList.remove("indeterminate"),a.classList.add("selected")):(a.classList.remove("selected"),a.classList.add("indeterminate"))}_resizeHandler(){this._handleFrozenColumnPositions()}_hierarchyArrowClickHandler(e){const t="none"!==this.animation,l=this.$.tableContainer,a=e.data;a.expanded?function e(t){t.forEach(t=>{const a=l.querySelector(`tr[row-id="${t.$.id}"]`);a&&(a.setAttribute("aria-hidden",!0),a.classList.add("collapsed")),t.children&&e(t.children)})}(a.children):function e(a){a.forEach(a=>{const r=l.querySelector(`tr[row-id="${a.$.id}"]`);r&&(t&&(r.classList.add("no-height"),r.ontransitionend=function(){r.classList.remove("no-height"),r.ontransitionend=null}),r.removeAttribute("aria-hidden"),r.classList.remove("collapsed")),a.children&&a.expanded&&e(a.children)})}(a.children),a.expanded=!a.expanded,e.setAttribute("aria-expanded",a.expanded),e.classList.toggle("expanded",a.expanded)}_getGroupByIndex(e){"number"==typeof e&&(e=e.toString());const t=this.dataSource.boundHierarchy,l=e.split(".");let a=t[l[0]];if(a){for(let e=1;e<l.length;e++)if(a=a.children[l[e]],!a||a.leaf)return;return a}}})}});
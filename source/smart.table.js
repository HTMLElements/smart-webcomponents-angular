
/* Smart UI v8.0.0 (2020-Aug) 
Copyright (c) 2011-2020 jQWidgets. 
License: https://htmlelements.com/license/ */ //

!function(e){var t={};function a(l){if(t[l])return t[l].exports;var i=t[l]={i:l,l:!1,exports:{}};return e[l].call(i.exports,i,i.exports,a),i.l=!0,i.exports}a.m=e,a.c=t,a.d=function(e,t,l){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:l})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var l=Object.create(null);if(a.r(l),Object.defineProperty(l,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)a.d(l,i,function(t){return e[t]}.bind(null,i));return l},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=100)}({100:function(e,t){Smart("smart-table",class extends Smart.ContentElement{static get properties(){return{autoLoadState:{value:!1,type:"boolean"},autoSaveState:{value:!1,type:"boolean"},columnMinWidth:{value:"50px",type:"any"},columnReorder:{value:!1,type:"boolean"},columns:{value:[],type:"any?",reflectToAttribute:!1},columnSizeMode:{value:"default",allowedValues:["auto","default"],type:"string"},conditionalFormatting:{value:null,type:"array?",reflectToAttribute:!1},conditionalFormattingButton:{value:!1,type:"boolean"},dataSource:{value:null,type:"any?",reflectToAttribute:!1},dataTransform:{value:null,type:"function?",reflectToAttribute:!1},editing:{value:!1,type:"boolean"},editMode:{value:"cell",allowedValues:["cell","row"],type:"string"},filtering:{value:!1,type:"boolean"},filterRow:{value:!1,type:"boolean"},filterTemplate:{value:null,type:"string?"},footerRow:{value:null,type:"string?"},freezeFooter:{value:!1,type:"boolean"},freezeHeader:{value:!1,type:"boolean"},grouping:{value:!1,type:"boolean"},headerRow:{value:null,type:"string?"},keyboardNavigation:{value:!1,type:"boolean"},messages:{value:{en:{add:"Add condition",all:"All columns",apply:"Apply",between:"Between",cancel:"Cancel",clearFilter:"Clear filter",close:"Close",column:"Column:",condition:"Condition:",conditionalFormatting:"Conditional Formatting",CONTAINS:"contains",CONTAINS_CASE_SENSITIVE:"contains (case sensitive)",DOES_NOT_CONTAIN:"does not contain",DOES_NOT_CONTAIN_CASE_SENSITIVE:"does not contain (case sensitive)",EMPTY:"empty",ENDS_WITH:"ends with",ENDS_WITH_CASE_SENSITIVE:"ends with (case sensitive)",EQUAL:"equal",equal:"Equal To",EQUAL_CASE_SENSITIVE:"equal (case sensitive)",filterCondition:"Filter condition",filterPlaceholder:"Filter",firstButton:"First",fontFamily:"Font family:",fontSize:"Font size:",format:"Format:",formatColumn:"Format Column",GREATER_THAN:"greater than",GREATER_THAN_OR_EQUAL:"greater than or equal",greaterThan:"Greater Than",highlight:"Highlight",invalidValue:"Invalid value",itemsPerPage:"Items per page:",lastButton:"Last",LESS_THAN:"less than",LESS_THAN_OR_EQUAL:"less than or equal",lessThan:"Less Than",nextButton:"Next",NOT_EMPTY:"not empty",NOT_EQUAL:"not equal",NOT_NULL:"not null",notEqual:"Not Equal To",NULL:"null",ok:"OK",previousButton:"Previous",remove:"Remove condition",secondValue:"Second value:",STARTS_WITH:"starts with",STARTS_WITH_CASE_SENSITIVE:"starts with (case sensitive)",summaryPrefix:"of",text:"Text",value:"Value:",with:"with"}},type:"object",extend:!0},onCellRender:{value:null,type:"function?",reflectToAttribute:!1},onColumnRender:{value:null,type:"function?",reflectToAttribute:!1},onInit:{value:null,type:"function?",reflectToAttribute:!1},pageSize:{value:10,allowedValues:[10,25,50],type:"int"},pageIndex:{value:0,type:"int"},paging:{value:!1,type:"boolean"},rowDetailTemplate:{value:null,type:"string?"},selection:{value:!1,type:"boolean"},selectionMode:{value:"many",type:"string",allowedValues:["many","extended"]},sort:{value:null,type:"function?",reflectToAttribute:!1},sortMode:{value:"none",type:"string",allowedValues:["none","one","many"]},stateSettings:{value:["columns","expanded","filtered","grouped","selected","sorted"],type:"array"},tooltip:{value:!1,type:"boolean"}}}static get listeners(){return{resize:"_resizeHandler","conditionalFormattingButton.click":"_conditionalFormattingButtonClickHandler","filterInput.keyup":"_filterInputKeyupHandler","pager.change":"_pagerChangeHandler","pager.pageSizeChanged":"_pagerPageSizeChanged","tableContainer.change":"_tableContainerChangeHandler","tableContainer.click":"_tableContainerClickHandler","tableContainer.down":"_tableContainerDownHandler","tableContainer.focus":"_tableContainerFocusHandler","tableContainer.keydown":"_tableContainerKeydownHandler","tableContainer.keyup":"_tableContainerKeyupHandler","tableContainer.pointerover":"_tableContainerPointeroverHandler","document.down":"_documentDownHandler","document.move":"_documentMoveHandler","document.up":"_documentUpHandler"}}template(){return'<div id="container" class="smart-container" role="presentation">\n                    <div id="header" class="smart-table-header" role="toolbar">\n                        <smart-input id="filterInput" class="underlined" animation="[[animation]]" locale="[[locale]]" right-to-left="[[rightToLeft]]" theme="[[theme]]"></smart-input>\n                        <div id="filterTemplateContainer" class="smart-table-filter-template-container smart-hidden"></div>\n                        <smart-button id="conditionalFormattingButton" class="smart-table-toolbar-button conditional-formatting" animation="[[animation]]" right-to-left="[[rightToLeft]]" theme="[[theme]]" aria-label="Conditional Formatting"></smart-button>\n                    </div>\n                    <table id="tableContainer" inner-h-t-m-l=\'[[innerHTML]]\' class="smart-table-container">\n                        <content></content>\n                    </table>\n                    <smart-pager id="pager" animation="[[animation]]" locale="[[locale]]" page-index="[[pageIndex]]" page-size="[[pageSize]]" pages-count="null" show-first-last-navigation-buttons show-page-size-selector show-prev-next-navigation-buttons show-summary right-to-left="[[rightToLeft]]" theme="[[theme]]"></smart-pager>\n                    <div id="loadingIndicatorContainer" class="smart-loader-container smart-hidden" aria-label="Loading">\n                        <span id="loadingIndicator" class="smart-loader" role="presentation"></span>\n                    </div>\n                </div>'}render(){const e=this,t=getComputedStyle(e);e.setAttribute("role","presentation"),e.$.tableContainer.id=e.id+"TableContainer",e._defaults={fontFamily:t.fontFamily,fontSize:t.fontSize,text:e._toHex(t.color),highlight:e._toHex(t.backgroundColor)},e._isMobile=Smart.Utilities.Core.isMobile,e._autoScrollCoefficient=Smart.Utilities.Core.Browser.Firefox?8:Smart.Utilities.Core.Browser.Edge?16:4,e._dblclickObject={numberOfClicks:0},e._expandedIds=[],e._selectedIds=[],e._disabledSelection=[],e._state={expanded:[],selected:[],sorted:[]},e._setFocusable(),e.selection&&e.$.tableContainer.setAttribute("aria-multiselectable",!0),e._createElement(),super.render()}attached(){const e=this;super.attached(),e.isCompleted&&e._dialog&&(e._addDialogHandlers(),e.getShadowRootOrBody().appendChild(e._dialog))}detached(){const e=this;if(super.detached(),e._focusedCell&&!e.$.tableContainer.contains(e._focusedCell)&&delete e._focusedCell,!e._dialog)return;const t=e._dialog;t.removeEventListener("change",e._dialogEventHandler),t.removeEventListener("clear",e._dialogEventHandler),t.removeEventListener("click",e._dialogEventHandler),t.removeEventListener("close",e._dialogEventHandler),t.removeEventListener("filter",e._dialogEventHandler),t.remove()}addFilter(e,t){const a=this,l=a.columnByDataField[e];l&&!1!==l.allowFilter&&t instanceof Smart.Utilities.FilterGroup!=!1&&(e=l.dataField,a._designerFiltersApplied&&a._clearDesignerFilters(),a._filterInfo.appliedFilters||(a._filterInfo.appliedFilters={}),a._filterInfo.appliedFilters[e]=t,a._refreshFilters("add"))}addGroup(e){if(!this.grouping)return;const t=this.columnByDataField[e];if(!t||!1===t.allowGroup)return;const a=this.dataSource,l=a.groupBy;e=t.dataField,-1===l.indexOf(e)&&(l.push(e),a.refreshHierarchy(),this._fullRefresh(),this._updateState("grouped"),this.$.fireEvent("group",{action:"add",dataField:e}))}beginEdit(e,t){const a=this;if(!a.editing)return;const l=a.columnByDataField[t];if(t=l?l.dataField:void 0,"cell"===a.editMode&&!t||l&&!1===l.allowEdit)return;const i=a.rowById[e];if(!i)return;const n=i.data.$.id;a._editing&&a.endEdit(),a._beginEdit({rowId:n,rowObject:i,dataField:t})}cancelEdit(){const e=this,t=e._editing;if(t){for(let a=0;a<t.cells.length;a++){const l=t.cells[a];l.editor.contains(e.getRootNode().activeElement)&&e._focusCell(l.element),l.editor.remove(),e._setCellContent(l.element,e._formatCellValue(t.row,e.columnByDataField[l.dataField],l.element)),l.element.classList.remove("editing")}delete e._editing}}clearFilters(){const e=this,t=e._filterInfo;(t.inputFilters||t.rowFilters||t.appliedFilters)&&(e._clearFilterInput(),e._clearRowFilters(),delete e._filterInfo.appliedFilters,e.dataSource.virtualDataSource||e.dataSource.clearFilter(),e._fullRefresh("filter"),e._updateState("filtered"),e.$.fireEvent("filter",{action:"remove"}))}clearGrouping(){const e=this.dataSource;0!==e.groupBy.length&&(e.groupBy=[],e.refreshHierarchy(),this._fullRefresh(),this._updateState("grouped"),this.$.fireEvent("group",{action:"remove"}))}clearSelection(){if(0===this._selectedIds.length)return;const e=this.$.tableContainer.querySelector(".smart-table-select-all");Array.from(this.$.tableContainer.querySelectorAll(".smart-table-select-row")).forEach(e=>{e.parentElement.setAttribute("aria-selected",!1),e.classList.remove("selected"),e.firstElementChild.setAttribute("aria-checked",!1)}),e&&(e.classList.remove("indeterminate","selected"),e.firstElementChild.setAttribute("aria-checked",!1)),this._selectedIds=[],this._updateState("selected"),this.$.fireEvent("change")}collapseAllRows(){const e=this;e._isExpandCollapseForbidden()||function t(a){for(let l=0;l<a.length;l++){const i=a[l];i.leaf||(i.children&&t(i.children),i.expanded&&e.collapseRow(i.$.id))}}(e["smart-table"===e.nodeName.toLowerCase()?"dataSource":"rows"].boundHierarchy)}collapseGroup(e){if(!this.grouping||0===this.dataSource.groupBy.length)return;const t=this._getGroupByIndex(e);if(!t||!t.expanded)return;const a=this.$.tableContainer.querySelector(`tr[row-id="${t.$.id}"]`);if(this.$.fireEvent("group",{action:"collapse",dataField:t.groupDataField,label:t.label}),a)return this._isCollapsed(t)?(a.setAttribute("aria-expanded",!1),a.classList.remove("expanded"),void(t.expanded=!1)):void this._hierarchyArrowClickHandler(a);t.expanded=!1}collapseRow(e){const t=this;if(t._isExpandCollapseForbidden())return;const a=t.rowById?t.rowById[e]:t.rows.dataItemById[e],l=a.data||a;if(!a||l.leaf||!l.expanded)return;const i=t.$.tableContainer.querySelector(`tr[row-id="${e}"]`);return i?t._isCollapsed(l)?(i.setAttribute("aria-expanded",!1),i.classList.remove("expanded"),l.expanded=!1,t._expandedIds=t._expandedIds.filter(e=>e!==l.$.id),void t._updateState("expanded")):void t._hierarchyArrowClickHandler(i):(l.expanded=!1,t._expandedIds=t._expandedIds.filter(e=>e!==l.$.id),void t._updateState("expanded"))}endEdit(){const e=this,t=e._editing;if(!t)return;const a=t.row,l=a.data,i=[];let n=!0;for(let a=0;a<t.cells.length;a++){const l=t.cells[a],r=e.columnByDataField[l.dataField],o=l.element,s=l.editor;let d;if(r.editor&&r.editor.template?r.editor.getValue&&(d=r.editor.getValue(s)):(d=s.value,s instanceof HTMLInputElement&&("number"===s.type?d=parseFloat(d):"date"===s.type&&(d=new Date(d),isNaN(d.getTime())&&(d=null)))),r.validation){const t=r.validation(d),a=void 0!==t&&!0!==t;if(a){let a;a="object"==typeof t&&t.message?t.message:e.localize("invalidValue"),o.setAttribute("validation-message",a)}else o.removeAttribute("validation-message");o.classList.toggle("invalid",a),n=n&&!a}i.push({column:r,newValue:d})}if(n){for(let n=0;n<t.cells.length;n++){const r=t.cells[n],o=i[n],s=o.column,d=r.editor;d.contains(e.getRootNode().activeElement)&&e._focusCell(r.element),d.remove(),l[r.dataField]=o.newValue,s.transform&&(l[s.dataField]=s.transform(o.newValue)),e._setCellContent(r.element,e._formatCellValue(a,s,r.element)),r.element.classList.remove("editing"),e.$.fireEvent("cellEndEdit",{row:l,dataField:r.dataField})}delete e._editing}}expandAllRows(){const e=this;e._isExpandCollapseForbidden()||function t(a){for(let l=0;l<a.length;l++){const i=a[l];i.leaf||(i.children&&t(i.children),i.expanded||e.expandRow(i.$.id))}}(e["smart-table"===e.nodeName.toLowerCase()?"dataSource":"rows"].boundHierarchy)}expandGroup(e){const t=this,a=t.dataSource;if(!t.grouping||0===a.groupBy.length)return;const l=t._getGroupByIndex(e);if(!l)return;const i=t.$.tableContainer.querySelector(`tr[row-id="${l.$.id}"]`);if(l.expanded||t.$.fireEvent("group",{action:"expand",dataField:l.groupDataField,label:l.label}),i){if(t._isCollapsed(l)){let e=l.parent;e&&!e.expanded&&t.expandGroup(l.parent.$.id.replace("Item","").replace(/_/g,"."))}l.expanded||t._hierarchyArrowClickHandler(i)}else l.expanded=!0}expandRow(e){const t=this;if(t._isExpandCollapseForbidden())return;const a=t.rowById?t.rowById[e]:t.rows.dataItemById[e],l=a.data||a;if(!a||l.leaf)return;const i=t.$.tableContainer.querySelector(`tr[row-id="${e}"]`);if(!i)return l.expanded=!0,-1===t._expandedIds.indexOf(l.$.id)&&t._expandedIds.push(l.$.id),void t._updateState("expanded");if(t._isCollapsed(l)){let e=l.parent;e&&!e.expanded&&t.expandRow(e.$.id)}l.expanded||t._hierarchyArrowClickHandler(i)}exportData(e,t,a,l){const i=this,n=i.dataSource,r=getComputedStyle(i),o=r.borderRightColor,s=new Smart.Utilities.DataExporter(void 0,n.groupBy.toArray()),d={},c=i.$.tableContainer.firstElementChild.querySelectorAll("th");let u;if(n.virtualDataSource){u=[];for(let e=0;e<i.rows.length;e++)u.push(i.rows[e].data)}else n.boundHierarchy&&!i.grouping?(s.hierarchical=!0,u=function e(t){const l=[];return t.forEach(t=>{a&&!1===t.$.filtered||(l.push(t),t.leaf||(t._expanded=t.expanded,t.children&&(t.children=e(t.children),0===t.children.length&&(t._expanded=void 0,t.children=void 0,t.leaf=!0))))}),l}(JSON.parse(JSON.stringify(n.boundHierarchy,(e,t)=>{if("parent"!==e)return t})))):(u=Array.from(n.toArray()),a&&(u=u.filter(e=>!1!==e.$.filtered)));s.style={border:"1px solid "+o,borderCollapse:"collapse",backgroundColor:r.backgroundColor,color:r.color,fontFamily:"Helvetica",header:{border:"1px solid "+o,fontWeight:"bold"},columns:{border:"1px solid "+o}};for(let e=0;e<i._columns.length;e++){const t=i._columns[e],a={},l={};let n=c[e].offsetWidth+"px";d[t.dataField]=t.label,"date"===t.dataType&&(l.format="d"),a.width=n,s.style.header[t.dataField]=a,s.style.columns[t.dataField]=l}return u.unshift(d),s.exportData(u,e,t,l)}getSelection(){return this._selectedIds}getState(){return JSON.parse(this._stringifyState())}getValue(e,t){const a=this.columnByDataField[t];if(!a)return;const l=this.rowById[e];return l?l.data[a.dataField]:void 0}loadState(e){const t=this;if(!e&&!(e=window.localStorage.getItem("smartTable"+t.id)))return;const a=t.stateSettings;let l=!1;if(t._loadingState=!0,"string"==typeof e&&(e=JSON.parse(e)),-1!==a.indexOf("columns")){const a=t._columns,i=[],n=e.columns;for(let e=0;e<n.length;e++){let t=Object.assign({},n[e]);const l=a.find(e=>e.dataField===t.dataField);if(!l)continue;const r=l.label;for(let e in l)-1===["editor","formatFunction","label","transform","validation"].indexOf(e)&&delete l[e];t=Object.assign(l,t),r&&(t.label=r),i.push(t)}for(let e=0;e<a.length;e++){const t=a[e];i.find(e=>e.dataField===t.dataField)||i.push(t)}t.columns=i,t._initColumns(!0),l=!0,t._formattingPanel&&(t._formattingPanel.columns=t._columns)}if(t.grouping){const a=t.dataSource,i=t.dataSource.groupBy;JSON.stringify(i._array)!==JSON.stringify(e.grouped)&&(t.dataSource.groupBy=e.grouped,a.refreshHierarchy(),l=!0)}else t.hasAttribute("hierarchy")&&-1!==a.indexOf("expanded")&&JSON.stringify(t._expandedIds.slice(0).sort())!==JSON.stringify(e.expanded.slice(0).sort())&&(t.collapseAllRows(),t._expandedIds=e.expanded,l=!0);-1!==a.indexOf("selected")&&JSON.stringify(t._selectedIds.slice(0).sort())!==JSON.stringify(e.selected.slice(0).sort())&&(t._selectedIds=e.selected,l=!0),l&&(t._initRows(),t.refresh());e:if(-1!==a.indexOf("filtered")){const a=t.filtering,l=e.filtered;if(t.clearFilters(),!l)break e;if(a&&t.filterRow&&l.rowFilters){const a=t.$.tableContainer.querySelector(".smart-table-filter-row"),l=Number(t.selection),i=e.filtered.filterRowValues;for(let e=0;e<t._columns.length;e++){const n=i[e];if(!n)continue;const r=t._columns[e].dataType,o=a.children[e+l].firstElementChild,s=t._filterInfo["string"===r?"stringConditions":"numberAndDateConditions"].find(e=>e.value===n.condition);if(-1===["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(s.value))if("date"===r){const e=new Date(n.value),t=(e.getMonth()+1).toString(),a=e.getDate().toString();o.children[0].value=`${e.getFullYear()}-${"0".repeat(2-t.length)}${t}-${"0".repeat(2-a.length)}${a}`}else o.children[0].value=n.value;o.children[1].value=s.label,o.children[1].$.input.dataValue=s.value}t._applyRowFilters()}else if(a&&l.inputFilters)t.$.filterInput.value=l.query,t._filterByAll(l.query);else if(l.appliedFilters){t._filterInfo.appliedFilters||(t._filterInfo.appliedFilters={});for(let e in l.appliedFilters){const a=l.appliedFilters[e],i=new window.Smart.Utilities.FilterGroup;a.filters.forEach((e,t)=>{const l=i.createFilter(e.type.replace("Filter",""),e.value,e.condition);i.addFilter(a.logicalOperators[t],l)}),t._filterInfo.appliedFilters[e]=i}t._refreshFilters("add")}}-1!==a.indexOf("sorted")&&(t.clearSort(),e.sorted.forEach(e=>{t.sortBy(e.dataField,e.direction)})),a.forEach(e=>t._updateState(e,!1)),t.autoSaveState&&window.localStorage.setItem("smartTable"+t.id,t._stringifyState()),delete t._loadingState}navigateTo(e){const t=this;if(isNaN(e)||null===e)return;const a=t.pageIndex;t.pageIndex=Math.max(Math.min(Math.round(e),t.$.pager.pagesCount-1),0),t.paging&&t.pageIndex!==a&&(t._fullRefresh("pageIndexChange"),t.$.fireEvent("page",{action:"pageIndexChange"}))}removeFilter(e){const t=this,a=t.columnByDataField[e];t._filterInfo.appliedFilters&&a&&(e=a.dataField,t._designerFiltersApplied&&t._clearDesignerFilters(e),delete t._filterInfo.appliedFilters[e],t._refreshFilters("remove"))}removeGroup(e){const t=this.columnByDataField[e];if(!this.grouping||!t)return;e=t.dataField;const a=this.dataSource,l=a.groupBy,i=l.indexOf(e);-1!==i&&(l.splice(i,1),a.refreshHierarchy(),this._fullRefresh(),this._updateState("grouped"),this.$.fireEvent("group",{action:"remove",dataField:e}))}saveState(){const e=this._stringifyState();return window.localStorage.setItem("smartTable"+this.id,e),JSON.parse(e)}select(e){if(!this.selection)return;const t=this.rowById?this.rowById[e]:this.rows.dataItemById[e];if(!t)return;const a=t.data?t.data.$.id:t.$.id;if(-1!==this._selectedIds.indexOf(a)||-1!==this._disabledSelection.indexOf(a))return;const l=this.$.tableContainer.querySelector(`tr[row-id="${a}"`);this._selectedIds.push(a),l&&(l.firstElementChild.classList.add("selected"),l.firstElementChild.firstElementChild.setAttribute("aria-checked",!0),l.setAttribute("aria-selected",!0)),this._updateSelectAllState(),this._updateState("selected"),this.$.fireEvent("change")}setValue(e,t,a){const l=this.columnByDataField[t];if(!l)return;const i=this.rowById[e];if(!i)return;t=l.dataField;const n=this.$.tableContainer.querySelector(`tr[row-id="${e}"] td[data-field="${t}"]`);this.dataSource._updating=!0,l.transform?(i.data[l.originalDataField]=a,i.data[t]=l.transform(a)):i.data[t]=a,this._setCellContent(n,this._formatCellValue(i,l,n),n.classList.contains("tree-cell")),delete this.dataSource._updating}unselect(e){if(!this.selection)return;const t=this.rowById?this.rowById[e]:this.rows.dataItemById[e];if(!t)return;const a=t.data?t.data.$.id:t.$.id,l=this._selectedIds.indexOf(a);if(-1===l)return;const i=this.$.tableContainer.querySelector(`tr[row-id="${a}"`);this._selectedIds.splice(l,1),i&&(i.firstElementChild.classList.remove("selected"),i.firstElementChild.firstElementChild.setAttribute("aria-checked",!1),i.setAttribute("aria-selected",!1)),this._updateSelectAllState(),this._updateState("selected"),this.$.fireEvent("change")}propertyChangedHandler(e,t,a){super.propertyChangedHandler(e,t,a);const l=this;function i(e,t){const a=[];l._dialog&&a.push(l._dialog,l._dialog.$.footer.firstElementChild,l._dialog.$.footer.children[1]),l._formattingPanel&&a.push(l._formattingPanel),a.forEach(a=>a[e]=t)}switch(e){case"animation":case"theme":if("theme"===e){const e=getComputedStyle(l);l._defaults.text=l._toHex(e.color),l._defaults.highlight=l._toHex(e.backgroundColor)}if(l.filterRow){const t=l.$.tableContainer.querySelector(".smart-table-filter-row");Array.from(t.querySelectorAll("smart-input, smart-button")).forEach(t=>t[e]=a)}i(e,a);break;case"autoSaveState":a&&window.localStorage.setItem("smartTable"+l.id,l._stringifyState());break;case"columnMinWidth":isNaN(parseFloat(a))&&(l.columnMinWidth=t),"auto"===l.columnSizeMode&&l._handleAutoSizeMode();break;case"columns":l._conditionalFormatting&&delete l._conditionalFormatting,l._clearFilterInput(),l._clearRowFilters(),delete l._filterInfo.appliedFilters,l._sortColumns=[],l._initColumns(!0),l.refresh(),l._formattingPanel&&(l._formattingPanel.columns=l._columns);break;case"columnSizeMode":"auto"===a?l._handleAutoSizeMode():l._columns.forEach(e=>e.headerCellElement.style.width=e.width||null);break;case"conditionalFormatting":l._applyInitialConditionalFormatting(l.dataSource),l._refreshDataRows();break;case"conditionalFormattingButton":!a&&l._dialog&&l._dialog.close();break;case"dataSource":{const e=l._sortColumns,t=l._filterInfo;l._dataBind(!0),t.inputFilters?l._filterByAll(t.query):t.rowFilters?l._applyRowFilters():t.appliedFilters&&l._refreshFilters(),e&&(l._sortColumns=[],e.forEach(e=>{l.columnByDataField[e.dataField].sortOrder=null,l.sortBy(e.dataField,e.direction)}));break}case"disabled":case"unfocusable":case"keyboardNavigation":l._setFocusable(),i("unfocusable",l.disabled||l.unfocusable||!l.keyboardNavigation),"disabled"===e&&l._dialog&&l._dialog.close();break;case"editing":a?l.$.tableContainer.removeAttribute("aria-readonly"):l.$.tableContainer.setAttribute("aria-readonly",!0);break;case"filtering":a&&l.filterRow?l._createFilterRow():!1===a&&(l.filterRow&&l.$.tableContainer.querySelector(".smart-table-filter-row").remove(),(l._filterInfo.query||l._filterInfo.rowFilters||l._filterInfo.appliedFilters)&&l.clearFilters());break;case"filterRow":if(l.$.header.classList.toggle("smart-hidden",a&&!l.filterTemplate),!l.filtering)return;a?l._createFilterRow():(l.$.tableContainer.querySelector(".smart-table-filter-row").remove(),l._filterInfo.rowFilters&&l.clearFilters());break;case"filterTemplate":l._applyFilterTemplate(),l.$.header.classList.toggle("smart-hidden",l.filterRow&&!l.filterTemplate);break;case"footerRow":{const e=l.$.tableContainer.querySelector("tfoot");e&&e.remove(),a&&l._createFooterRow();break}case"grouping":a||l.clearGrouping();break;case"headerRow":{const e=Array.from(l.$.tableContainer.firstElementChild.children);for(let t=1;t<e.length;t++)e[t].remove();a&&l._createCustomHeaderRow();break}case"locale":case"messages":{const e=l._dialog;if(l._localize(),l.filterRow){const e=l.$.tableContainer.querySelector(".smart-table-filter-row"),t=Array.from(e.querySelectorAll("smart-input.string-filter")),a=Array.from(e.querySelectorAll("smart-input.num-date-filter")),i=Array.from(e.querySelectorAll("smart-button"));t.concat(a).forEach(e=>e.title=l.localize("filterCondition")),t.forEach(e=>{e.dataSource=l._filterInfo.stringConditions,void 0===e.$.input.dataValue?e.value=l.localize("CONTAINS"):e.value=l._filterInfo.stringConditions.find(t=>t.value===e.$.input.dataValue).label}),a.forEach(e=>{e.dataSource=l._filterInfo.numberAndDateConditions,void 0===e.$.input.dataValue?e.value=l.localize("EQUAL"):e.value=l._filterInfo.numberAndDateConditions.find(t=>t.value===e.$.input.dataValue).label}),i.forEach(e=>e.title=l.localize("clearFilter"))}e&&(e.$.footer.firstElementChild.innerHTML=l.localize("ok"),e.$.footer.children[1].innerHTML=l.localize("cancel"),e.classList.contains("conditional-formatting")?e.label=l.localize("conditionalFormatting"):e.classList.contains("drill-down")&&(e.label=l.localize("details"))),l._formattingPanel&&(l._formattingPanel.messages=l.messages,l._formattingPanel.locale=l.locale);break}case"pageIndex":l.pageIndex=Math.max(Math.min(Math.round(a),l.$.pager.pagesCount-1),0),l.paging&&l.pageIndex!==t&&(l._fullRefresh("pageIndexChange"),l.$.fireEvent("page",{action:"pageIndexChange"}));break;case"pageSize":l.paging&&(l._fullRefresh("pageSizeChange"),l.$.fireEvent("page",{action:"pageSizeChange"}));break;case"paging":if(!1===a){if(l.dataSource.virtualDataSource)return void(l.paging=!0);if(1===l.$.pager.pagesCount)return}l._fullRefresh();break;case"rightToLeft":Array.from(l.$.tableContainer.querySelectorAll(".freeze-near, .freeze-far")).forEach(e=>{e.style.left=null,e.style.right=null,e.style.zIndex=null}),l._handleFrozenColumnPositions(),i("rightToLeft",a);break;case"selection":if(l.filterRow){const e=l.$.tableContainer.querySelector(".smart-table-filter-row");a?e.insertBefore(document.createElement("td"),e.firstElementChild):e.firstElementChild.remove()}l.refresh(),a?(l.$.tableContainer.setAttribute("aria-multiselectable",!0),l._updateSelectAllState()):l.$.tableContainer.removeAttribute("aria-multiselectable");break;case"selectionMode":l.$.tableContainer.classList.remove("smart-unselectable");break;case"sortMode":"none"===a&&l.clearSort();break;case"tooltip":if(!a){const e=l.$.tableContainer.querySelector(".tooltip");e&&(e.classList.remove("tooltip"),e.removeAttribute("title"))}}}_createElement(){const e=this;e._expandedRowDetailIds=[],e._editors={},isNaN(parseFloat(e.columnMinWidth))&&(e.columnMinWidth="50px"),e._setupPagingAndFiltering(),e._localize(),e._dataBind(),e.editing||e.$.tableContainer.setAttribute("aria-readonly",!0),e.autoLoadState&&e.loadState(),e.autoSaveState&&window.localStorage.setItem("smartTable"+e.id,e._stringifyState())}_initColumns(e){const t=this,a=t.columns;!t.isRendered&&t.dataSource.length>0&&(!a||Array.isArray(a)&&0===a.length)&&(t.columns=t.dataSource.dataFields.map(e=>({label:e.name,dataField:e.name,dataType:e.dataType}))),t._filterInfo.stringDataFields=[],t._columns=[],t.columnByDataField={};for(let a=0;a<t.columns.length;a++){let l=t.columns[a];if("string"==typeof l&&t.dataSource.dataFields){const e=t.dataSource.dataFields.find(e=>{if(e.name===l)return e});l={label:l,dataField:l,dataType:e&&e.dataType||"string"}}void 0===l.label&&void 0===l.dataField||(void 0===l.label&&(l.label=l.dataField),void 0===l.dataField&&(l.dataField=l.label),l.dataType||(l.dataType="string"),"string"!==l.dataType&&"number"!==l.dataType||!1===l.allowFilter||t._filterInfo.stringDataFields.push(l.dataField),t._transformColumnDataField(l,e),t._columns.push(l),t.columnByDataField[l.dataField]=l)}t.columns=new Smart.ObservableArray(t._columns),t._updateState("columns"),t.columns.notify((function(e){if(!t.columns.canNotify)return;if("length"===e.action||"update"===e.action&&-1!==["allowGroup","allowSort","sortOrder"].indexOf(e.propertyName))return void t._updateState("columns");const a=e.target;if("update"===e.action){const l=a.dataField;if("allowEdit"===e.propertyName)return Array.from(t.$.tableContainer.querySelectorAll(`td[data-field="${l}"]`)).forEach(t=>{t.classList.toggle("no-edit",!1===e.newValue),!1===e.newValue?t.setAttribute("aria-readonly",!0):t.removeAttribute("aria-readonly")}),void t._updateState("columns");if("allowFilter"===e.propertyName)return"string"!==a.dataType&&"number"!==a.dataType||(!1===e.newValue?t._filterInfo.stringDataFields=t._filterInfo.stringDataFields.filter(e=>e!==l):!1===e.oldValue&&t._filterInfo.stringDataFields.push(l)),t.filterRow&&t.$.tableContainer.querySelector(`.smart-table-filter-row td[filter-for="${l}"]`).classList.toggle("no-filter",!1===e.newValue),"smart-pivot-table"===t.nodeName.toLowerCase()&&t._columnNotify(e),void t._updateState("columns");if("transform"===e.propertyName)a.sortOrder&&t.sortBy(a.dataField,null),t._transformColumnDataField(a,!0);else if(-1!==["allowPivot","allowRowGroup","pivot","rowGroup","summary"].indexOf(e.propertyName)&&"smart-pivot-table"===t.nodeName.toLowerCase())return t._columnNotify(e),void t._updateState("columns")}t._columns=t.columns._array,t.columnByDataField=[],t._columns.forEach(e=>{t.columnByDataField[e.dataField]=e,e.originalDataField&&(t.columnByDataField[e.originalDataField]=e)}),t.refresh(!0),t._updateState("columns")})),t.$.tableContainer.setAttribute("aria-colcount",t._columns.length+ +t.selection)}_transformColumnDataField(e,t){const a=this;if("function"==typeof e.transform){if(!a.isRendered||t){const l=a.dataSource,i=a.columns.canNotify;i&&(a.columns.canNotify=!1),t&&e.originalDataField&&(delete a.columnByDataField[e.dataField],e.dataField=e.originalDataField);const n=e.dataField,r=n+"Transformed";a.columnByDataField[n]=e,e.originalDataField=n,e.dataField=r,l.canNotify=!1;for(let t=0;t<l.length;t++){const a=l[t];a[r]=e.transform(a[n])}i&&(a.columns.canNotify=!0),l.canNotify=!0}}else e.transform&&(e.transform=void 0)}_initRows(){const e=this,t=e.dataSource,a=e.context;if(e.context=e,e.rows=[],e.rowById=[],t.boundHierarchy)return e.$.tableContainer.setAttribute("role","treegrid"),e.setAttribute("hierarchy",""),void e._initHierarchicalRows();e.$.tableContainer.setAttribute("role","grid");let l=0,i=t.length,n=!1;if(e.removeAttribute("hierarchy"),e.paging){const a=e.pageSize;if(e._filterInfo.query||e._filterInfo.rowFilters||e._filterInfo.appliedFilters){let e=0;for(let a=0;a<i;a++)!1!==t[a].$.filtered&&e++;i=e,n=!0}const r=Math.max(Math.ceil(i/a),1),o=e.$.pager.pagesCount;if(e.$.pager.pagesCount=r,e.$.pager.totalRecords=i,e.pageIndex=Math.max(Math.min(e.pageIndex,r-1),0),e.dataSource.virtualDataSource&&null!==o&&o!==r)return void e._fullRefresh();l=e.pageIndex*a,i=l+a}if(n){let a=-1;for(let n=0;n<t.length;n++){const r=t[n];if(r&&!1!==r.$.filtered){if(a++,a<l)continue;if(a>=i)break;e._addNewRow(r,n)}}}else for(let a=l;a<i;a++){const l=t[a];l&&!1!==l.$.filtered&&e._addNewRow(l,a)}e._observeRows(),e.context=a}_initHierarchicalRows(){const e=this,t=e.dataSource.boundHierarchy;let a=0,l=t.length,i=!1;if(e.paging){const n=e.pageSize;if(e._filterInfo.query||e._filterInfo.rowFilters||e._filterInfo.appliedFilters){let e=0;for(let a=0;a<l;a++)!1!==t[a].$.filtered&&e++;l=e,i=!0}const r=Math.max(Math.ceil(l/n),1);e.$.pager.pagesCount=r,e.$.pager.totalRecords=l,e.pageIndex=Math.max(Math.min(e.pageIndex,r-1),0),a=e.pageIndex*n,l=a+n}function n(t,a,l){for(let i=a;i<l;i++){const a=t[i];if(!a)break;a.leaf?a&&!1!==a.$.filtered&&e._addNewRow(a,i):(-1!==e._expandedIds.indexOf(a.$.id)?a.expanded=!0:void 0===a.expanded&&(a.expanded=!1),a.children.length&&!1!==a.$.filtered&&(e._addNewRow(a,i),n(a.children,0,a.children.length)))}}if(i){let e=-1;for(let i=0;i<t.length;i++){const r=t[i];if(r&&!1!==r.$.filtered){if(e++,e<a)continue;if(e>=l)break;n(t,i,i+1)}}}else n(t,a,l);e._observeRows()}_observeRows(){const e=this;e.rows=new Smart.ObservableArray(e.rows),e.rows.notify((function(t){if(!e.rows.canNotify||t.path||!e.dataSource)return;e.rows.canNotify=!1;const a=t.action;switch(e.dataSource.canNotify=!1,a){case"add":e.dataSource.add(e.rows[t.index]);break;case"update":e.dataSource.update(t.index,e.rows[t.index]);break;case"remove":e.dataSource.removeAt(t.index)}e.dataSource.canNotify=!0,e.rows.canNotify=!0,e._fullRefresh()}))}_addNewRow(e,t){const a=this,l=e.$.id,i=new Smart.Observable({data:e,boundIndex:t});-1!==a._disabledSelection.indexOf(l)&&(i.allowSelect=!1),i.canNotify=!0,i.notify((function(e){if(!a._editing&&"allowSelect"===e.propertyName){const t=a.$.tableContainer.querySelector(`[row-id="${l}"]`),i=a._disabledSelection.indexOf(l),n=a.selection;e.newValue||-1!==i?e.newValue&&-1!==i&&(t.setAttribute("aria-selected",!1),t.classList.remove("disable-select"),n&&t.firstElementChild.firstElementChild.removeAttribute("aria-disabled"),a._disabledSelection.splice(i,1)):(a.unselect(l),t.removeAttribute("aria-selected"),t.classList.add("disable-select"),n&&t.firstElementChild.firstElementChild.setAttribute("aria-disabled",!0),a._disabledSelection.push(l))}})),a.rowById[l]=i,a.rows.push(i)}refresh(){const e=this,t=e.selection,a=e.$.tableContainer,l=a.querySelector(".smart-table-filter-row"),i=a.querySelector("tfoot"),n=document.createElement("tbody"),r=document.createElement("thead"),o=document.createElement("tr"),s=document.createDocumentFragment();e.columns.canNotify=!1,a.innerHTML="",t&&(o.innerHTML='<th class="smart-table-select-all freeze-near" scope="col" aria-colindex="1"><div role="checkbox" aria-checked="false" aria-label="Toggle selection of all rows"></div></th>');for(let a=0;a<e._columns.length;a++){const l=document.createElement("th"),i=e._columns[a];l.setAttribute("aria-colindex",a+1+ +t),i.width&&(i.width=parseFloat(i.width),isNaN(i.width)?i.width=void 0:l.style.width=i.width+"px"),i.freeze&&l.classList.add("freeze-"+("far"===i.freeze?"far":"near")),i.responsivePriority&&("number"!=typeof i.responsivePriority&&(i.responsivePriority=1),i.responsivePriority=Math.max(Math.min(Math.round(i.responsivePriority),5),1),l.classList.add("priority-"+i.responsivePriority)),l.setAttribute("data-field",i.dataField),l.innerHTML=`<div class="wrapper" role="presentation"><div class="label">${i.label}</div></div>`,e.onColumnRender&&e.onColumnRender(i.dataField,l),s.appendChild(l)}o.appendChild(s),r.appendChild(o),a.appendChild(r),e.isRendered||!e.onInit||e._loadingState||e.onInit(),e._createDataRows(n),a.appendChild(n),e._createCustomHeaderRow(),e._createFilterRow(l),e._createFooterRow(i);const d=a.querySelectorAll("th[data-field]");for(let t=0;t<e._columns.length;t++){const a=e._columns[t];a.headerCellElement=d[t],a.headerCellElement.onclick=function(){const t=this.dataField;e.$.fireEvent("columnClick",{dataField:t}),"none"===e.sortMode||!1===a.allowSort||e._preventClickSort||(e._addSortIconContainer(this),this.headerCellElement.sortIconContainerElement.classList.contains("asc")?e.sortBy(t,"desc"):this.headerCellElement.sortIconContainerElement.classList.contains("desc")?e.sortBy(t,null):e.sortBy(t,"asc"))}.bind(a)}if(e._sortColumns&&e._sortColumns.length>0)for(let t=0;t<e._sortColumns.length;t++){const a=e._sortColumns[t],l=e.columnByDataField[a.dataField];e._addSortIconContainer(l,a.direction)}e._handleFrozenColumnPositions(),e.isRendered&&t&&e._updateSelectAllState(),e._handleAutoSizeMode(),e.columns.canNotify=!0}_refreshDataRows(){const e=this.$.tableContainer.children[1],t=Array.from(e.querySelectorAll("tr:not(.smart-table-filter-row)"));for(let e=0;e<t.length;e++)t[e].remove();this._createDataRows(e),this._handleFrozenColumnPositions()}_createDataRows(e){const t=this,a=t.rowDetailTemplate,l=t.selection,i=document.createDocumentFragment(),n=t.hasAttribute("hierarchy");for(let e=0;e<t.rows.length;e++){const r=t.rows[e],o=r.data;if(o.groupDataField){t._createGroupHeader(o,l,i);continue}const s=o.$.id,d=document.createElement("tr");let c=0;if(d.setAttribute("aria-rowindex",o.$.index+1),l){const e=document.createElement("td"),a=-1!==t._selectedIds.indexOf(s);e.className=`smart-table-select-row freeze-near${a?" selected":""}`,e.innerHTML=`<div class="selection-checkbox" role="checkbox" aria-checked="${a}" aria-label="Toggle row selection"></div>`,e.setAttribute("aria-colindex",1),d.appendChild(e),d.setAttribute("aria-selected",a),c++}for(let e=0;e<t._columns.length;e++){const a=document.createElement("td"),i=t._columns[e];a.setAttribute("data-field",i.dataField),a.setAttribute("aria-colindex",e+1+ +l);let s,u=t._formatCellValue(r,i,a);if(i.freeze&&a.classList.add("freeze-"+("far"===i.freeze?"far":"near")),i.responsivePriority&&a.classList.add("priority-"+i.responsivePriority),!1===i.allowEdit&&(a.classList.add("no-edit"),a.setAttribute("aria-readonly",!0)),0===e&&n){const e=t._areChildrenFiltered(o);o.leaf||(a.classList.add("tree-cell"),s=e),o.level&&(a.classList.add("outline-level-"+Math.min(o.level,10)),!o.leaf&&e||a.classList.add("tree-leaf"))}t._setCellContent(a,u,s),t.onCellRender&&t.onCellRender(o,i.dataField,o[i.dataField],a),t._applyConditionalFormattingToCell(a,i.dataField,o.$.index),d.appendChild(a),c++}if(d.data=o,d.setAttribute("row-id",s),-1!==t._disabledSelection.indexOf(s)&&(d.removeAttribute("aria-selected"),d.classList.add("disable-select"),l&&d.firstElementChild.firstElementChild.setAttribute("aria-disabled",!0)),o.expanded&&(-1===t._expandedIds.indexOf(s)&&t._expandedIds.push(s),d.setAttribute("aria-expanded",!0),d.classList.add("expanded")),o.level&&t._isCollapsed(o)&&(d.setAttribute("aria-hidden",!0),d.classList.add("collapsed","smart-hidden")),i.appendChild(d),a){const e=document.createElement("tr");e.className="smart-table-row-detail",-1===t._expandedRowDetailIds.indexOf(s)&&(e.setAttribute("aria-hidden",!0),e.classList.add("collapsed")),e.innerHTML=`<td colspan="${c}"><div class="smart-table-detail-container">${t._applyRowDetailTemplate(r)}</div></td>`,i.appendChild(e)}}i.appendChild(t._createLastRow()),e.appendChild(i),t._updateState("expanded"),t.getRootNode().activeElement===t.$.tableContainer&&t._tableContainerFocusHandler()}_applyConditionalFormattingToCell(e,t,a){const l=this;if(l._conditionalFormatting&&l._conditionalFormatting[t]){const i=l._conditionalFormatting[t][a];i&&(e.style.backgroundColor=i.background,e.style.color=i.color,e.style.fontFamily=i.fontFamily,e.style.fontSize=i.fontSize)}}_createLastRow(){const e=document.createElement("tr");e.setAttribute("aria-hidden",!0),e.classList.add("last-visible");try{new ResizeObserver(t=>{try{e.classList.toggle("sized",t[0].contentRect.height>0&&null!==e.previousSibling)}catch(e){}}).observe(e)}catch(e){}return e}_createGroupHeader(e,t,a){const l=this,i=l.columnByDataField[e.groupDataField].label,n=document.createElement("tr"),r=document.createElement("td"),o=document.createElement("div"),s=document.createElement("div"),d=document.createElement("div");n.data=e,s.classList.add("hierarchy-arrow","smart-arrow","smart-arrow-down"),s.setAttribute("role","button"),s.setAttribute("aria-label","Toggle row"),d.classList.add("group-label"),d.innerHTML=`${i}: <span class="group-label-value">${e.label}</span>`,r.colSpan=l._columns.length,r.classList.add("group-header"),e.level&&(r.classList.add("outline-level-"+Math.min(e.level,10)),l._isCollapsed(e)&&(n.setAttribute("aria-hidden",!0),n.classList.add("collapsed","smart-hidden"))),n.setAttribute("row-id",e.$.id),o.appendChild(s),o.appendChild(d),r.appendChild(o),t&&n.appendChild(document.createElement("td")),n.appendChild(r),a.appendChild(n)}_isCollapsed(e){let t=e.parent;for(;t;){if(!t.expanded)return!0;t=t.parent}return!1}_areChildrenFiltered(e){if(!e.leaf){for(let t=0;t<e.children.length;t++)if(!1!==e.children[t].$.filtered)return!0;return!1}}_applyRowDetailTemplate(e){const t=this,a=t.dataSource.dataFields;let l=t.rowDetailTemplate;for(let i=0;i<a.length;i++){const n=a[i].name,r=new RegExp(`{{${n}}}`,"g");let o=t.columnByDataField[n]||{dataField:n};if(r.test(l)){let a=t._formatCellValue(e,o,document.createElement("td"));"string"!=typeof a&&(a=e.data[o.dataField]),l=l.replace(r,a)}}return l}_handleFrozenColumnPositions(){const e=this,t=e.rightToLeft,a=e._columns;let l=[],i=[],n=0;function r(t,a,l,i,n){Array.from(e.$.tableContainer.querySelectorAll(`th:nth-child(${a+1}), td:nth-child(${a+1})`)).forEach(e=>{e.style[t]=l+"px",n&&(e.style.zIndex=2+i)})}e.selection&&(t?i.push(0):l.push(0),n=1);for(let e=0+n;e<a.length+n;e++){const r=a[e-n];r.freeze&&(!t&&"far"===r.freeze||t&&"far"!==r.freeze?i.push(e):l.push(e))}if(l.length<2&&i.length<2)return;const o=e.$.tableContainer.firstElementChild.querySelectorAll("th"),s=[];for(let e=0;e<o.length;e++)s.push(o[e].offsetWidth);if(t){for(let e=0;e<l.length-1;e++){const t=l[e];let a=0;for(let e=t+1;e<s.length;e++)-1!==l.indexOf(e)&&(a+=s[e]);r("left",t,a,e,!0)}for(let e=1;e<i.length;e++){const t=i[e];let a=0;for(let e=0;e<t;e++)-1!==i.indexOf(e)&&(a+=s[e]);r("right",t,a,e,!1)}}else{for(let e=1;e<l.length;e++){const t=l[e];let a=0;for(let e=0;e<t;e++)-1!==l.indexOf(e)&&(a+=s[e]);r("left",t,a,e,!1)}for(let e=0;e<i.length-1;e++){const t=i[e];let a=0;for(let e=t+1;e<s.length;e++)-1!==i.indexOf(e)&&(a+=s[e]);r("right",t,a,e,!0)}}}_formatCellValue(e,t,a,l){if(void 0===l&&(l=e.data[t.dataField]),t.formatFunction){const i={value:l,row:e&&e.data?e.data.$.id:e,column:t.dataField,cell:a,template:null};if(t.formatFunction(i),l=i.value,i.template instanceof HTMLElement)return i.template;if(null===i.template||"string"!=typeof i.template)return l;const n=i.template;let r="";if(n.startsWith("#")){const e=document.querySelector(n);if(e&&e instanceof HTMLTemplateElement){const t=e.content.cloneNode(!0),a=document.createElement("div");return a.appendChild(t),l=(l=(l=l.toString()).replace(/'/gi,"\\'")).replace(/"/gi,'\\"'),r=a.innerHTML.replace(/{{value}}/gi,l),r.indexOf("{{value=")>=0&&(l?(r=r.substring(0,r.indexOf("{{value="))+l+r.substring(r.indexOf("}")),r=r.replace(/}/gi,""),r=r.replace(/{/gi,"")):(r=r.replace(/{{value=/gi,""),r=r.replace(/}}/gi,""))),r}}return r=n.replace(/{{value}}/gi,l),r}return"date"===t.dataType&&l instanceof Date?l.toLocaleDateString():l}_setCellContent(e,t,a){if(t instanceof HTMLElement!=!0)return a&&(t=`<div>\n                                <div class="hierarchy-arrow smart-arrow smart-arrow-down" role="button" aria-label="Toggle row"></div>\n                                <div>${t}</div>\n                            </div>`),void(e.innerHTML=t);if(e.innerHTML="",a){const a=document.createElement("div");a.innerHTML='<div class="hierarchy-arrow smart-arrow smart-arrow-down" role="button" aria-label="Toggle row"></div><div>',a.children[1].appendChild(t),e.appendChild(a)}else e.appendChild(t)}_dataBind(e){const t=this;if(t.dataSource){if(t.dataSource instanceof Smart.DataAdapter==!1){const e=t.dataSource;if(Array.isArray(e)){const a=t.columns;let l;if(e.length>0){const t=e[0];l=[];for(let e in t){const a=t[e];"number"==typeof a?l.push({name:e,dataType:"number"}):"boolean"==typeof a?l.push({name:e,dataType:"boolean"}):a instanceof Date?l.push({name:e,dataType:"date"}):l.push({name:e,dataType:"string"})}}a&&a.length>0&&(l=l||[],a.forEach(e=>{if(e.dataType){const t=l.find(t=>t.name===e.dataField);t&&(t.dataType=e.dataType)}})),t.dataSource=new Smart.DataAdapter({dataSource:t.dataSource,dataFields:l})}else t.dataSource=new Smart.DataAdapter({dataSource:[]})}}else{if(t.dataFields=[],!t.columns||Array.isArray(t.columns)&&0===t.columns.length){t.columns=[];const e=t.querySelectorAll("th");for(let a=0;a<e.length;a++){const l=e[a].innerHTML.trim();let i={label:l,dataField:l,dataType:"string"};t.columns.push(i),t.dataFields.push(l)}}else for(let e=0;e<t.columns.length;e++){const a=t.columns[e];"string"==typeof a?t.dataFields.push(a):"object"==typeof a&&t.dataFields.push(a.dataField+(a.dataType?": "+a.dataType:""))}let e=[];if(!t.rows){const a=t.querySelectorAll("tr");for(let l=0;l<a.length;l++){const i={},n=a[l].querySelectorAll("td");if(n.length>0){for(let e=0;e<t.columns.length;e++){i[t.columns[e].dataField]=n[e].innerHTML.trim()}e.push(i)}}t.dataSource=new Smart.DataAdapter({dataSource:e,dataFields:t.dataFields})}const a=t.$.container.querySelectorAll("table");a.length>1&&a[a.length-1].parentNode.removeChild(a[a.length-1])}t._transformDataSource(),t._applyInitialConditionalFormatting(t.dataSource),t._initColumns(e),t._initRows(),t.dataSource.notify((function(e){if(t.dataSource._updating)return void delete t.dataSource._updating;if(t._editing)return;const a=e.data;switch(t.rows.canNotify=!1,e.action){case"add":if(a.length)for(let e=0;e<a.length;e++)t._addNewRow(a[e],t.dataSource.length-a.length+e);else t._addNewRow(a,t.dataSource.length-1);break;case"update":if(a.length)for(let l=0;l<a.length;l++){const i=e.index[l];t.rows[i].data=a[l]}break;case"insert":t._addNewRow(a,e.index);for(let e=0;e<t.rows.length;e++){t.rows[e].dataIndex=e}break;case"remove":!function(e){const a=t.rows[t.rows.length-1];delete t.rowById[a.uid],t.rows.splice(e,1)}(e.index);break;case"removeLast":!function(){const e=t.rows[t.rows.length-1];delete t.rowById[e.uid],t.rows.pop()}()}t.rows.canNotify=!0,t._fullRefresh()})),t.refresh(),t.dataSource.virtualDataSource&&(t.paging=!0,t.dataSource._updating=!0,t._requestVirtualDataSource("dataBind")),t.$.tableContainer.setAttribute("aria-rowcount",t.dataSource.length)}_requestVirtualDataSource(e){const t=this,a=t.pageSize,l=Math.max(t.pageIndex*a,0),i=Math.min(l+a,t.dataSource.length),n=[],r=[];let o=null;if(t._sortColumns&&(t._sortColumns.forEach((e,t)=>n[e.dataField]={sortOrder:e.direction,sortIndex:t}),n.length=t._sortColumns.length),t._filterInfo.appliedFilters){for(let e in t._filterInfo.appliedFilters)r[e]=t._filterInfo.appliedFilters[e];r.length=Object.keys(t._filterInfo.appliedFilters).length,o="and"}else{const e=t._filterInfo.inputFilters||t._filterInfo.rowFilters;e&&(e.forEach(e=>r[e[0]]=e[1]),r.length=e.length),o=t._filterInfo.inputFilters?"or":"and"}t.$.loadingIndicatorContainer.classList.remove("smart-hidden"),t.setAttribute("loading",""),t.dataSource.onVirtualDataSourceRequested(t._virtualDataSourceRequestedCallback.bind(t),{first:l,last:i,sorting:n,filtering:r,filterOperator:o,grouping:[],action:e})}_virtualDataSourceRequestedCallback(){this.$.loadingIndicatorContainer.classList.add("smart-hidden"),this.removeAttribute("loading"),this._initRows(),this._refreshDataRows()}sortBy(e,t){const a=this.columnByDataField[e];if(a){if(!1===a.allowSort)return;e=a.dataField}this._sortBy({column:a,columnDataField:e,sortOrder:t,dataFields:this.dataSource.dataFields,columnByDataField:"columnByDataField"})}_sortBy(e){const t=this,a=e.column,l=e.columnDataField,i=e.sortOrder,n=e.dataFields,r=e.columnByDataField,o=[],s=[],d=[],c=function(e){t._addSortIconContainer(e),e.headerCellElement.sortIconContainerElement.classList.remove("desc"),e.headerCellElement.sortIconContainerElement.classList.remove("asc"),e.sortOrder=null},u=function(){if(t._sortColumns&&t._sortColumns.length>0)for(let e=0;e<t._sortColumns.length;e++){const a=t._sortColumns[e],l=t[r][a.dataField];c(l)}t._sortColumns=[]};if(null==a)return void(t._sortColumns&&t._sortColumns.length>0&&(u(),t._sortCallback(o,s,d)));if("none"===t.sortMode||!t.dataSource)return;if(i&&a.sortOrder===i)return;let f=i||"asc";c(a),t._sortColumns||(t._sortColumns=[]);let m="string";for(let e=0;e<n.length;e++){const t=n[e];if(t.name===l){m=t.dataType,"any"===m&&(m="number");break}}let h=!0;for(let e=0;e<t._sortColumns.length;e++){const i=t._sortColumns[e];if(i.dataField===l)if(h=!1,"asc"===i.direction)i.direction="desc",f="desc";else if("desc"===i.direction){t._sortColumns.splice(e,1),c(a),f=null;break}}h&&("one"===t.sortMode&&u(),t._sortColumns.push({dataField:l,direction:f,dataType:m})),t._addSortIconContainer(a),null!==f?(a.headerCellElement.sortIconContainerElement.classList.remove("asc"),a.headerCellElement.sortIconContainerElement.classList.remove("desc"),a.sortOrder=f,"desc"===f?(a.headerCellElement.sortIconContainerElement.classList.add("desc"),a.headerCellElement.setAttribute("aria-sort","descending")):(a.headerCellElement.sortIconContainerElement.classList.add("asc"),a.headerCellElement.setAttribute("aria-sort","ascending"))):(a.headerCellElement.sortIconContainerElement.classList.remove("asc"),a.headerCellElement.sortIconContainerElement.classList.remove("desc"),a.headerCellElement.removeAttribute("aria-sort"));for(let e=0;e<t._sortColumns.length;e++){const a=t._sortColumns[e];o.push(a.dataField),s.push(a.direction),d.push(a.dataType)}t._sortCallback(o,s,d),t._updateState("sorted"),t.$.fireEvent("sort",{columns:t._sortColumns})}_addSortIconContainer(e,t){const a=e.headerCellElement;if(!a.sortIconContainerElement){const e=document.createElement("div");e.classList.add("sort-by"),e.setAttribute("aria-hidden",!0),t&&e.classList.add(t),a.firstElementChild.appendChild(e),a.sortIconContainerElement=e}}_sortCallback(e,t,a){const l=this,i=l.dataSource;i.virtualDataSource||(i._sort(l.dataSource.boundSource,e,t,a,l.sort),i.refreshHierarchy()),l._fullRefresh("sort")}clearSort(){this.sortBy(null)}_fullRefresh(e){const t=this;if(t.dataSource.virtualDataSource)return t.dataSource._updating=!0,void t._requestVirtualDataSource(e);t._initRows(),t._refreshDataRows()}_pagerChangeHandler(e){(this.isInShadowDOM?e.composedPath()[0]:e.target)===this.$.pager&&(this.pageIndex=e.detail.index,this._fullRefresh("pageIndexChange"),this.$.fireEvent("page",{action:"pageIndexChange"}))}_pagerPageSizeChanged(e){this.pageSize=e.detail.value,this._fullRefresh("pageSizeChange"),this.$.fireEvent("page",{action:"pageSizeChange"})}_filterInputKeyupHandler(){const e=this;clearTimeout(e._filterInputTimeout),e._filterInputTimeout=setTimeout((function(){if(e._filterInfo&&e.$.filterInput.value!==e._filterInfo.query){const t=e.context;e.context=e,e._filterByAll(e.$.filterInput.value),e.context=t}}),500)}_filterByAll(e){const t=this;if(t._filterInfo.query=e,""===e)return void t.clearFilters();const a=[];t._clearRowFilters(),delete t._filterInfo.appliedFilters,t._filterInfo.stringDataFields.forEach(t=>{const l=new Smart.Utilities.FilterGroup,i=l.createFilter("string",e,"CONTAINS");l.addFilter("or",i),a.push([t,l])}),t.dataSource.virtualDataSource||t.dataSource._filter(a,"or"),t._filterInfo.inputFilters=a,t._fullRefresh("filter"),t._updateState("filtered"),t.$.fireEvent("filter",{action:"add",filters:a})}_setupPagingAndFiltering(){this.$.pager.$.pageSizeSelector.classList.add("underlined"),this.$.pager.$.pageSizeSelector.dropDownAppendTo="body",this._filterInfo={query:""},this._applyFilterTemplate(),this.$.header.classList.toggle("smart-hidden",this.filterRow&&!this.filterTemplate)}_applyFilterTemplate(){const e=this,t=e.filterTemplate;if(e.$.filterTemplateContainer.innerHTML="",!t)return e.$.filterInput.classList.remove("smart-hidden"),e.$.filterTemplateContainer.classList.add("smart-hidden"),void(e.filterTemplate=null);const a=document.getElementById(t);if(a&&a instanceof HTMLTemplateElement){const t=document.importNode(a.content,!0);e.$.filterInput.classList.add("smart-hidden"),e.$.filterTemplateContainer.classList.remove("smart-hidden"),e.$.filterTemplateContainer.appendChild(t)}else e.filterTemplate=null,e.$.filterInput.classList.remove("smart-hidden"),e.$.filterTemplateContainer.classList.add("smart-hidden")}_refreshFilters(e){const t=this,a=[];for(let e in t._filterInfo.appliedFilters){let l=t._filterInfo.appliedFilters[e];a.push([e,l])}0!==a.length?(t._clearFilterInput(),t._clearRowFilters(),t.dataSource.virtualDataSource||t.dataSource._filter(a,"or"),t._fullRefresh("filter"),t._updateState("filtered"),e&&t.$.fireEvent("filter",{action:e,filters:a})):t.clearFilters()}_localize(){const e=this,t=e.$.pager;t.messages[e.locale]||(t.messages[e.locale]={}),t.messages[e.locale].pageSizeLabel=e.localize("itemsPerPage"),t.messages[e.locale].summaryPrefix=e.localize("summaryPrefix"),t.messages[e.locale].summarySuffix="",t.$.firstButton.setAttribute("tooltip",e.localize("firstButton")),t.$.previousButton.setAttribute("tooltip",e.localize("previousButton")),t.$.nextButton.setAttribute("tooltip",e.localize("nextButton")),t.$.lastButton.setAttribute("tooltip",e.localize("lastButton")),e.$.filterInput.placeholder=e.localize("filterPlaceholder"),e.$.conditionalFormattingButton.setAttribute("tooltip",e.localize("conditionalFormatting")),e._filterInfo.stringConditions=[{value:"EMPTY",label:e.localize("EMPTY")},{value:"NOT_EMPTY",label:e.localize("NOT_EMPTY")},{value:"CONTAINS",label:e.localize("CONTAINS")},{value:"CONTAINS_CASE_SENSITIVE",label:e.localize("CONTAINS_CASE_SENSITIVE")},{value:"DOES_NOT_CONTAIN",label:e.localize("DOES_NOT_CONTAIN")},{value:"DOES_NOT_CONTAIN_CASE_SENSITIVE",label:e.localize("DOES_NOT_CONTAIN_CASE_SENSITIVE")},{value:"STARTS_WITH",label:e.localize("STARTS_WITH")},{value:"STARTS_WITH_CASE_SENSITIVE",label:e.localize("STARTS_WITH_CASE_SENSITIVE")},{value:"ENDS_WITH",label:e.localize("ENDS_WITH")},{value:"ENDS_WITH_CASE_SENSITIVE",label:e.localize("ENDS_WITH_CASE_SENSITIVE")},{value:"EQUAL",label:e.localize("EQUAL")},{value:"EQUAL_CASE_SENSITIVE",label:e.localize("EQUAL_CASE_SENSITIVE")},{value:"NULL",label:e.localize("NULL")},{value:"NOT_NULL",label:e.localize("NOT_NULL")}],e._filterInfo.numberAndDateConditions=[{value:"EQUAL",label:e.localize("EQUAL")},{value:"NOT_EQUAL",label:e.localize("NOT_EQUAL")},{value:"LESS_THAN",label:e.localize("LESS_THAN")},{value:"LESS_THAN_OR_EQUAL",label:e.localize("LESS_THAN_OR_EQUAL")},{value:"GREATER_THAN",label:e.localize("GREATER_THAN")},{value:"GREATER_THAN_OR_EQUAL",label:e.localize("GREATER_THAN_OR_EQUAL")},{value:"NULL",label:e.localize("NULL")},{value:"NOT_NULL",label:e.localize("NOT_NULL")}]}_createFilterRow(e){const t=this;if(!t.filtering||!t.filterRow)return;if(e)return void t.$.tableContainer.children[1].insertBefore(e,t.$.tableContainer.children[1].firstElementChild);const a=document.createElement("tr"),l=` animation="${t.animation}" `,i=t.rightToLeft?" right-to-left":"";let n="";a.className="smart-table-filter-row",t.selection&&(n+="<td></td>");for(let e=0;e<t._columns.length;e++){const a=t._columns[e],r=[];let o,s,d,c;"string"===a.dataType?(o=t._filterInfo.stringConditions,s="string",d="string-filter",c=t.localize("CONTAINS")):(o=t._filterInfo.numberAndDateConditions,s=a.dataType,d="num-date-filter",c=t.localize("EQUAL")),a.freeze&&r.push("freeze-"+("far"===a.freeze?"far":"near")),a.responsivePriority&&r.push("priority-"+a.responsivePriority),!1===a.allowFilter&&r.push("no-filter"),n+=`<td${r.length?' class="'+r.join(" ")+'"':""} filter-for="${a.dataField}">\n                            <div>\n                                <input type="${s}" class="filter-value" aria-label="Filter value" />\n                                <smart-input class="${d}${l}data-source='${JSON.stringify(o)}' drop-down-button-position="right" drop-down-width="auto" readonly${i} value="${c}" title="${t.localize("filterCondition")}" aria-label="Filter condition"></smart-input>\n                                <smart-button class="smart-hidden" title="${t.localize("clearFilter")}"${l}${i} aria-label="Clear filter"></smart-button>\n                            </div>\n                        </td>`}a.innerHTML=n,t.$.tableContainer.children[1].insertBefore(a,t.$.tableContainer.children[1].firstElementChild)}_tableContainerChangeHandler(e){const t=this,a=t.isInShadowDOM?e.composedPath()[0]:e.target;(a.classList.contains("filter-value")&&"date"===a.type||a instanceof Smart.Input&&(""!==a.previousElementSibling.value||-1!==["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(e.detail.value)))&&t._applyRowFilters()}_tableContainerClickHandler(e){const t=this;if(t._editing)return;const a=t.isInShadowDOM?e.composedPath()[0]:e.target,l=a.closest("tbody tr[row-id], tfoot tr.grand-total");if(l){const i=a.closest("td");if(a.classList.contains("hierarchy-arrow"))return void t._hierarchyArrowClickHandler(l,i);const n=l.getAttribute("row-id"),r=t.rowById?t.rowById[n].data:t.rows.dataItemById[n],o=r?r.$.id:void 0,s=i?i.getAttribute("data-field"):void 0;if(void 0!==s&&t.$.fireEvent("cellClick",{row:r,dataField:s}),t._toggleSelection(l,o,e,a),t.editing||t.drillDown){if(!s||i.classList.contains("no-edit"))return;clearTimeout(t._dblclickObject.timeout),t._dblclickObject.numberOfClicks++,2===t._dblclickObject.numberOfClicks?(t._dblclickObject.numberOfClicks=0,t._beginEdit({rowElement:l,cell:i,dataField:s})):t._dblclickObject.timeout=setTimeout((function(){t._dblclickObject.numberOfClicks=0}),300)}return void(t.rowDetailTemplate&&t._toggleRowDetail(l,o))}const i=a.closest(".smart-table-select-all");if(i)return void t._selectAllCheckboxClickHandler(i);const n=a.closest(".smart-table-filter-row smart-button");if(n){const e=n.parentElement.firstElementChild,a=n.parentElement.children[1];return e.value="",-1!==["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(a.$.input.dataValue)&&(a.value=t.localize("text"===e.type?"CONTAINS":"EQUAL"),delete a.$.input.dataValue),void t._applyRowFilters()}}_toggleSelection(e,t,a,l){const i=this;if(!i.selection||e.classList.contains("disable-select"))return;function n(){i._selectedIds=[],Array.from(i.$.tableContainer.querySelectorAll(".smart-table-select-row.selected")).forEach(e=>{e.parentElement.classList.contains("disable-select")||e.parentElement.setAttribute("aria-selected",!1),e.classList.remove("selected"),e.firstElementChild.setAttribute("aria-checked",!1)})}const r=-1!==i._selectedIds.indexOf(t);if("many"===i.selectionMode)r?i.unselect(t):(i.select(t),i._selectionStart=e);else{if(i._selectionStart&&a.shiftKey){const t=Array.from(i.$.tableContainer.querySelectorAll("tr[row-id]")),a=t.indexOf(e),l=t.indexOf(i._selectionStart);if(a!==l){const e=JSON.stringify(i._selectedIds.slice(0).sort()),r=Math.min(a,l),o=Math.max(a,l);n();for(let e=r;e<=o;e++){const a=t[e];if(!a.classList.contains("disable-select")&&!a.firstElementChild.classList.contains("selected")){const e=a.data.$.id;a.setAttribute("aria-selected",!0),a.firstElementChild.classList.add("selected"),a.firstElementChild.firstElementChild.setAttribute("aria-checked",!0),i._selectedIds.push(e)}}return e!==JSON.stringify(i._selectedIds.slice(0).sort())&&(i._updateState("selected"),i.$.fireEvent("change")),i._updateSelectAllState(),void getSelection().removeAllRanges()}if(1===i._selectedIds.length)return}const o=!!l&&l.classList.contains("selection-checkbox");if(r&&(o||1===i._selectedIds.length||a.ctrlKey||a.metaKey))return delete i._selectionStart,void i.unselect(t);o||a.ctrlKey||a.metaKey||n(),i.select(t),i._selectionStart=e}}_selectAllCheckboxClickHandler(e,t){const a=this;void 0===t&&(t=a.dataSource);const l=t.length,i=a._selectedIds.length===l-a._disabledSelection.length,n=a._selectedIds.slice(0);if(a._selectedIds=[],i)e.classList.remove("indeterminate","selected"),e.firstElementChild.setAttribute("aria-checked",!1),Array.from(a.$.tableContainer.querySelectorAll(".smart-table-select-row")).forEach(e=>{e.parentElement.classList.contains("disable-select")||e.parentElement.setAttribute("aria-selected",!1),e.classList.remove("selected"),e.firstElementChild.setAttribute("aria-checked",!1)});else{let i=0;for(let e=0;e<l;e++){const l=t[e].$.id;-1===a._disabledSelection.indexOf(l)&&(a._selectedIds.push(l),i++)}i===l?(e.classList.remove("indeterminate"),e.classList.add("selected"),e.firstElementChild.setAttribute("aria-checked",!0)):0===i?(e.classList.remove("indeterminate","selected"),e.firstElementChild.setAttribute("aria-checked",!1)):(e.classList.remove("selected"),e.classList.add("indeterminate"),e.firstElementChild.setAttribute("aria-checked","mixed")),Array.from(a.$.tableContainer.querySelectorAll(".smart-table-select-row")).forEach(e=>{e.parentElement.classList.contains("disable-select")||(e.parentElement.setAttribute("aria-selected",!0),e.classList.add("selected"),e.firstElementChild.setAttribute("aria-checked",!0))})}n.length!==a._selectedIds.length&&(a._updateState("selected"),a.$.fireEvent("change"))}_beginEdit(e){const t=this,a=e.dataField;let l=e.rowId,i=e.rowElement,n=e.rowObject,r=e.cell,o=[],s=[];if(t.editing){i||(i=t.$.tableContainer.querySelector(`tr[row-id="${l}"]`)),n||(l=i.getAttribute("row-id"),n=t.rowById[l],l=n.data.$.id),"row"===t.editMode?(o=i.querySelectorAll("td[data-field]"),s=t._columns.map(e=>e.dataField),r||(r=a?i.querySelector(`td[data-field="${a}"`):o[0])):(r||(r=i.querySelector(`td[data-field="${a}"`)),o=[r],s=[a]),t._editing={row:n,cells:[]};for(let e=0;e<s.length;e++){const a=o[e];let i=s[e];const d=t.columnByDataField[i];if(!1===d.allowEdit)continue;d.transform&&(i=d.originalDataField);const c=n.data[i],u=t._initEditor(d,l,i,c);let f=u instanceof HTMLInputElement&&"date"===u.type;if(d.editor&&d.editor.template)d.editor.onRender&&d.editor.onRender(l,i,u,c);else if(f)if(c instanceof Date&&!isNaN(c.getTime())){const e=(c.getMonth()+1).toString(),t=c.getDate().toString();u.value=`${c.getFullYear()}-${"0".repeat(2-e.length)}${e}-${"0".repeat(2-t.length)}${t}`}else u.value="";else u.value=c;a.classList.add("editing"),a.innerHTML="",a.appendChild(u),a===r&&u.focus&&(u.focus(),d.editor&&d.editor.template||f||!u.select||u.select()),t._editing.cells.push({dataField:i,editor:u,element:a}),t.$.fireEvent("cellBeginEdit",{row:n.data,dataField:i})}}}_initEditor(e,t,a,l){let i=this._editors[a];if(i)return i;if(e.editor&&e.editor.template){const n=document.createElement("div");return n.innerHTML=e.editor.template,i=n.firstElementChild,i.className="smart-table-editor",e.editor.onInit&&e.editor.onInit(t,a,i,l),i}return i=document.createElement("input"),i.className="smart-table-editor standard","number"===e.dataType?i.type="number":"date"===e.dataType?i.type="date":i.type="text",this._editors[a]=i,i}_toggleRowDetail(e,t){const a=this,l=e.nextElementSibling;if("none"===a.animation)return l.classList.toggle("collapsed"),void(l.classList.contains("collapsed")?(l.setAttribute("aria-hidden",!0),a._expandedRowDetailIds=a._expandedRowDetailIds.filter(e=>e!==t)):(l.removeAttribute("aria-hidden"),a._expandedRowDetailIds.push(t)));const i=l.firstElementChild.firstElementChild;if(l.classList.contains("collapsed")){const e=`calc(${l.firstElementChild.scrollHeight}px + 2 * var(--smart-table-cell-padding))`;return l.ontransitionend=function(){l.style.height=null,i.style.height=null,l.removeAttribute("aria-hidden"),l.classList.remove("collapsed"),i.style.paddingTop=null,i.style.paddingBottom=null,l.ontransitionend=null},l.style.height=e,i.style.height=e,i.style.paddingTop="var(--smart-table-cell-padding)",i.style.paddingBottom="var(--smart-table-cell-padding)",void a._expandedRowDetailIds.push(t)}const n=l.firstElementChild.scrollHeight+"px";i.style.height=n,i.style.paddingTop="var(--smart-table-cell-padding)",i.style.paddingBottom="var(--smart-table-cell-padding)",l.style.height=n,a._expandedRowDetailIds=a._expandedRowDetailIds.filter(e=>e!==t),requestAnimationFrame(()=>{l.ontransitionend=function(){l.setAttribute("aria-hidden",!0),l.classList.add("collapsed"),i.style.paddingTop=null,i.style.paddingBottom=null,i.style.height=null,l.style.height=null,l.ontransitionend=null},i.style.paddingTop=0,i.style.paddingBottom=0,i.style.height=0,l.style.height=0})}_setFocusable(){const e=this,t="smart-table"===e.nodeName.toLowerCase();if(!e.keyboardNavigation||e.disabled||e.unfocusable||e.hasAttribute("modal"))return e.$.tableContainer.removeAttribute("tabindex"),t&&(e.$.filterInput.unfocusable=!0,e.$.pager.unfocusable=!0),void(e.$.conditionalFormattingButton.unfocusable=!0);const a=e.$.tableContainer.getAttribute("tabindex");(null===a||a<0)&&e.$.tableContainer.setAttribute("tabindex",0),t&&(e.$.filterInput.unfocusable=!1,e.$.pager.unfocusable=!1),e.$.conditionalFormattingButton.unfocusable=!1}_tableContainerFocusHandler(){const e=this;e._focusedCell&&e.$.tableContainer.contains(e._focusedCell)||e._focusCell(e.$.tableContainer.children[1].querySelector("td[data-field], td.group-header"))}_tableContainerDownHandler(e){const t=this.isInShadowDOM?e.originalEvent.composedPath()[0]:e.originalEvent.target;this._focusCell(t.closest("td[data-field], td.group-header"))}_focusCell(e,t){const a=this;if(!e||!e.hasAttribute("data-field")&&!e.classList.contains("group-header")||e.parentElement.classList.contains("grand-total"))return;if(a._focusedCell){if(a._focusedCell===e)return;a._focusedCell.removeAttribute("focus")}if(a._focusedCell=e,e.setAttribute("focus",""),!t)return;const l=a.$.tableContainer.parentElement,i=a.freezeHeader?a.$.tableContainer.firstElementChild.offsetHeight:0,n=l.scrollTop;let r=e.offsetTop-i;if(r<n)l.scrollTop=r;else{const t=a.$.header.offsetHeight,o=a.footerRow&&a.freezeFooter?a.$.tableContainer.lastElementChild.offsetHeight:0,s=a.$.pager.offsetHeight,d=l.clientHeight-(t+i+o+s);r+=e.offsetHeight,r>n+d&&(l.scrollTop=r-d)}if(e.classList.contains("freeze-near")||e.classList.contains("freeze-far"))return;const o=l.scrollLeft,s=a.$.tableContainer.querySelector("tr[row-id]");let d,c=0;if(Array.from(s.children).forEach(e=>{e.classList.contains("freeze-near")&&(c+=e.offsetWidth)}),a.rightToLeft){let t=e.previousElementSibling;for(d=0;t;)t.classList.contains("freeze-near")||(d-=t.offsetWidth),t=t.previousElementSibling;if(d>o)l.scrollLeft=d;else{const t=l.clientWidth;d-=e.offsetWidth,d<o-t&&(l.scrollLeft=d+t-c)}}else if(d=e.offsetLeft-c,d<o)l.scrollLeft=d;else{const t=l.clientWidth;d+=e.offsetWidth+c,d>o+t&&(l.scrollLeft=d-t)}}_tableContainerKeydownHandler(e){const t=this,a=e.key,l=t._focusedCell;if(!l)return;const i=l.classList.contains("group-header");if(i&&-1!==["ArrowRight","ArrowLeft","Home","End"," ","Escape","F2"].indexOf(a))return void e.preventDefault();if(t._editing){switch(a){case"Enter":t.endEdit();break;case"Escape":t.cancelEdit();break;default:return}return t.$.tableContainer.focus(),void e.preventDefault()}const n=l.parentElement;let r="ArrowRight",o="ArrowLeft";switch(t.rightToLeft&&(r="ArrowLeft",o="ArrowRight"),a){case r:case o:{const e=a===r?"nextElementSibling":"previousElementSibling";let i=l[e];for(;i&&i.classList.contains("smart-hidden");)i=i[e];t._focusCell(i,!0);break}case"ArrowUp":case"ArrowDown":{const e="ArrowUp"===a?"previousElementSibling":"nextElementSibling";let r=n[e];for(;r&&(r.classList.contains("smart-table-row-detail")||r.classList.contains("collapsed"));)r=r[e];r&&(i?t._focusCell(r.querySelector("td[data-field], .group-header"),!0):t._focusCell(r.querySelector(`td[data-field="${l.getAttribute("data-field")}"], .group-header`),!0));break}case"Home":t._focusCell(n.querySelector("td[data-field]"),!0);break;case"End":{const e=n.querySelectorAll("td[data-field]");let a=e.length-1,l=e[a];for(;l.classList.contains("smart-hidden");)a--,l=e[a];t._focusCell(l,!0);break}case"PageDown":t._pageDownHandler(l);break;case"PageUp":t._pageUpHandler(l);break;case"Enter":{const e=n.data;t.dataSource.boundHierarchy&&t._areChildrenFiltered(e)?t._hierarchyArrowClickHandler(n,l):t.rowDetailTemplate&&t._toggleRowDetail(n,e.$.id);break}case" ":t._toggleSelection(n,n.data.$.id,e);break;case"F2":t.beginEdit(n.data.$.id,l.getAttribute("data-field"));break;case"Shift":"extended"===t.selectionMode&&t.$.tableContainer.classList.add("smart-unselectable");break;default:return}e.preventDefault()}_pageDownHandler(e){const t=this,a=t.paging;if(!a&&e.parentElement===e.parentElement.parentElement.lastElementChild)return;const l=t.$.tableContainer.parentElement;let i=e.getAttribute("data-field");function n(){const e=t.$.tableContainer.querySelectorAll("tr[row-id]");let a=t.$.header.offsetHeight+t.$.pager.offsetHeight;t.footerRow&&t.freezeFooter&&(a+=t.$.tableContainer.lastElementChild.offsetHeight);for(let t=e.length-1;t>=0;t--){const n=e[t];if(!n.classList.contains("collapsed")&&n.offsetTop+n.offsetHeight<=l.scrollTop+l.clientHeight-a)return n.querySelector(`td[data-field${i}], .group-header`)}}i=i?`="${i}"`:"";let r=n();if(r)if(e===r)if(l.scrollTop+=l.clientHeight,r=n(),a&&e===r){const e=t.pageIndex;t.navigateTo(t.pageIndex+1),t.pageIndex!==e&&t._focusCell(t.$.tableContainer.querySelector(`td[data-field${i}], .group-header`),!0)}else t._focusCell(r);else t._focusCell(r)}_pageUpHandler(e){const t=this,a=t.$.tableContainer.parentElement;let l=e.getAttribute("data-field");function i(){const e=t.$.tableContainer.querySelectorAll("tr[row-id]");let i=0;t.freezeHeader&&(i=t.$.tableContainer.firstElementChild.offsetHeight);for(let t=0;t<e.length;t++){const n=e[t];if(!n.classList.contains("collapsed")&&n.offsetTop>=a.scrollTop+i)return n.querySelector(`td[data-field${l}], .group-header`)}}l=l?`="${l}"`:"";let n=i();if(n)if(e===n)if(a.scrollTop-=a.clientHeight,n=i(),t.paging&&e===n){const e=t.pageIndex;if(t.navigateTo(t.pageIndex-1),t.pageIndex!==e){const e=t.$.tableContainer.querySelectorAll(`td[data-field${l}], .group-header`);t._focusCell(e[e.length-1],!0)}}else t._focusCell(n);else t._focusCell(n)}_tableContainerKeyupHandler(e){const t=this,a=t.isInShadowDOM?e.composedPath()[0]:e.target;if(a.classList.contains("filter-value")&&"date"!==a.type)return clearTimeout(t._filterRowTimeout),void(t._filterRowTimeout=setTimeout((function(){const e=t.context;t.context=t,t._applyRowFilters(),t.context=e}),500));"Shift"===e.key&&"extended"===t.selectionMode&&t.$.tableContainer.classList.remove("smart-unselectable")}_tableContainerPointeroverHandler(e){if(!this.tooltip)return;const t=(this.isInShadowDOM?e.composedPath()[0]:e.target).closest("tbody td[data-field]");if(!t)return;const a=this.$.tableContainer.querySelector(".tooltip");a&&(a.classList.remove("tooltip"),a.removeAttribute("title")),(t.classList.contains("tree-cell")&&t.firstElementChild.children[1].scrollWidth>t.firstElementChild.children[1].offsetWidth||t.scrollWidth>t.offsetWidth)&&(t.classList.add("tooltip"),t.title=t.innerText)}_documentDownHandler(e){const t=this,a=t.isInShadowDOM?e.originalEvent.composedPath()[0]:e.originalEvent.target;if(!t._editing||a.closest(".smart-table-editor")){if(t.columnReorder&&!t.columnTotals){const l=a.closest("th[data-field]:not(.smart-pivot-table-total-header)");l&&t.$.tableContainer.contains(l)&&(t.$.tableContainer.classList.add("smart-unselectable"),t._dragDetails={FeedbackShown:!1,Item:l,StartPosition:{left:e.pageX,top:e.pageY},StartTime:new Date})}}else{const e=a.closest(".smart-drop-down");if(!e)return void t.endEdit();const l=e.ownerElement;if(!l)return void t.endEdit();if(t.$.container.contains(l)&&l.classList.contains("smart-table-editor"))return;t.endEdit()}}_documentMoveHandler(e){const t=this,a=t._dragDetails;if(!a)return;if(!a.FeedbackShown){const l=(new Date).getTime()-a.StartTime.getTime()>500,i=Math.abs(a.StartPosition.left-e.pageX)>5||Math.abs(a.StartPosition.top-e.pageY)>5;if(!i||!(!t._isMobile||t._isMobile&&l))return void(t._isMobile&&i&&!l&&(delete t._dragDetails,t.$.tableContainer.classList.remove("smart-unselectable")));t._hideBodyOverflow(),a.Feedback=t._addDragFeedback(),a.FeedbackShown=!0,a.Item.classList.add("dragged"),t.classList.add("smart-unselectable")}const l=t.$.tableContainer.parentElement;a.Feedback.style.left=e.pageX+10+"px",a.Feedback.style.top=e.pageY+10+"px",a.HoveredItem&&(a.HoveredItem.classList.remove("drop-column","left","right"),delete a.HoveredItem),l.offsetWidth<l.scrollWidth&&(clearInterval(t._dragInterval),t._dragInterval=setInterval((function(){const a=l.getBoundingClientRect();a.left<=e.clientX&&a.left+a.width>=e.clientX?e.clientX>=a.left&&e.clientX<=a.left+25?l.scrollLeft-=t._autoScrollCoefficient:e.clientX>=a.left+a.width-25&&e.clientX<=a.left+a.width?l.scrollLeft+=t._autoScrollCoefficient:clearInterval(t._dragInterval):clearInterval(t._dragInterval)}),10));const i=t._getClosestThToHover(e);i&&(i.classList.add("drop-column"),a.HoveredItem=i)}_hideBodyOverflow(){const e=(document.scrollingElement||document.documentElement).scrollHeight>document.documentElement.clientHeight,t=(document.scrollingElement||document.documentElement).scrollWidth>document.documentElement.clientWidth;this._originalBodyOverflow={overflowX:document.body.style.overflowX,overflowY:document.body.style.overflowY,overflow:document.body.style.overflow},document.body.classList.add("smart-dragging"),document.body.style.overflow=document.body.style.overflowX=document.body.style.overflowY="",e&&!t?document.body.style.overflowX="hidden":t&&!e?document.body.style.overflowY="hidden":t||e||(document.body.style.overflow="hidden")}_addDragFeedback(){const e=this,t=e._dragDetails.Item,a=document.createElement("div");return a.className="smart-table-feedback",a.setAttribute("parent-table-id",e.id),a.innerHTML=e.columnByDataField[t.getAttribute("data-field")].label,e.theme&&a.setAttribute("theme",e.theme),document.body.appendChild(a),a}_getClosestThToHover(e){const t=e.clientX,a=Array.from(this.$.tableContainer.querySelectorAll("th[data-field]:not(.smart-pivot-table-total-header)"));let l,i,n;for(let e=0;e<a.length;e++){const r=a[e];if(!r||this._dragDetails.Item===r)continue;const o=r.getBoundingClientRect(),s=Math.abs(t-o.left),d=Math.abs(t-o.right),c=Math.min(s,d);if(!(void 0===i||c<i))break;l=r,i=c,n=s<d?"left":"right"}return l&&l.classList.add(n),l}_documentUpHandler(){const e=this,t=e._dragDetails;if(!t)return;if(delete e._dragDetails,e.$.tableContainer.classList.remove("smart-unselectable"),!t.FeedbackShown)return;const a=t.HoveredItem;document.body.classList.remove("smart-dragging"),document.body.style.overflow=e._originalBodyOverflow.overflow,document.body.style.eoverflowX=e._originalBodyOverflow.overflowX,document.body.style.overflowY=e._originalBodyOverflow.overflowY,delete e._originalBodyOverflow,e.classList.remove("smart-unselectable"),t.Item.classList.remove("dragged"),document.body.removeChild(t.Feedback),clearInterval(e._dragInterval),delete e._dragInterval,a&&e._applyColumnReorder(t,a),e._preventClickSort=!0,requestAnimationFrame(()=>delete e._preventClickSort)}_applyColumnReorder(e,t){const a=this.rightToLeft,l=this._columns,i=e.Item.getAttribute("data-field"),n=l.find(e=>e.dataField===i),r=t.getAttribute("data-field"),o=t.classList.contains("right"),s=this._columns.filter(e=>e.dataField!==i),d=s.findIndex(e=>e.dataField===r);t.classList.remove("drop-column","left","right"),o&&!a||!o&&a?s.splice(d+1,0,n):s.splice(d,0,n),l.map(e=>e.dataField).join(",")!==s.map(e=>e.dataField).join(",")&&(this.columns=s,this._initColumns(),this.refresh())}_applyRowFilters(){const e=this;if(!e.filtering||!e.filterRow)return;const t=e.$.tableContainer.querySelector(".smart-table-filter-row"),a=Number(e.selection),l=[],i=[];for(let n=0;n<e._columns.length;n++){const r=e._columns[n].dataField,o=e._columns[n].dataType,s=t.children[n+a].firstElementChild,d=s.children[2];let c=s.firstElementChild.value,u=s.children[1].value;"string"===o?u=e._filterInfo.stringConditions.find(e=>e.label===u).value:(u=e._filterInfo.numberAndDateConditions.find(e=>e.label===u).value,""!==c&&("number"===o?(c=parseFloat(c),isNaN(c)&&(s.firstElementChild.value="",c="")):"date"===o&&(c=new Date(c),c.setHours(0,0,0))));const f=-1!==["EMPTY","NOT_EMPTY","NULL","NOT_NULL"].indexOf(u);if(""!==c||f){const e=new Smart.Utilities.FilterGroup,t=e.createFilter(o,c,u);e.addFilter("or",t),l.push([r,e]),d.classList.remove("smart-hidden"),i.push({condition:u,value:c})}else d.classList.add("smart-hidden"),i.push(null);f?s.firstElementChild.setAttribute("disabled",!0):s.firstElementChild.removeAttribute("disabled")}l.length>0?(e.dataSource.virtualDataSource||e.dataSource._filter(l,"and"),e._filterInfo.rowFilters=l,e._filterInfo.filterRowValues=i,delete e._filterInfo.appliedFilters,e._fullRefresh("filter"),e._updateState("filtered"),e.$.fireEvent("filter",{action:"add",filters:l})):e._filterInfo.rowFilters&&e.clearFilters()}_clearFilterInput(){this._filterInfo.query="",delete this._filterInfo.inputFilters,this.$.filterInput.value=""}_clearRowFilters(){const e=this;if(!e._filterInfo.rowFilters)return;const t=e.$.tableContainer.querySelector(".smart-table-filter-row"),a=e.selection?1:0;for(let l=0;l<e._columns.length;l++){const e=t.children[l+a].firstElementChild;e.firstElementChild.value="",e.children[2].classList.add("smart-hidden")}delete e._filterInfo.rowFilters}_createFooterRow(e){const t=this,a=t.footerRow;if(!a)return;if(e)return void t.$.tableContainer.appendChild(e);const l=document.getElementById(a);if(l&&l instanceof HTMLTemplateElement){const e=document.createElement("tfoot"),a=document.importNode(l.content,!0);e.appendChild(a),t.$.tableContainer.appendChild(e)}else t.footerRow=null}_createCustomHeaderRow(){const e=this,t=e.headerRow;if(!t)return;const a=document.getElementById(t);if(a&&a instanceof HTMLTemplateElement){const t=document.importNode(a.content,!0);e.$.tableContainer.firstElementChild.appendChild(t)}else e.headerRow=null}_updateSelectAllState(e){const t=this,a=t._selectedIds.length,l=t.$.tableContainer.querySelector(".smart-table-select-all");void 0===e&&(e=t.dataSource.length),0===a?(l.classList.remove("selected","indeterminate"),l.firstElementChild.setAttribute("aria-checked",!1)):a===e?(l.classList.remove("indeterminate"),l.classList.add("selected"),l.firstElementChild.setAttribute("aria-checked",!0)):(l.classList.remove("selected"),l.classList.add("indeterminate"),l.firstElementChild.setAttribute("aria-checked","mixed"))}_resizeHandler(){const e=this;clearTimeout(e._resizeTimeout),e._resizeTimeout=setTimeout((function(){e._handleAutoSizeMode(),e._handleFrozenColumnPositions()}),75)}_hierarchyArrowClickHandler(e){const t=this,a=t.$.tableContainer,l=e.data;l.expanded?function e(l){l.forEach(l=>{t._collapseSingleChildRow(a.querySelector(`tr[row-id="${l.$.id}"]`)),l.children&&e(l.children)})}(l.children):requestAnimationFrame(()=>function e(l){l.forEach(l=>{t._expandSingleChildRow(a.querySelector(`tr[row-id="${l.$.id}"]`)),l.children&&l.expanded&&requestAnimationFrame(()=>e(l.children))})}(l.children)),l.expanded=!l.expanded,e.setAttribute("aria-expanded",l.expanded),e.classList.toggle("expanded",l.expanded),t.grouping||(l.expanded&&-1===t._expandedIds.indexOf(l.$.id)?t._expandedIds.push(l.$.id):l.expanded||(t._expandedIds=t._expandedIds.filter(e=>e!==l.$.id)),t._updateState("expanded"))}_expandSingleChildRow(e){e&&("none"!==this.animation?(e.classList.remove("smart-hidden"),requestAnimationFrame(()=>{e.classList.add("no-height"),e.ontransitionend=function(){e.classList.remove("no-height"),e.ontransitionend=null},e.removeAttribute("aria-hidden"),e.classList.remove("collapsed")})):(e.removeAttribute("aria-hidden"),e.classList.remove("collapsed","smart-hidden")))}_collapseSingleChildRow(e){e&&("none"!==this.animation?e.ontransitionend=function(){e.classList.add("smart-hidden"),e.ontransitionend=null}:e.classList.add("smart-hidden"),e.setAttribute("aria-hidden",!0),e.classList.add("collapsed"))}_getGroupByIndex(e){"number"==typeof e&&(e=e.toString());const t=this.dataSource.boundHierarchy,a=e.split(".");let l=t[a[0]];if(l){for(let e=1;e<a.length;e++)if(l=l.children[a[e]],!l||l.leaf)return;return l}}_createDialog(){const e=document.createElement("smart-window"),t=document.createElement("template"),a=` animation=${this.animation} theme="${this.theme}"${this.rightToLeft?" right-to-left":""}${!this.keyboardNavigation||this.unfocusable?" unfocusable":""}`;t.innerHTML=`<smart-button class="ok primary"${a}>${this.localize("ok")}</smart-button>\n<smart-button class="cancel"${a}>${this.localize("cancel")}</smart-button>`,e.animation=this.animation,e.footerTemplate=t,e.headerButtons=["close"],e.rightToLeft=this.rightToLeft,e.theme=this.theme,e.unfocusable=!this.keyboardNavigation||this.unfocusable,e.className="smart-table-window",e.ownerElement=this,this._dialog=e,this._addDialogHandlers(),this.getShadowRootOrBody().appendChild(e),this.setAttribute("aria-owns",e.id)}_addDialogHandlers(){const e=this._dialog;e.addEventListener("close",this._dialogEventHandler),e.addEventListener("click",this._dialogEventHandler)}_dialogEventHandler(e){const t=this,a=t.ownerElement,l=t.isInShadowDOM?e.composedPath()[0]:e.target,i=e.type,n=a.context;if(a.context=a,"close"===i){if(l!==t)return void(a.context=n);const e=t.classList.contains("conditional-formatting"),i=t.classList.contains("fields");t.ok?(e&&a._applyConditionalFormatting(),delete t.ok):e&&JSON.stringify(a._formattingPanel.items)!==JSON.stringify(a._formattingPanel.getItems())&&(a._formattingPanel.$.itemsContainer.innerHTML="",a._formattingPanel._addDefaultItems()),t.content.innerHTML="",t.classList.remove("conditional-formatting","drill-down","fields"),!a.keyboardNavigation||a.disabled||a.unfocusable||(a.$.tableContainer.setAttribute("tabindex",0),"smart-table"===a.nodeName.toLowerCase()&&(a.$.filterInput.unfocusable=!1,a.$.pager.unfocusable=!1),a.$.conditionalFormattingButton.unfocusable=!1),a.removeAttribute("modal"),e?a.$.conditionalFormattingButton.focus():i&&a.$.fieldsButton?a.$.fieldsButton.focus():a.$.tableContainer.focus()}else"click"===i&&t.$.footer.contains(l)&&(l.closest(".ok")?(t.ok=!0,t.close()):l.closest(".cancel")&&t.close());a.context=n}_openDialog(e,t,a){const l=this;l._dialog||l._createDialog();const i=l._dialog;i.label=e,i.classList.add(a),i.appendChild(t),l.$.tableContainer.removeAttribute("tabindex"),"smart-table"===l.nodeName.toLowerCase()&&(l.$.filterInput.unfocusable=!0,l.$.pager.unfocusable=!0),"drill-down"!==a?i.setAttribute("aria-controls",l.$.tableContainer.id):i.removeAttribute("aria-controls"),l.$.conditionalFormattingButton.unfocusable=!0,l.setAttribute("modal",""),i.open()}_conditionalFormattingButtonClickHandler(e,t,a){const l=this;let i;l._formattingPanel?i=l._formattingPanel:(i=document.createElement("smart-formatting-panel"),i.animation=l.animation,i.columns=t||l._columns,i.dataSource=a||l.dataSource,i.locale=l.locale,i.messages=l.messages,i.rightToLeft=l.rightToLeft,i.theme=l.theme,i.unfocusable=!l.keyboardNavigation||l.unfocusable,i.ownerElement=l,l._formattingPanel=i),l.conditionalFormatting&&(i.items=l.conditionalFormatting.slice(0)),l._openDialog(l.localize("conditionalFormatting"),i,"conditional-formatting")}_transformDataSource(){const e=this;if(!e.isRendered&&e.dataTransform){const t=e.dataSource;for(let a=0;a<t.length;a++)e.dataTransform(t[a])}}_applyInitialConditionalFormatting(e){const t=this,a=t.conditionalFormatting;if(!a||0===a.length)return;const l=t._defaults,i=new Smart.Utilities.ConditionalFormatter(e),n=[];let r;if("smart-pivot-table"===t.nodeName.toLowerCase()){const e=t._dynamicColumns;r=function(t){return"all"===t?e.map(e=>e.id):e.filter(e=>e.dataFields[e.dataFields.length-1].dataField===t).map(e=>e.id)}}else r=function(e){return"all"===e?t._columns.map(e=>e.value):[e]};for(let e=0;e<a.length;e++){a[e]=Object.assign({column:"all",condition:"lessThan",firstValue:0,secondValue:1,fontFamily:l.fontFamily,fontSize:l.fontSize,text:l.text,highlight:l.highlight},a[e]);const t=a[e],o=r(t.column),s=t.condition;i.color=t.highlight,i.comparator=t.firstValue,i.min=t.firstValue,i.max=t.secondValue;const d=i.format(s,o);for(let e in d){const a=d[e];for(let e in a){const l=a[e];l.color=t.text,l.fontFamily=t.fontFamily,l.fontSize=t.fontSize}}n.push(d)}if(t._formattingPanel&&(t._formattingPanel.items=a.slice(0)),0===n.length)return n[0];const o={};for(let e=0;e<n.length;e++){const t=n[e];for(let e in t){const a=t[e];o[e]||(o[e]={});for(let t in a)o[e][t]=Object.assign({},o[e][t],a[t])}}t._conditionalFormatting=o}_toHex(e){if(-1!==e.indexOf("#"))return e;const t=/rgb\((\d+), (\d+), (\d+)\)/g.exec(e);return t?"#"+(parseFloat(t[1]).toString(16).padStart(2,"0")+parseFloat(t[2]).toString(16).padStart(2,"0")+parseFloat(t[3]).toString(16).padStart(2,"0")).toUpperCase():"#FFFFFF"}_applyConditionalFormatting(){const e=this,t=e._conditionalFormatting;e._conditionalFormatting=e._formattingPanel.apply(),e.conditionalFormatting=e._formattingPanel.getItems(),e._conditionalFormatting!==t&&e._refreshDataRows()}_updateState(e,t){const a=this;if(-1===a.stateSettings.indexOf(e))return;const l=a._state;switch(e){case"columns":l.columns=a._columns;break;case"expanded":l.expanded=a._expandedIds;break;case"filtered":l.filtered=a._filterInfo;break;case"grouped":l.grouped=a.dataSource.groupBy._array.slice(0);break;case"selected":l.selected=a._selectedIds;break;case"sorted":l.sorted=a._sortColumns||[]}a.autoSaveState&&a.isRendered&&!1!==t&&window.localStorage.setItem("smartTable"+a.id,a._stringifyState())}_stringifyState(){return JSON.stringify(this._state,(function(e,t){if(!("function"==typeof t||t instanceof HTMLElement||"sortOrder"===e))return t}))}_handleAutoSizeMode(){if("default"===this.columnSizeMode)return;const e=this._columns,t=this._getNumericMinWidth();let a,l;e.forEach(e=>{e.width||(a||(a=e),l=e,e.headerCellElement.style.width=null)});const i=this.$.tableContainer.offsetWidth-(this.selection?this.$.tableContainer.querySelector(".smart-table-select-all").offsetWidth:0);let n=new Map,r=0,o=0,s=0;this.setAttribute("auto-size",""),a&&(a.headerCellElement.style.width="100%");for(let l=0;l<e.length;l++){const i=e[l];if(i===a){s++;continue}const d=i.headerCellElement;let c,u;i.width?(c=i.width,u=i.width):(c=Math.max(d.offsetWidth,t),u=t,s++),n.set(i,{width:c,minWidth:u}),r+=c,o+=u}if(a&&a!==l){a.headerCellElement.style.width=null,l.headerCellElement.style.width="100%";const e=Math.max(a.headerCellElement.offsetWidth,t),i=t;n.set(a,{width:e,minWidth:i}),r+=e,o+=i,l.headerCellElement.style.width=null}if(i<o||i===o||0===s)e.forEach(e=>e.headerCellElement.style.width=n.get(e).minWidth+"px");else if(i>o)if(i<r){const t=[];let a,l=r-i,o=s;for(;l>0&&o>0;)a=Math.ceil(l/o),e.forEach(e=>{if(e.width||-1!==t.indexOf(e))return;const i=n.get(e);let r=Math.max(i.width-a,i.minWidth);const s=i.width-r;l-=s,r===i.minWidth&&(o--,t.push(e)),i.width=r});e.forEach(e=>e.headerCellElement.style.width=n.get(e).width+"px")}else i===r?e.forEach(e=>e.headerCellElement.style.width=n.get(e).width+"px"):e.forEach(e=>{e.headerCellElement.style.width=e===a?i-r+"px":n.get(e).width+"px"});this.removeAttribute("auto-size")}_getNumericMinWidth(){const e=this,t=e.columnMinWidth;if("string"==typeof t&&-1!==t.indexOf("%")){return e.offsetWidth*(parseFloat(t)/100)}return parseFloat(t)}_isExpandCollapseForbidden(){return(!this.hasAttribute("hierarchy")||this.grouping)&&"smart-pivot-table"!==this.nodeName.toLowerCase()}})}});